import{M as h,N as V,c as C,l as i,m as b,w as _,J as d,Q as e,a4 as F,$ as p,_ as L,O as f,S as m,V as D,r as g,v as T,o as E,a6 as v,a7 as y,K as P,q as R,a3 as w,a8 as A,a9 as Y}from"./index-8ef18653.js";import{_ as q,P as z}from"./PowerFlowCard-5abbce31.js";import{C as x,h as $,p as S,f as B,B as M,j as I,L as N,k as U}from"./index-ee573144.js";import{f as H}from"./utils-6f3c77d7.js";import{V as J,a as W,b as j}from"./VCard-b69b9241.js";import{V as K}from"./VToolbar-e324ab48.js";import{V as O}from"./VDivider-55d508c3.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./VImg-326431bc.js";import"./VAvatar-9bbc4728.js";import"./index-7cdcfa5d.js";const G={class:""},X={class:"mt-2 items-center rounded-md bg-subgroup p-2"},Z={class:"text-left"},ee={class:"float-right"},te={key:0,class:"mt-2 items-center rounded-md bg-subgroup p-2"},ae=h({__name:"DeviceEnergyCard",props:{measurement:{},device:{},statistics:{},timeframe:{}},setup(c){const{t:s,d:o}=V(),n=c,u=C(()=>n.measurement.consumed_energy!=0?100*n.measurement.solar_consumed_energy/n.measurement.consumed_energy:0),l=C(()=>n.statistics?{labels:n.statistics.map(t=>o(new Date(t.measurement_date),{month:"numeric",day:"numeric"})),datasets:[{label:"Consumption",backgroundColor:"#2563eb",data:n.statistics.map(t=>{const r=t.device_measurements.find(k=>k.device_id==n.device.id);return r?r.consumed_energy:0})}]}:{labels:[],datasets:[]}),a={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{display:!1}}};return x.register($,S,B,M,I,N),(t,r)=>(i(),b(j,{class:"m-4 w-80 sm:w-96 p-4 rounded-lg elevation-6"},{default:_(()=>[d(J,null,{default:_(()=>[e("span",{class:F(["mdi pr-2",t.device.icon])},null,2),e("span",G,p(t.device.name),1)]),_:1}),d(W,null,{default:_(()=>[e("div",X,[e("div",Z,[L(p(f(s)("consumption"))+" ",1),e("span",ee,p(f(H)(t.measurement.consumed_energy,"kWh")),1)]),d(q,{"self-sufficiency":u.value,"consumed-energy":t.measurement.consumed_energy,"consumed-solar-energy":t.measurement.solar_consumed_energy},null,8,["self-sufficiency","consumed-energy","consumed-solar-energy"])]),t.timeframe=="week"||t.timeframe=="month"?(i(),m("div",te,[d(f(U),{data:l.value,options:a},null,8,["data"])])):D("",!0)]),_:1})]),_:1}))}}),se=h({__name:"WeeklyStatistics",props:{data:{}},setup(c){const{d:s}=V(),o=C(()=>({labels:u.data.map(l=>s(new Date(l.measurement_date),{month:"numeric",day:"numeric"})),datasets:[{label:"Solar Production",backgroundColor:"#fbbf24",data:u.data.map(l=>l.solar_produced_energy)},{label:"Consumption",backgroundColor:"#2563eb",data:u.data.map(l=>l.consumed_energy)}]})),n={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{display:!1}}};x.register($,S,B,M,I,N);const u=c;return(l,a)=>(i(),b(f(U),{data:o.value,options:n},null,8,["data"]))}}),ne=h({__name:"WeeklyStatisticsCard",props:{data:{}},setup(c){return(s,o)=>(i(),b(j,{class:"m-4 w-80 sm:w-96 p-4 rounded-lg elevation-6"},{default:_(()=>[d(W,{class:"h-100 w-auto"},{default:_(()=>[d(se,{data:s.data},null,8,["data"])]),_:1})]),_:1}))}}),re=c=>(A("data-v-65fea43f"),c=c(),Y(),c),oe={class:"v-full flex min-h-screen justify-center p-4 bg-background"},le={class:"grid grid-cols-1"},ie={class:"grid h-14 w-full grid-cols-4 space-x-2 rounded-xl p-2 elevation-6 bg-surface"},de={for:"1",class:"block cursor-pointer select-none rounded-xl p-2 text-center peer-checked:bg-primary peer-checked:font-bold peer-checked:text-primary"},ce={for:"2",class:"block cursor-pointer select-none rounded-xl p-2 text-center peer-checked:bg-primary peer-checked:font-bold peer-checked:text-primary"},ue={for:"3",class:"block cursor-pointer select-none rounded-xl p-2 text-center peer-checked:bg-primary peer-checked:font-bold peer-checked:text-primary"},me={for:"4",class:"block cursor-pointer select-none rounded-xl p-2 text-center peer-checked:bg-primary peer-checked:font-bold peer-checked:text-primary"},pe={key:0,class:"grid w-full grid-cols-1 justify-items-center"},_e=re(()=>e("span",{class:"loading loading-dots loading-lg py-2"},null,-1)),fe=[_e],ge={key:1},ve={key:0,class:"grid grid-cols-1 justify-items-center lg:grid-cols-2"},ye=h({__name:"Statistics",setup(c){const s=g("today"),o=g(),n=g();T(s,()=>{const a=new Date;switch(s.value){case"week":a.setDate(a.getDate()-7);break;case"month":a.setMonth(a.getMonth()-1);break;case"year":a.setFullYear(a.getFullYear()-1);break}u(a)});const u=async function(a){l.value=!0,o.value=(await w.getHomeMeasurementDifference(a,new Date)).data,n.value=await w.getDailyMeasurements(a,new Date),l.value=!1};E(()=>{u(new Date)});const l=g(!1);return(a,t)=>(i(),m("div",null,[d(K,{color:"transparent",title:a.$t("app.statistics")},null,8,["title"]),d(O),e("div",oe,[e("div",le,[e("div",ie,[e("div",null,[v(e("input",{id:"1","onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r),type:"radio",name:"option",class:"peer hidden",value:"today",checked:""},null,512),[[y,s.value]]),e("label",de,p(a.$t("statistics.today")),1)]),e("div",null,[v(e("input",{id:"2","onUpdate:modelValue":t[1]||(t[1]=r=>s.value=r),type:"radio",name:"option",class:"peer hidden",value:"week"},null,512),[[y,s.value]]),e("label",ce,p(a.$t("statistics.week")),1)]),e("div",null,[v(e("input",{id:"3","onUpdate:modelValue":t[2]||(t[2]=r=>s.value=r),type:"radio",name:"option",class:"peer hidden",value:"month"},null,512),[[y,s.value]]),e("label",ue,p(a.$t("statistics.month")),1)]),e("div",null,[v(e("input",{id:"4","onUpdate:modelValue":t[3]||(t[3]=r=>s.value=r),type:"radio",name:"option",class:"peer hidden",value:"year"},null,512),[[y,s.value]]),e("label",me,p(a.$t("statistics.year")),1)])]),l.value?(i(),m("div",pe,fe)):(i(),m("div",ge,[o.value?(i(),m("div",ve,[d(z,{"home-consumption-power":o.value.consumed_energy,"solar-power":o.value.solar_produced_energy,"grid-imported-energy":o.value.grid_imported_energy,"grid-exported-energy":o.value.grid_exported_energy,unit:"kWh"},null,8,["home-consumption-power","solar-power","grid-imported-energy","grid-exported-energy"]),s.value=="week"&&n.value!=null?(i(),b(ne,{key:0,data:n.value},null,8,["data"])):D("",!0),(i(!0),m(P,null,R(o.value.device_measurements,(r,k)=>(i(),m("div",{key:k},[d(ae,{measurement:r,device:f(w).getDeviceInfo(r.device_id),statistics:n.value,timeframe:s.value},null,8,["measurement","device","statistics","timeframe"])]))),128))])):D("",!0)]))])])]))}});const Me=Q(ye,[["__scopeId","data-v-65fea43f"]]);export{Me as default};
