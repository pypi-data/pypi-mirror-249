"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[3375],{66535:function(e,n,t){t.r(n),t.d(n,{default:function(){return ae}});var i=t(93433),r=t(1413),a=t(29439),o=t(71233),s=t(98083),l=t(92886),d=t(59323),u=t(2794),c=t(51607),x=t(87678),h=t(98942),f=t(73261),p=t(29088),j=t(60830),Z=t(68858),v=t(4182),y=t(94766),m=t(45734),g=t(62326),k=t(20151),S=t(86897),b=t(97157),C=t(75228),w=t(94085),_=t(78777),D=t(72411),O=t(47857),E=t(60696),A=t(98193),z=t(17029),N=t(87147),M=t(18282),W=t(64350),L=t(58833),P=t(84368),T=t(13263),I=t(76508),U=t(32318),B=t(78617),F=t(37881);function H(e){var n=e.id,t=e.open,i=e.onOk,r=e.onCancel,a=e.title,o=e.text;return(0,F.jsxs)(P.Z,{title:a||"Logged Out",open:t,onCancel:r,children:[(0,F.jsx)(T.Z,{id:"delete-modal-title",children:"Confirm Delete"}),(0,F.jsx)(I.Z,{children:(0,F.jsx)(U.Z,{children:o})}),(0,F.jsxs)(B.Z,{children:[(0,F.jsx)(g.Z,{onClick:function(){return r(n)},children:"Cancel"},"cancel"),",",(0,F.jsx)(g.Z,{variant:"contained",type:"primary",onClick:function(){return i(n)},children:"Confirm"},"submit"),","]})]})}var R=t(64991),V=t(84116),J=t(82334),Y=t(83969);function G(e){var n=e.id,t=e.open,i=e.onOk,r=e.onCancel,s=e.title,l=e.dataSource,d=o.useState(null===l||void 0===l?void 0:l.visibility),u=(0,a.Z)(d,2),c=u[0],x=u[1];return(0,F.jsxs)(P.Z,{open:t,onClose:function(){return r(n)},"aria-labelledby":"share-datasource-dialog-title","aria-describedby":"share-datasource-dialog-description",children:[(0,F.jsx)(T.Z,{id:"share-datasource-dialog-title",children:s}),(0,F.jsx)(I.Z,{style:{minWidth:"500px"},children:(0,F.jsxs)(R.Z,{spacing:2,children:[(0,F.jsx)("h4",{children:"Choose who can access this datasource"}),(0,F.jsx)(V.Z,{labelId:"share-datasource-select-label",size:"small",defaultValue:void 0===(null===l||void 0===l?void 0:l.visibility)?1:null===l||void 0===l?void 0:l.visibility,onChange:function(e){x(e.target.value)},children:[{value:1,label:"Organization",description:"Members of your organization can access this datasource"},{value:0,label:"You",description:"Only you can access this datasource"}].map((function(e){return(0,F.jsx)(J.Z,{value:e.value,children:(0,F.jsxs)(R.Z,{direction:"row",spacing:1,children:[(0,F.jsx)("span",{children:e.label}),(0,F.jsx)("small",{children:e.description})]})},e.value)}))})]})}),(0,F.jsxs)(B.Z,{children:[(0,F.jsx)(g.Z,{onClick:function(){return r(n)},children:"Cancel"}),(0,F.jsx)(g.Z,{variant:"contained",onClick:function(){return function(){var e="noop";c!==l.visibility?0===l.visibility&&1===c?(0,Y.o)().post("api/org/datasources/".concat(l.uuid,"/add_entry")).then((function(n){i(e,l)})):1===l.visibility&&0===c?(0,Y.o)().delete("api/org/datasources/".concat(l.uuid)).then((function(n){i(e,l)})):i(e,l):i(e,l)}()},children:"Done"})]})]})}var K=t(2893),X=t(43078),q=t(31811);var Q=function(e){var n=e.onCancel,t=e.dataSourceEntry,i=e.open,r=(0,o.useState)(null),d=(0,a.Z)(r,2),u=d[0],c=d[1],x=(0,o.useState)(null),h=(0,a.Z)(x,2),f=h[0],p=h[1],j=(0,o.useState)(!1),Z=(0,a.Z)(j,2),v=Z[0],y=Z[1];return(0,o.useEffect)((function(){var e,n;null!==t&&void 0!==t&&null!==(e=t.config)&&void 0!==e&&e.document_ids?(0,Y.o)().get("/api/datasource_entries/".concat(t.uuid,"/text_content")).then((function(e){var n,t;c((0,F.jsx)(q.u,{value:null===(n=e.data)||void 0===n?void 0:n.content,disabled:!0,autoSize:!0,style:{maxHeight:"80vh",width:"100%",overflow:"auto"}})),p(null===(t=e.data)||void 0===t?void 0:t.metadata)})).finally((function(){return y(!1)})):c((0,F.jsx)(q.u,{value:JSON.stringify(null===t||void 0===t||null===(n=t.config)||void 0===n?void 0:n.errors),disabled:!0,autoSize:!0,style:{maxHeight:"80vh",width:"100%",overflow:"auto"}}))}),[t]),(0,F.jsx)(K.ZP,{open:i,onClose:n,anchor:"right",sx:{"& .MuiDrawer-paper":{minWidth:"40%"},maxWidth:"40%"},children:(0,F.jsxs)(l.Z,{children:[(0,F.jsxs)(R.Z,{direction:"row",gap:1,sx:{mb:"10px",mt:"10px"},children:[(0,F.jsx)(g.Z,{onClick:function(){return n()},sx:{alignSelf:"left"},children:"X"}),Object.keys(f||{}).map((function(e){return(0,F.jsx)(s.Z,{label:"".concat(e,": ").concat(f[e]),size:"small",sx:{borderRadius:"10px",marginTop:"5px"}},e)}))]}),(0,F.jsx)(X.Z,{}),v?(0,F.jsx)(S.Z,{}):(0,F.jsx)("div",{style:{margin:"0px 10px"},children:u})]})})};function $(e){var n=new Date(e.value);return(0,F.jsx)("span",{children:n.toLocaleString()})}function ee(e){for(var n=e.value,t=["","K","M","G","T","P","E","Z","Y"],i=0;n>=1024;)n/=1024,i+=1;return(0,F.jsx)("span",{children:n>0?n.toFixed(2)+" "+t[i]:n+" "+t[i]})}var ne=t(14815),te=t(83663),ie=t.n(te);function re(e){var n=e.dataSourceEntryData,t=(0,o.useState)(!1),i=(0,a.Z)(t,2),r=i[0],y=i[1],m=(0,o.useState)(null),g=(0,a.Z)(m,2),k=g[0],S=g[1],b=(0,o.useState)(!1),D=(0,a.Z)(b,2),O=D[0],E=D[1],A=(0,ne.lD)(),z=[{title:"Name",key:"name"},{title:"Size",key:"size",render:function(e){return(0,F.jsx)(ee,{value:e})}},{title:"Status",key:"status",render:function(e,n){var t="success";return t="FAILED"===e?"error":"READY"===e?"success":"info",(0,F.jsx)(s.Z,{color:t,style:{cursor:"pointer"},label:n.status.charAt(0)+n.status.slice(1).toLowerCase(),size:"small"},n.uuid)}},{title:"Created At",key:"created_at",render:function(e){return(0,F.jsx)($,{value:e})}},{title:"Last Modified",key:"updated_at",render:function(e){return ie()(e).fromNow()}},{title:"Action",key:"operation",render:function(e,n){var t=null===e||void 0===e?void 0:e.sync_config;return(0,F.jsxs)(l.Z,{children:[(0,F.jsx)(d.Z,{title:"View Contents",children:(0,F.jsx)(u.Z,{onClick:function(){y(!0),S(n)},children:(0,F.jsx)(C.Z,{})})}),t&&(0,F.jsx)(d.Z,{title:"Sync Contents",children:(0,F.jsx)(u.Z,{children:(0,F.jsx)(w.Z,{})})}),(0,F.jsx)(d.Z,{title:"Delete Entry",children:(0,F.jsx)(u.Z,{onClick:function(){S(n),E(!0)},children:(0,F.jsx)(_.Z,{})})})]})}}];return 0===n.length?(0,F.jsx)(c.Z,{children:(0,F.jsxs)(x.Z,{severity:"info",sx:{maxWidth:"300px",margin:"0 auto"},children:[(0,F.jsx)(h.Z,{children:"No entries found"}),"Click on the ",(0,F.jsx)("strong",{children:"+"})," icon to add a new entry."]})}):(0,F.jsxs)(f.Z,{stickyHeader:!0,"aria-label":"sticky table contents",colSpan:7,children:[(0,F.jsx)(p.Z,{children:(0,F.jsx)(j.Z,{children:z.map((function(e){return(0,F.jsx)(Z.Z,{sx:{padding:"5px 16px"},children:(0,F.jsx)("strong",{children:e.title})},e.key)}))})}),(0,F.jsx)(v.Z,{sx:{borderBottom:"none"},children:null===n||void 0===n?void 0:n.map((function(e,n){return(0,F.jsx)(j.Z,{role:"checkbox",tabIndex:-1,children:z.map((function(n){var t=e[n.key];return(0,F.jsx)(Z.Z,{sx:{padding:"0 16px"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid)}))}),(0,F.jsx)(Q,{onCancel:function(){return y(!1)},dataSourceEntry:k,open:r}),(0,F.jsx)(H,{id:k,title:"Delete Data Source Entry",text:(0,F.jsxs)("div",{children:["Are you sure you want to delete"," ",(0,F.jsx)("span",{style:{fontWeight:"bold"},children:null===k||void 0===k?void 0:k.name})," ","?"]}),open:O,onOk:function(e){(0,Y.o)().delete("api/datasource_entries/".concat(e.uuid)).then((function(e){A(),E(!1)}))},onCancel:function(){E(!1)}})]})}function ae(){var e=(0,o.useState)(1),n=(0,a.Z)(e,2),t=n[0],s=n[1],c=(0,o.useState)(""),x=(0,a.Z)(c,2),h=x[0],C=x[1],w=(0,o.useState)(""),P=(0,a.Z)(w,2),T=P[0],I=P[1],U=(0,o.useState)(null),B=(0,a.Z)(U,2),R=B[0],V=B[1],J=(0,o.useState)(!1),K=(0,a.Z)(J,2),X=K[0],q=K[1],Q=(0,o.useState)(!1),te=(0,a.Z)(Q,2),ae=te[0],oe=te[1],se=(0,o.useState)(!1),le=(0,a.Z)(se,2),de=le[0],ue=le[1],ce=(0,M.sJ)(W.ye),xe=(0,M.FV)(W.MC),he=(0,a.Z)(xe,2),fe=he[0],pe=he[1],je=(0,M.FV)(W.DK),Ze=(0,a.Z)(je,2),ve=Ze[0],ye=Ze[1],me=(0,o.useState)(null),ge=(0,a.Z)(me,2),ke=ge[0],Se=ge[1],be=(0,o.useState)([]),Ce=(0,a.Z)(be,2),we=Ce[0],_e=Ce[1],De=(0,o.useState)("Add New Data Source"),Oe=(0,a.Z)(De,2),Ee=Oe[0],Ae=Oe[1],ze=(0,o.useState)(null),Ne=(0,a.Z)(ze,2),Me=Ne[0],We=Ne[1],Le=(0,o.useState)(null),Pe=(0,a.Z)(Le,2),Te=Pe[0],Ie=Pe[1],Ue=(0,ne.lD)(),Be=(0,ne.B6)(),Fe=(0,M.sJ)(W.Dg);(0,o.useEffect)((function(){ce.length>0&&_e((function(e){return ce.map((function(n){var t;return(0,r.Z)((0,r.Z)({},n),{},{expand:(null===(t=e.find((function(e){return e.uuid===n.uuid})))||void 0===t?void 0:t.expand)||!1})}))}))}),[ce]);var He=[{title:"Name",key:"name",render:function(e,n){return(0,F.jsxs)(y.Z,{sx:{display:"flex",fontSize:"0.9rem",fontWeight:n.expand?"600":"inherit",gap:1},children:[n.expand?(0,F.jsx)(D.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}):(0,F.jsx)(O.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}),e]})}},{title:"Owner",key:"owner_email",render:function(e,n){return(0,F.jsx)("span",{children:n.isUserOwned?"me":n.owner_email})}},{title:"Data Source Type",key:"type",render:function(e){return(0,F.jsx)("span",{children:e.name})}},{title:"Size",key:"size",render:function(e){return(0,F.jsx)(ee,{value:e})}},{title:"Created At",key:"created_at",render:function(e){return(0,F.jsx)($,{value:e})}},{title:"Last Modified",key:"updated_at",render:function(e){return ie()(e).fromNow()}},{title:"Action",key:"operation",render:function(e,n){var t,i;return(0,F.jsxs)(l.Z,{children:[!(null!==e&&void 0!==e&&null!==(t=e.type)&&void 0!==t&&t.is_external_datasource)&&(0,F.jsx)(u.Z,{disabled:!n.isUserOwned,onClick:function(e){Ae("Add New Data Entry"),We(n),q(!0),e.stopPropagation()},children:(0,F.jsx)(E.Z,{})}),(null===n||void 0===n||null===(i=n.type)||void 0===i?void 0:i.is_external_datasource)&&(0,F.jsx)(d.Z,{title:"External Connection",children:(0,F.jsx)("span",{children:(0,F.jsx)(u.Z,{disabled:!0,children:(0,F.jsx)(A.Z,{})})})}),(0,F.jsx)(u.Z,{disabled:!n.isUserOwned,onClick:function(){V(n),C("Delete Data Source"),I((0,F.jsxs)("div",{children:["Are you sure you want to delete"," ",(0,F.jsx)("span",{style:{fontWeight:"bold"},children:n.name})," ?"]})),oe(!0)},children:(0,F.jsx)(_.Z,{})}),Fe.IS_ORGANIZATION_MEMBER&&n.isUserOwned&&(0,F.jsx)(u.Z,{onClick:function(){Ae("Share Datasource"),We(n),ue(!0)},children:0===n.visibility?(0,F.jsx)(z.Z,{}):(0,F.jsx)(N.Z,{})})]})}}];return(0,F.jsxs)("div",{id:"data-page",style:{marginBottom:"120px"},children:[(0,F.jsxs)(m.ZP,{span:24,style:{padding:"10px"},children:[(0,F.jsx)(m.ZP,{item:!0,style:{width:"100%",padding:"15px 0px"},children:(0,F.jsx)(g.Z,{onClick:function(){q(!0)},type:"primary",variant:"contained",sx:{float:"left",marginBottom:"10px",textTransform:"none"},children:"Add Data Source"})}),(0,F.jsxs)(m.ZP,{item:!0,style:{width:"100%"},children:[(0,F.jsxs)(f.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,F.jsx)(p.Z,{children:(0,F.jsx)(j.Z,{children:He.map((function(e){return(0,F.jsx)(Z.Z,{sx:{paddingLeft:"name"===e.key?"40px":"inherit"},children:(0,F.jsx)("strong",{children:e.title})},e.key)}))})}),(0,F.jsx)(v.Z,{children:we.slice(10*(t-1),10*t).map((function(e,n){return[[(0,F.jsx)(j.Z,{hover:!0,sx:{cursor:"pointer",backgroundColor:e.expand?"#f5f5f5":"inherit"},onClick:function(){!function(e){_e(we.map((function(n){return n.uuid===e.uuid&&(n.expand=!n.expand),n}))),Se(!0),Ie(e.uuid);var n="/api/datasources/".concat(e.uuid,"/entries");e.isUserOwned||(n="/api/org/datasources/".concat(e.uuid,"/entries")),(0,Y.o)().get(n).then((function(n){e.isUserOwned?pe([].concat((0,i.Z)(fe.filter((function(n){return n.datasource.uuid!==e.uuid}))),(0,i.Z)(n.data))):ye([].concat((0,i.Z)(ve.filter((function(n){return n.datasource.uuid!==e.uuid}))),(0,i.Z)(n.data)))})).finally((function(){Se(null)}))}(e)},children:He.map((function(n){var t=e[n.key];return(0,F.jsx)(Z.Z,{sx:{fontWeight:e.expand?"bold":"inherit"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid),(0,F.jsx)(j.Z,{children:(0,F.jsx)(Z.Z,{colSpan:7,sx:{padding:e.expand?"0":"inherit"},children:(0,F.jsx)(k.Z,{in:e.expand,timeout:"auto",unmountOnExit:!0,children:(0,F.jsx)(l.Z,{sx:{margin:1},children:ke&&Te===e.uuid?(0,F.jsx)(S.Z,{}):(0,F.jsx)(re,{dataSourceEntryData:e.data_source_entries||[]})})})})},"".concat(e.uuid,"_details"))]]}))})]}),(0,F.jsx)(b.Z,{count:Math.ceil(we.length/10),variant:"outlined",shape:"rounded",page:t,onChange:function(e,n){s(n)},sx:{marginTop:2,float:"right"}})]})]}),X&&(0,F.jsx)(L.P,{open:X,handleCancelCb:function(){We(null),q(!1)},dataSourceAddedCb:function(){We(null),Ue(),Be(),q(!1)},modalTitle:Ee,datasource:Me}),ae&&(0,F.jsx)(H,{id:R,title:h,text:T,open:ae,onOk:function(e){void 0!==(null===e||void 0===e?void 0:e.data_source_entries)&&(0,Y.o)().delete("api/datasources/".concat(e.uuid)).then((function(e){Be(),oe(!1)}))},onCancel:function(){oe(!1)}}),de&&(0,F.jsx)(G,{title:Ee,onCancel:function(){return ue(!1)},onOk:function(){ue(!1)},open:de,dataSource:Me})]})}}}]);
//# sourceMappingURL=3375.d67ccbb6.chunk.js.map