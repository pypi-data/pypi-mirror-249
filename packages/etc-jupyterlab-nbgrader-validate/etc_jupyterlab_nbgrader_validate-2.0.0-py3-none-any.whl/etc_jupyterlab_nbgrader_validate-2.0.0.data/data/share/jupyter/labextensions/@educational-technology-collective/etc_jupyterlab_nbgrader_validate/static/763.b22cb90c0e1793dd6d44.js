"use strict";(self.webpackChunk_educational_technology_collective_etc_jupyterlab_nbgrader_validate=self.webpackChunk_educational_technology_collective_etc_jupyterlab_nbgrader_validate||[]).push([[763],{763:(t,e,a)=>{a.r(e),a.d(e,{IValidateButtonExtension:()=>u,ValidateButtonExtension:()=>_,default:()=>h});var n=a(717),i=a(778),o=a(930),l=a(901),s=a(178),r=a(483),d=a(429);const c="@educational-technology-collective/etc_jupyterlab_nbgrader_validate:plugin",u=new o.Token(c),v={id:c,provides:u,autoStart:!0,activate:function(t){const e=new _;return t.docRegistry.addWidgetExtension("Notebook",e),e}};class _{constructor(){this._validateButtonClicked=new l.Signal(this),this._validationResultsDisplayed=new l.Signal(this),this._validationResultsDismissed=new l.Signal(this)}createNew(t,e){const a=new s.ToolbarButton({className:"validate-button",label:"Validate",onClick:async()=>{try{this._validateButtonClicked.emit({name:"validate_button_clicked",notebook_panel:t});const e=document.getElementsByClassName("validate-button")[0];e.firstElementChild.textContent="Validating...";const a={name:t.context.path};let n;try{n=await async function(t="",e={}){const a=d.ServerConnection.makeSettings(),n=r.URLExt.join(a.baseUrl,"jupyterlab-nbgrader-validate",t);let i;try{i=await d.ServerConnection.makeRequest(n,e,a)}catch(t){throw new d.ServerConnection.NetworkError(t)}let o=await i.text();if(o.length>0)try{o=JSON.parse(o)}catch(t){console.log("Not a JSON response body.",i)}if(!i.ok)throw new d.ServerConnection.ResponseError(i,o.message||o);return o}("validate",{body:JSON.stringify(a),method:"POST"}),console.log(n)}catch(t){throw new Error(`Error on POST /jupyterlab-nbgrader-validate/validate ${a}.\n${t}`)}finally{e.firstElementChild.textContent="Validate"}const o=document.createElement("div"),l=document.createElement("pre");l.innerText=n.output,o.appendChild(l),this._validationResultsDisplayed.emit({name:"validation_results_displayed",notebook_panel:t,message:n.output});const c=await(0,s.showDialog)({title:"Validation Results",body:new i.Widget({node:o}),buttons:[s.Dialog.okButton()]});this._validationResultsDismissed.emit({name:"validation_results_dismissed",notebook_panel:t,message:c})}catch(t){console.error(t)}},tooltip:"Validate"});return t.toolbar.insertItem(10,"validateNotebook",a),new n.DisposableDelegate((()=>{a.dispose()}))}get validateButtonClicked(){return this._validateButtonClicked}get validationResultsDisplayed(){return this._validationResultsDisplayed}get validationResultsDismissed(){return this._validationResultsDismissed}}const h=v}}]);