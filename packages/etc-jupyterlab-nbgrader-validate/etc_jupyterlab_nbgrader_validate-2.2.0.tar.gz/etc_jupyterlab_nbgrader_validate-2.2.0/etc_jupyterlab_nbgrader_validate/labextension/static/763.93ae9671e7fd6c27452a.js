"use strict";(self.webpackChunk_educational_technology_collective_etc_jupyterlab_nbgrader_validate=self.webpackChunk_educational_technology_collective_etc_jupyterlab_nbgrader_validate||[]).push([[763],{763:(e,t,n)=>{n.r(t),n.d(t,{IValidateButtonExtension:()=>u,ValidateButtonExtension:()=>v,default:()=>p});var a=n(717),o=n(778),i=n(930),l=n(178),r=n(770),s=n(483),c=n(429);const d="@educational-technology-collective/etc_jupyterlab_nbgrader_validate:plugin",u=new i.Token(d);class v{constructor(e){this.pioneer=e}createNew(e,t){const n=new l.ToolbarButton({className:"validate-button",label:"Validate",onClick:async()=>{await e.revealed;const t=e.content.model.getMetadata("exporters");try{null==t||t.forEach((async t=>{await this.pioneer.publishEvent(e,{eventName:"validate_button_clicked",eventTime:Date.now(),eventInfo:{}},t,!0)}));const n=document.getElementsByClassName("validate-button")[0];n.firstElementChild.textContent="Validating...";const a={name:e.context.path};let i;try{i=await async function(e="",t={}){const n=c.ServerConnection.makeSettings(),a=s.URLExt.join(n.baseUrl,"jupyterlab-nbgrader-validate",e);let o;try{o=await c.ServerConnection.makeRequest(a,t,n)}catch(e){throw new c.ServerConnection.NetworkError(e)}let i=await o.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",o)}if(!o.ok)throw new c.ServerConnection.ResponseError(o,i.message||i);return i}("validate",{body:JSON.stringify(a),method:"POST"}),console.log(i)}catch(e){throw new Error(`Error on POST /jupyterlab-nbgrader-validate/validate ${a}.\n${e}`)}finally{n.firstElementChild.textContent="Validate"}const r=document.createElement("div"),d=document.createElement("pre");d.innerText=i.output,r.appendChild(d),null==t||t.forEach((async t=>{await this.pioneer.publishEvent(e,{eventName:"validation_results_displayed",eventTime:Date.now(),eventInfo:{message:null==i?void 0:i.output}},t,!0)}));const u=await(0,l.showDialog)({title:"Validation Results",body:new o.Widget({node:r}),buttons:[l.Dialog.okButton()]});null==t||t.forEach((async t=>{await this.pioneer.publishEvent(e,{eventName:"validation_results_dismissed",eventTime:Date.now(),eventInfo:{message:u}},t,!0)}))}catch(e){console.error(e)}},tooltip:"Validate"});return e.toolbar.insertItem(10,"validateNotebook",n),new a.DisposableDelegate((()=>{n.dispose()}))}}const p={id:d,provides:u,requires:[r.IJupyterLabPioneer],autoStart:!0,activate:(e,t)=>{const n=new v(t);return e.docRegistry.addWidgetExtension("Notebook",n),n}}}}]);