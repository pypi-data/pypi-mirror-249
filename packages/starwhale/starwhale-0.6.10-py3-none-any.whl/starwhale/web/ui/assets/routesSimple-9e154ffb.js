import{r as c,u,R as j,j as e,I as m,E as y,o as p,J as w,O as R}from"./__uno-3d1f536a.js";import{i as S,u as b,d as N,g as f,t as g,f as v,S as k,r as E,v as F,w as P,aj as M,ae as C,al as H,ah as I,b as L,K as B}from"./main-8108760a.js";import{a as z,bt as D,n as T,a6 as U,J as W,aF as A,e as _,L as $,k as q,bs as J}from"./useReport-b41e0f9e.js";import"./index-7e3fc8df.js";var Z=function(t,s){return s!==void 0?s:S?window.matchMedia(t).matches:!1},G=function(t,s){var a=c.useState(Z(t,s)),r=a[0],i=a[1];return c.useEffect(function(){var n=!0,o=window.matchMedia(t),l=function(){n&&i(!!o.matches)};return o.addListener(l),i(o.matches),function(){n=!1,o.removeListener(l)}},[t]),r};const K=G;function O(){const{query:t}=z(),{rid:s}=t||{},a=D(s),{data:r}=a,[i]=u(),[n,o]=j.useState(!0),l=K("(min-width: 480px)");return e.jsxs("div",{className:"flex flex-column flex-1",children:[e.jsx("h1",{className:"mb-20px",style:{fontSize:"2.4em",fontWeight:600,color:"#02102B"},children:r?.title||""}),e.jsxs("div",{className:"flex gap-10px items-center font-14px",children:[e.jsxs("div",{className:"flex gap-5px",children:[e.jsx(T,{name:a.data?.owner?.name,size:28}),e.jsx(U,{user:a.data?.owner}),"|"," "]}),e.jsxs("span",{style:{color:"rgba(2,16,43,0.60)"},children:[e.jsx(m,{type:"time",style:{marginRight:"4px"}}),W(r?.createdTime||Date.now())]})]}),e.jsx("p",{className:"mt-20px",style:{fontSize:"16px",color:"#02102B"},children:r?.description||""}),e.jsx("div",{className:"mb-20px flex-1",children:e.jsx(A,{id:s,initialContent:r?.content,editable:!1})}),!l&&n&&e.jsxs("div",{className:"flex fixed bottom-0 left-0 right-0 h-10 lh-10 px-4 bg-[rgba(2,16,43,0.60)] text-xs text-white justify-between items-center",children:[i("report.mobile.notice"),e.jsx(y,{styleas:["icondisable"],as:"link",onClick:()=>o(!1),children:e.jsx(m,{type:"close",kind:"white",size:20})})]})]})}function Q(){const t=b(),s=5,a=c.useRef({}),r=c.useRef(t.pathname),[i]=u();return _(()=>{p.interceptors.response.handlers.length>1||p.interceptors.response.use(n=>n,n=>{if(n.config.url?.includes(`${N}/alive`)||n.response.config.params?.silent)return Promise.reject(n);const h={autoHideDuration:(s+1)*1e3,overrides:{InnerContainer:{style:{wordBreak:"break-word",width:"100%"}}},key:"api-header"};if(n.response?.status===400){const x=f(n);return x&&g.negative(x,h),Promise.reject(n)}const d=f(n);return Date.now()-(a.current[d]||0)>s*1e3&&(g.negative(d.length<100?d:e.jsx(e.Fragment,{children:e.jsxs("details",{children:[e.jsx("summary",{children:i("something wrong with the server")}),d]})}),h),a.current[d]=Date.now()),Promise.reject(n)})}),c.useEffect(()=>{r.current!==t.pathname&&(a.current={}),r.current=t.pathname},[t.pathname]),e.jsx(e.Fragment,{})}const V=v({headerWrapper:t=>({padding:"0 20px 0 0",height:`${P}px`,width:"100%",display:"flex",flexFlow:"row nowrap",alignItems:"center",color:t.theme.colors.contentPrimary,backgroundColor:t.theme.brandBgNav,position:"relative",zIndex:10})});function X(){const[,t]=w(),s=V({theme:t}),a=c.useContext(k),[r]=u(),i=R.language==="zh";return e.jsxs("header",{className:s.headerWrapper,children:[e.jsx($,{expanded:a.expanded}),e.jsx("div",{style:{flexGrow:1}}),e.jsxs("div",{style:{flexShrink:0,display:"flex",alignItems:"center",gap:"4px",marginRight:"16px"},children:[e.jsx(q,{}),e.jsx("a",{target:"_blank",rel:"noreferrer",href:i?E:F,style:{color:"#FFF",textDecoration:"none",lineHeight:"20px"},children:r("docs")})]})]})}const Y=v({root:({theme:t})=>({display:"flex",flexFlow:"column nowrap",height:"100vh",width:"100vw",position:"relative",color:t.colors.contentPrimary})}),ee={auth:!1,component:J,routes:[{path:"/simple/report/preview",component:O},{to:"/projects/:path?",target:"_blank",component:B}]},te=()=>{const t=L();return c.useEffect(()=>{t?.listen(s=>{s.pathname.startsWith("simple")||window.location.reload()})},[t]),null},ie=()=>{const[,t]=w(),s=Y({theme:t}),a=M(ee);return e.jsx(j.Suspense,{fallback:e.jsx(C,{}),children:e.jsx(H,{children:e.jsx("div",{className:s.root,children:e.jsxs(I,{children:[e.jsx(Q,{}),e.jsx(X,{}),a,e.jsx(te,{})]})})})})};export{ie as default};
