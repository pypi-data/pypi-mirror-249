/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
export const id = "src_data_energy_ts";
export const ids = ["src_data_energy_ts"];
export const modules = {

/***/ "./src/common/datetime/calc_date.ts":
/*!******************************************!*\
  !*** ./src/common/datetime/calc_date.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calcDate: () => (/* binding */ calcDate),\n/* harmony export */   calcDateProperty: () => (/* binding */ calcDateProperty)\n/* harmony export */ });\n/* harmony import */ var date_fns_tz__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! date-fns-tz */ \"./node_modules/date-fns-tz/esm/index.js\");\n/* harmony import */ var _data_translation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../data/translation */ \"./src/data/translation.ts\");\n\n\nconst calcZonedDate = (date, tz, fn, options) => {\n  const inputZoned = (0,date_fns_tz__WEBPACK_IMPORTED_MODULE_0__.utcToZonedTime)(date, tz);\n  const fnZoned = fn(inputZoned, options);\n  if (fnZoned instanceof Date) {\n    return (0,date_fns_tz__WEBPACK_IMPORTED_MODULE_0__.zonedTimeToUtc)(fnZoned, tz);\n  }\n  return fnZoned;\n};\nconst calcDate = (date, fn, locale, config, options) => locale.time_zone === _data_translation__WEBPACK_IMPORTED_MODULE_1__.TimeZone.server ? calcZonedDate(date, config.time_zone, fn, options) : fn(date, options);\nconst calcDateProperty = (date, fn, locale, config, options) => locale.time_zone === _data_translation__WEBPACK_IMPORTED_MODULE_1__.TimeZone.server ? calcZonedDate(date, config.time_zone, fn, options) : fn(date, options);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL2RhdGV0aW1lL2NhbGNfZGF0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFFQTtBQUVBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQVdBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvY29tbW9uL2RhdGV0aW1lL2NhbGNfZGF0ZS50cz9mZDZkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHV0Y1RvWm9uZWRUaW1lLCB6b25lZFRpbWVUb1V0YyB9IGZyb20gXCJkYXRlLWZucy10elwiO1xuaW1wb3J0IHsgSGFzc0NvbmZpZyB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcbmltcG9ydCB7IEZyb250ZW5kTG9jYWxlRGF0YSwgVGltZVpvbmUgfSBmcm9tIFwiLi4vLi4vZGF0YS90cmFuc2xhdGlvblwiO1xuXG5jb25zdCBjYWxjWm9uZWREYXRlID0gKFxuICBkYXRlOiBEYXRlLFxuICB0ejogc3RyaW5nLFxuICBmbjogKGRhdGU6IERhdGUsIG9wdGlvbnM/OiBhbnkpID0+IERhdGUgfCBudW1iZXIgfCBib29sZWFuLFxuICBvcHRpb25zP1xuKSA9PiB7XG4gIGNvbnN0IGlucHV0Wm9uZWQgPSB1dGNUb1pvbmVkVGltZShkYXRlLCB0eik7XG4gIGNvbnN0IGZuWm9uZWQgPSBmbihpbnB1dFpvbmVkLCBvcHRpb25zKTtcbiAgaWYgKGZuWm9uZWQgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgcmV0dXJuIHpvbmVkVGltZVRvVXRjKGZuWm9uZWQsIHR6KSBhcyBEYXRlO1xuICB9XG4gIHJldHVybiBmblpvbmVkO1xufTtcblxuZXhwb3J0IGNvbnN0IGNhbGNEYXRlID0gKFxuICBkYXRlOiBEYXRlLFxuICBmbjogKGRhdGU6IERhdGUsIG9wdGlvbnM/OiBhbnkpID0+IERhdGUsXG4gIGxvY2FsZTogRnJvbnRlbmRMb2NhbGVEYXRhLFxuICBjb25maWc6IEhhc3NDb25maWcsXG4gIG9wdGlvbnM/XG4pID0+XG4gIGxvY2FsZS50aW1lX3pvbmUgPT09IFRpbWVab25lLnNlcnZlclxuICAgID8gKGNhbGNab25lZERhdGUoZGF0ZSwgY29uZmlnLnRpbWVfem9uZSwgZm4sIG9wdGlvbnMpIGFzIERhdGUpXG4gICAgOiBmbihkYXRlLCBvcHRpb25zKTtcblxuZXhwb3J0IGNvbnN0IGNhbGNEYXRlUHJvcGVydHkgPSAoXG4gIGRhdGU6IERhdGUsXG4gIGZuOiAoZGF0ZTogRGF0ZSwgb3B0aW9ucz86IGFueSkgPT4gYm9vbGVhbiB8IG51bWJlcixcbiAgbG9jYWxlOiBGcm9udGVuZExvY2FsZURhdGEsXG4gIGNvbmZpZzogSGFzc0NvbmZpZyxcbiAgb3B0aW9ucz9cbikgPT5cbiAgbG9jYWxlLnRpbWVfem9uZSA9PT0gVGltZVpvbmUuc2VydmVyXG4gICAgPyAoY2FsY1pvbmVkRGF0ZShkYXRlLCBjb25maWcudGltZV96b25lLCBmbiwgb3B0aW9ucykgYXMgbnVtYmVyIHwgYm9vbGVhbilcbiAgICA6IGZuKGRhdGUsIG9wdGlvbnMpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/common/datetime/calc_date.ts\n");

/***/ }),

/***/ "./src/common/util/group-by.ts":
/*!*************************************!*\
  !*** ./src/common/util/group-by.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   groupBy: () => (/* binding */ groupBy)\n/* harmony export */ });\nconst groupBy = (list, keySelector) => {\n  const result = {};\n  for (const item of list) {\n    const key = keySelector(item);\n    if (key in result) {\n      result[key].push(item);\n    } else {\n      result[key] = [item];\n    }\n  }\n  return result;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL3V0aWwvZ3JvdXAtYnkudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2NvbW1vbi91dGlsL2dyb3VwLWJ5LnRzPzM4ODciXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGdyb3VwQnkgPSA8VD4oXG4gIGxpc3Q6IFRbXSxcbiAga2V5U2VsZWN0b3I6IChpdGVtOiBUKSA9PiBzdHJpbmdcbik6IHsgW2tleTogc3RyaW5nXTogVFtdIH0gPT4ge1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgZm9yIChjb25zdCBpdGVtIG9mIGxpc3QpIHtcbiAgICBjb25zdCBrZXkgPSBrZXlTZWxlY3RvcihpdGVtKTtcbiAgICBpZiAoa2V5IGluIHJlc3VsdCkge1xuICAgICAgcmVzdWx0W2tleV0ucHVzaChpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0W2tleV0gPSBbaXRlbV07XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/common/util/group-by.ts\n");

/***/ }),

/***/ "./src/data/config_entries.ts":
/*!************************************!*\
  !*** ./src/data/config_entries.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_STATES: () => (/* binding */ ERROR_STATES),\n/* harmony export */   RECOVERABLE_STATES: () => (/* binding */ RECOVERABLE_STATES),\n/* harmony export */   deleteConfigEntry: () => (/* binding */ deleteConfigEntry),\n/* harmony export */   disableConfigEntry: () => (/* binding */ disableConfigEntry),\n/* harmony export */   enableConfigEntry: () => (/* binding */ enableConfigEntry),\n/* harmony export */   getConfigEntries: () => (/* binding */ getConfigEntries),\n/* harmony export */   getConfigEntry: () => (/* binding */ getConfigEntry),\n/* harmony export */   reloadConfigEntry: () => (/* binding */ reloadConfigEntry),\n/* harmony export */   sortConfigEntries: () => (/* binding */ sortConfigEntries),\n/* harmony export */   subscribeConfigEntries: () => (/* binding */ subscribeConfigEntries),\n/* harmony export */   updateConfigEntry: () => (/* binding */ updateConfigEntry)\n/* harmony export */ });\n// https://github.com/home-assistant/core/blob/2286dea636fda001f03433ba14d7adbda43979e5/homeassistant/config_entries.py#L81\nconst ERROR_STATES = [\"migration_error\", \"setup_error\", \"setup_retry\"];\n\n// https://github.com/home-assistant/core/blob/2286dea636fda001f03433ba14d7adbda43979e5/homeassistant/config_entries.py#L81\nconst RECOVERABLE_STATES = [\"not_loaded\", \"loaded\", \"setup_error\", \"setup_retry\"];\nconst subscribeConfigEntries = (hass, callbackFunction, filters) => {\n  const params = {\n    type: \"config_entries/subscribe\"\n  };\n  if (filters && filters.type) {\n    params.type_filter = filters.type;\n  }\n  return hass.connection.subscribeMessage(message => callbackFunction(message), params);\n};\nconst getConfigEntries = (hass, filters) => {\n  const params = {};\n  if (filters) {\n    if (filters.type) {\n      params.type_filter = filters.type;\n    }\n    if (filters.domain) {\n      params.domain = filters.domain;\n    }\n  }\n  return hass.callWS({\n    type: \"config_entries/get\",\n    ...params\n  });\n};\nconst getConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/get_single\",\n  entry_id: configEntryId\n});\nconst updateConfigEntry = (hass, configEntryId, updatedValues) => hass.callWS({\n  type: \"config_entries/update\",\n  entry_id: configEntryId,\n  ...updatedValues\n});\nconst deleteConfigEntry = (hass, configEntryId) => hass.callApi(\"DELETE\", `config/config_entries/entry/${configEntryId}`);\nconst reloadConfigEntry = (hass, configEntryId) => hass.callApi(\"POST\", `config/config_entries/entry/${configEntryId}/reload`);\nconst disableConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/disable\",\n  entry_id: configEntryId,\n  disabled_by: \"user\"\n});\nconst enableConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/disable\",\n  entry_id: configEntryId,\n  disabled_by: null\n});\nconst sortConfigEntries = (configEntries, manifestLookup) => {\n  const sortedConfigEntries = [...configEntries];\n  const getScore = entry => {\n    const manifest = manifestLookup[entry.domain];\n    const isHelper = (manifest === null || manifest === void 0 ? void 0 : manifest.integration_type) === \"helper\";\n    return isHelper ? -1 : 1;\n  };\n  const configEntriesCompare = (a, b) => getScore(b) - getScore(a);\n  return sortedConfigEntries.sort(configEntriesCompare);\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9jb25maWdfZW50cmllcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQWlDQTtBQUNBOztBQU1BO0FBQ0E7QUFhQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFFQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBU0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvY29uZmlnX2VudHJpZXMudHM/NGZkMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFVuc3Vic2NyaWJlRnVuYyB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcbmltcG9ydCB0eXBlIHsgSG9tZUFzc2lzdGFudCB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBJbnRlZ3JhdGlvbk1hbmlmZXN0LCBJbnRlZ3JhdGlvblR5cGUgfSBmcm9tIFwiLi9pbnRlZ3JhdGlvblwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ0VudHJ5IHtcbiAgZW50cnlfaWQ6IHN0cmluZztcbiAgZG9tYWluOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIHNvdXJjZTogc3RyaW5nO1xuICBzdGF0ZTpcbiAgICB8IFwibG9hZGVkXCJcbiAgICB8IFwic2V0dXBfZXJyb3JcIlxuICAgIHwgXCJtaWdyYXRpb25fZXJyb3JcIlxuICAgIHwgXCJzZXR1cF9yZXRyeVwiXG4gICAgfCBcIm5vdF9sb2FkZWRcIlxuICAgIHwgXCJmYWlsZWRfdW5sb2FkXCJcbiAgICB8IFwic2V0dXBfaW5fcHJvZ3Jlc3NcIjtcbiAgc3VwcG9ydHNfb3B0aW9uczogYm9vbGVhbjtcbiAgc3VwcG9ydHNfcmVtb3ZlX2RldmljZTogYm9vbGVhbjtcbiAgc3VwcG9ydHNfdW5sb2FkOiBib29sZWFuO1xuICBwcmVmX2Rpc2FibGVfbmV3X2VudGl0aWVzOiBib29sZWFuO1xuICBwcmVmX2Rpc2FibGVfcG9sbGluZzogYm9vbGVhbjtcbiAgZGlzYWJsZWRfYnk6IFwidXNlclwiIHwgbnVsbDtcbiAgcmVhc29uOiBzdHJpbmcgfCBudWxsO1xufVxuXG5leHBvcnQgdHlwZSBDb25maWdFbnRyeU11dGFibGVQYXJhbXMgPSBQYXJ0aWFsPFxuICBQaWNrPFxuICAgIENvbmZpZ0VudHJ5LFxuICAgIFwidGl0bGVcIiB8IFwicHJlZl9kaXNhYmxlX25ld19lbnRpdGllc1wiIHwgXCJwcmVmX2Rpc2FibGVfcG9sbGluZ1wiXG4gID5cbj47XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ob21lLWFzc2lzdGFudC9jb3JlL2Jsb2IvMjI4NmRlYTYzNmZkYTAwMWYwMzQzM2JhMTRkN2FkYmRhNDM5NzllNS9ob21lYXNzaXN0YW50L2NvbmZpZ19lbnRyaWVzLnB5I0w4MVxuZXhwb3J0IGNvbnN0IEVSUk9SX1NUQVRFUzogQ29uZmlnRW50cnlbXCJzdGF0ZVwiXVtdID0gW1xuICBcIm1pZ3JhdGlvbl9lcnJvclwiLFxuICBcInNldHVwX2Vycm9yXCIsXG4gIFwic2V0dXBfcmV0cnlcIixcbl07XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ob21lLWFzc2lzdGFudC9jb3JlL2Jsb2IvMjI4NmRlYTYzNmZkYTAwMWYwMzQzM2JhMTRkN2FkYmRhNDM5NzllNS9ob21lYXNzaXN0YW50L2NvbmZpZ19lbnRyaWVzLnB5I0w4MVxuZXhwb3J0IGNvbnN0IFJFQ09WRVJBQkxFX1NUQVRFUzogQ29uZmlnRW50cnlbXCJzdGF0ZVwiXVtdID0gW1xuICBcIm5vdF9sb2FkZWRcIixcbiAgXCJsb2FkZWRcIixcbiAgXCJzZXR1cF9lcnJvclwiLFxuICBcInNldHVwX3JldHJ5XCIsXG5dO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ0VudHJ5VXBkYXRlIHtcbiAgLy8gbnVsbCBtZWFucyBubyB1cGRhdGUgYXMgaXMgdGhlIGN1cnJlbnQgc3RhdGVcbiAgdHlwZTogbnVsbCB8IFwiYWRkZWRcIiB8IFwicmVtb3ZlZFwiIHwgXCJ1cGRhdGVkXCI7XG4gIGVudHJ5OiBDb25maWdFbnRyeTtcbn1cblxuZXhwb3J0IGNvbnN0IHN1YnNjcmliZUNvbmZpZ0VudHJpZXMgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGNhbGxiYWNrRnVuY3Rpb246IChtZXNzYWdlOiBDb25maWdFbnRyeVVwZGF0ZVtdKSA9PiB2b2lkLFxuICBmaWx0ZXJzPzoge1xuICAgIHR5cGU/OiBJbnRlZ3JhdGlvblR5cGVbXTtcbiAgICBkb21haW4/OiBzdHJpbmc7XG4gIH1cbik6IFByb21pc2U8VW5zdWJzY3JpYmVGdW5jPiA9PiB7XG4gIGNvbnN0IHBhcmFtczogYW55ID0ge1xuICAgIHR5cGU6IFwiY29uZmlnX2VudHJpZXMvc3Vic2NyaWJlXCIsXG4gIH07XG4gIGlmIChmaWx0ZXJzICYmIGZpbHRlcnMudHlwZSkge1xuICAgIHBhcmFtcy50eXBlX2ZpbHRlciA9IGZpbHRlcnMudHlwZTtcbiAgfVxuICByZXR1cm4gaGFzcy5jb25uZWN0aW9uLnN1YnNjcmliZU1lc3NhZ2U8Q29uZmlnRW50cnlVcGRhdGVbXT4oXG4gICAgKG1lc3NhZ2UpID0+IGNhbGxiYWNrRnVuY3Rpb24obWVzc2FnZSksXG4gICAgcGFyYW1zXG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Q29uZmlnRW50cmllcyA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgZmlsdGVycz86IHtcbiAgICB0eXBlPzogSW50ZWdyYXRpb25UeXBlW107XG4gICAgZG9tYWluPzogc3RyaW5nO1xuICB9XG4pOiBQcm9taXNlPENvbmZpZ0VudHJ5W10+ID0+IHtcbiAgY29uc3QgcGFyYW1zOiBhbnkgPSB7fTtcbiAgaWYgKGZpbHRlcnMpIHtcbiAgICBpZiAoZmlsdGVycy50eXBlKSB7XG4gICAgICBwYXJhbXMudHlwZV9maWx0ZXIgPSBmaWx0ZXJzLnR5cGU7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLmRvbWFpbikge1xuICAgICAgcGFyYW1zLmRvbWFpbiA9IGZpbHRlcnMuZG9tYWluO1xuICAgIH1cbiAgfVxuICByZXR1cm4gaGFzcy5jYWxsV1M8Q29uZmlnRW50cnlbXT4oe1xuICAgIHR5cGU6IFwiY29uZmlnX2VudHJpZXMvZ2V0XCIsXG4gICAgLi4ucGFyYW1zLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRDb25maWdFbnRyeSA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBjb25maWdFbnRyeUlkOiBzdHJpbmcpID0+XG4gIGhhc3MuY2FsbFdTPHsgY29uZmlnX2VudHJ5OiBDb25maWdFbnRyeSB9Pih7XG4gICAgdHlwZTogXCJjb25maWdfZW50cmllcy9nZXRfc2luZ2xlXCIsXG4gICAgZW50cnlfaWQ6IGNvbmZpZ0VudHJ5SWQsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlQ29uZmlnRW50cnkgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGNvbmZpZ0VudHJ5SWQ6IHN0cmluZyxcbiAgdXBkYXRlZFZhbHVlczogQ29uZmlnRW50cnlNdXRhYmxlUGFyYW1zXG4pID0+XG4gIGhhc3MuY2FsbFdTPHsgcmVxdWlyZV9yZXN0YXJ0OiBib29sZWFuOyBjb25maWdfZW50cnk6IENvbmZpZ0VudHJ5IH0+KHtcbiAgICB0eXBlOiBcImNvbmZpZ19lbnRyaWVzL3VwZGF0ZVwiLFxuICAgIGVudHJ5X2lkOiBjb25maWdFbnRyeUlkLFxuICAgIC4uLnVwZGF0ZWRWYWx1ZXMsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZGVsZXRlQ29uZmlnRW50cnkgPSAoaGFzczogSG9tZUFzc2lzdGFudCwgY29uZmlnRW50cnlJZDogc3RyaW5nKSA9PlxuICBoYXNzLmNhbGxBcGk8e1xuICAgIHJlcXVpcmVfcmVzdGFydDogYm9vbGVhbjtcbiAgfT4oXCJERUxFVEVcIiwgYGNvbmZpZy9jb25maWdfZW50cmllcy9lbnRyeS8ke2NvbmZpZ0VudHJ5SWR9YCk7XG5cbmV4cG9ydCBjb25zdCByZWxvYWRDb25maWdFbnRyeSA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBjb25maWdFbnRyeUlkOiBzdHJpbmcpID0+XG4gIGhhc3MuY2FsbEFwaTx7XG4gICAgcmVxdWlyZV9yZXN0YXJ0OiBib29sZWFuO1xuICB9PihcIlBPU1RcIiwgYGNvbmZpZy9jb25maWdfZW50cmllcy9lbnRyeS8ke2NvbmZpZ0VudHJ5SWR9L3JlbG9hZGApO1xuXG5leHBvcnQgaW50ZXJmYWNlIERpc2FibGVDb25maWdFbnRyeVJlc3VsdCB7XG4gIHJlcXVpcmVfcmVzdGFydDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IGRpc2FibGVDb25maWdFbnRyeSA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgY29uZmlnRW50cnlJZDogc3RyaW5nXG4pID0+XG4gIGhhc3MuY2FsbFdTPERpc2FibGVDb25maWdFbnRyeVJlc3VsdD4oe1xuICAgIHR5cGU6IFwiY29uZmlnX2VudHJpZXMvZGlzYWJsZVwiLFxuICAgIGVudHJ5X2lkOiBjb25maWdFbnRyeUlkLFxuICAgIGRpc2FibGVkX2J5OiBcInVzZXJcIixcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBlbmFibGVDb25maWdFbnRyeSA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBjb25maWdFbnRyeUlkOiBzdHJpbmcpID0+XG4gIGhhc3MuY2FsbFdTPHtcbiAgICByZXF1aXJlX3Jlc3RhcnQ6IGJvb2xlYW47XG4gIH0+KHtcbiAgICB0eXBlOiBcImNvbmZpZ19lbnRyaWVzL2Rpc2FibGVcIixcbiAgICBlbnRyeV9pZDogY29uZmlnRW50cnlJZCxcbiAgICBkaXNhYmxlZF9ieTogbnVsbCxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBzb3J0Q29uZmlnRW50cmllcyA9IChcbiAgY29uZmlnRW50cmllczogQ29uZmlnRW50cnlbXSxcbiAgbWFuaWZlc3RMb29rdXA6IHsgW2RvbWFpbjogc3RyaW5nXTogSW50ZWdyYXRpb25NYW5pZmVzdCB9XG4pOiBDb25maWdFbnRyeVtdID0+IHtcbiAgY29uc3Qgc29ydGVkQ29uZmlnRW50cmllcyA9IFsuLi5jb25maWdFbnRyaWVzXTtcblxuICBjb25zdCBnZXRTY29yZSA9IChlbnRyeTogQ29uZmlnRW50cnkpID0+IHtcbiAgICBjb25zdCBtYW5pZmVzdCA9IG1hbmlmZXN0TG9va3VwW2VudHJ5LmRvbWFpbl0gYXNcbiAgICAgIHwgSW50ZWdyYXRpb25NYW5pZmVzdFxuICAgICAgfCB1bmRlZmluZWQ7XG4gICAgY29uc3QgaXNIZWxwZXIgPSBtYW5pZmVzdD8uaW50ZWdyYXRpb25fdHlwZSA9PT0gXCJoZWxwZXJcIjtcbiAgICByZXR1cm4gaXNIZWxwZXIgPyAtMSA6IDE7XG4gIH07XG5cbiAgY29uc3QgY29uZmlnRW50cmllc0NvbXBhcmUgPSAoYTogQ29uZmlnRW50cnksIGI6IENvbmZpZ0VudHJ5KSA9PlxuICAgIGdldFNjb3JlKGIpIC0gZ2V0U2NvcmUoYSk7XG5cbiAgcmV0dXJuIHNvcnRlZENvbmZpZ0VudHJpZXMuc29ydChjb25maWdFbnRyaWVzQ29tcGFyZSk7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/data/config_entries.ts\n");

/***/ }),

/***/ "./src/data/energy.ts":
/*!****************************!*\
  !*** ./src/data/energy.ts ***!
  \****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   emptyBatteryEnergyPreference: () => (/* binding */ emptyBatteryEnergyPreference),\n/* harmony export */   emptyFlowFromGridSourceEnergyPreference: () => (/* binding */ emptyFlowFromGridSourceEnergyPreference),\n/* harmony export */   emptyFlowToGridSourceEnergyPreference: () => (/* binding */ emptyFlowToGridSourceEnergyPreference),\n/* harmony export */   emptyGasEnergyPreference: () => (/* binding */ emptyGasEnergyPreference),\n/* harmony export */   emptyGridSourceEnergyPreference: () => (/* binding */ emptyGridSourceEnergyPreference),\n/* harmony export */   emptySolarEnergyPreference: () => (/* binding */ emptySolarEnergyPreference),\n/* harmony export */   emptyWaterEnergyPreference: () => (/* binding */ emptyWaterEnergyPreference),\n/* harmony export */   energySourcesByType: () => (/* binding */ energySourcesByType),\n/* harmony export */   energyStatisticHelpUrl: () => (/* binding */ energyStatisticHelpUrl),\n/* harmony export */   getEnergyDataCollection: () => (/* binding */ getEnergyDataCollection),\n/* harmony export */   getEnergyGasUnit: () => (/* binding */ getEnergyGasUnit),\n/* harmony export */   getEnergyGasUnitClass: () => (/* binding */ getEnergyGasUnitClass),\n/* harmony export */   getEnergyInfo: () => (/* binding */ getEnergyInfo),\n/* harmony export */   getEnergyPreferenceValidation: () => (/* binding */ getEnergyPreferenceValidation),\n/* harmony export */   getEnergyPreferences: () => (/* binding */ getEnergyPreferences),\n/* harmony export */   getEnergySolarForecasts: () => (/* binding */ getEnergySolarForecasts),\n/* harmony export */   getEnergyWaterUnit: () => (/* binding */ getEnergyWaterUnit),\n/* harmony export */   getFossilEnergyConsumption: () => (/* binding */ getFossilEnergyConsumption),\n/* harmony export */   getReferencedStatisticIds: () => (/* binding */ getReferencedStatisticIds),\n/* harmony export */   saveEnergyPreferences: () => (/* binding */ saveEnergyPreferences)\n/* harmony export */ });\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/differenceInDays/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/isFirstDayOfMonth/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/isLastDayOfMonth/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addMonths/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/differenceInMonths/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addDays/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addMilliseconds/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/startOfDay/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/endOfDay/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addHours/index.js\");\n/* harmony import */ var home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! home-assistant-js-websocket */ \"./node_modules/home-assistant-js-websocket/dist/collection.js\");\n/* harmony import */ var _common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/datetime/calc_date */ \"./src/common/datetime/calc_date.ts\");\n/* harmony import */ var _common_datetime_format_time__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/datetime/format_time */ \"./src/common/datetime/format_time.ts\");\n/* harmony import */ var _common_util_group_by__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/util/group-by */ \"./src/common/util/group-by.ts\");\n/* harmony import */ var _config_entries__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config_entries */ \"./src/data/config_entries.ts\");\n/* harmony import */ var _recorder__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./recorder */ \"./src/data/recorder.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_common_datetime_format_time__WEBPACK_IMPORTED_MODULE_1__]);\n_common_datetime_format_time__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\nconst energyCollectionKeys = [];\nconst emptyFlowFromGridSourceEnergyPreference = () => ({\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyFlowToGridSourceEnergyPreference = () => ({\n  stat_energy_to: \"\",\n  stat_compensation: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyGridSourceEnergyPreference = () => ({\n  type: \"grid\",\n  flow_from: [],\n  flow_to: [],\n  cost_adjustment_day: 0\n});\nconst emptySolarEnergyPreference = () => ({\n  type: \"solar\",\n  stat_energy_from: \"\",\n  config_entry_solar_forecast: null\n});\nconst emptyBatteryEnergyPreference = () => ({\n  type: \"battery\",\n  stat_energy_from: \"\",\n  stat_energy_to: \"\"\n});\nconst emptyGasEnergyPreference = () => ({\n  type: \"gas\",\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyWaterEnergyPreference = () => ({\n  type: \"water\",\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst getEnergyInfo = hass => hass.callWS({\n  type: \"energy/info\"\n});\nconst getEnergyPreferenceValidation = async hass => {\n  await hass.loadBackendTranslation(\"issues\", \"energy\");\n  return hass.callWS({\n    type: \"energy/validate\"\n  });\n};\nconst getEnergyPreferences = hass => hass.callWS({\n  type: \"energy/get_prefs\"\n});\nconst saveEnergyPreferences = async (hass, prefs) => {\n  const newPrefs = hass.callWS({\n    type: \"energy/save_prefs\",\n    ...prefs\n  });\n  clearEnergyCollectionPreferences(hass);\n  return newPrefs;\n};\nconst getFossilEnergyConsumption = async (hass, startTime, energy_statistic_ids, co2_statistic_id, endTime, period = \"hour\") => hass.callWS({\n  type: \"energy/fossil_energy_consumption\",\n  start_time: startTime.toISOString(),\n  end_time: endTime === null || endTime === void 0 ? void 0 : endTime.toISOString(),\n  energy_statistic_ids,\n  co2_statistic_id,\n  period\n});\nconst energySourcesByType = prefs => (0,_common_util_group_by__WEBPACK_IMPORTED_MODULE_2__.groupBy)(prefs.energy_sources, item => item.type);\nconst getReferencedStatisticIds = (prefs, info, includeTypes) => {\n  const statIDs = [];\n  for (const source of prefs.energy_sources) {\n    if (includeTypes && !includeTypes.includes(source.type)) {\n      continue;\n    }\n    if (source.type === \"solar\") {\n      statIDs.push(source.stat_energy_from);\n      continue;\n    }\n    if (source.type === \"gas\" || source.type === \"water\") {\n      statIDs.push(source.stat_energy_from);\n      if (source.stat_cost) {\n        statIDs.push(source.stat_cost);\n      }\n      const costStatId = info.cost_sensors[source.stat_energy_from];\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n      continue;\n    }\n    if (source.type === \"battery\") {\n      statIDs.push(source.stat_energy_from);\n      statIDs.push(source.stat_energy_to);\n      continue;\n    }\n\n    // grid source\n    for (const flowFrom of source.flow_from) {\n      statIDs.push(flowFrom.stat_energy_from);\n      if (flowFrom.stat_cost) {\n        statIDs.push(flowFrom.stat_cost);\n      }\n      const costStatId = info.cost_sensors[flowFrom.stat_energy_from];\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n    }\n    for (const flowTo of source.flow_to) {\n      statIDs.push(flowTo.stat_energy_to);\n      if (flowTo.stat_compensation) {\n        statIDs.push(flowTo.stat_compensation);\n      }\n      const costStatId = info.cost_sensors[flowTo.stat_energy_to];\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n    }\n  }\n  return statIDs;\n};\nconst getEnergyData = async (hass, prefs, start, end, compare) => {\n  const [configEntries, info] = await Promise.all([(0,_config_entries__WEBPACK_IMPORTED_MODULE_3__.getConfigEntries)(hass, {\n    domain: \"co2signal\"\n  }), getEnergyInfo(hass)]);\n  const co2SignalConfigEntry = configEntries.length ? configEntries[0] : undefined;\n  let co2SignalEntity;\n  if (co2SignalConfigEntry) {\n    for (const entity of Object.values(hass.entities)) {\n      if (entity.platform !== \"co2signal\") {\n        continue;\n      }\n\n      // The integration offers 2 entities. We want the % one.\n      const co2State = hass.states[entity.entity_id];\n      if (!co2State || co2State.attributes.unit_of_measurement !== \"%\") {\n        continue;\n      }\n      co2SignalEntity = co2State.entity_id;\n      break;\n    }\n  }\n  const consumptionStatIDs = [];\n  for (const source of prefs.energy_sources) {\n    // grid source\n    if (source.type === \"grid\") {\n      for (const flowFrom of source.flow_from) {\n        consumptionStatIDs.push(flowFrom.stat_energy_from);\n      }\n    }\n  }\n  const energyStatIds = getReferencedStatisticIds(prefs, info, [\"grid\", \"solar\", \"battery\", \"gas\"]);\n  const waterStatIds = getReferencedStatisticIds(prefs, info, [\"water\"]);\n  const allStatIDs = [...energyStatIds, ...waterStatIds];\n  const dayDifference = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(end || new Date(), start);\n  const period = dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\";\n  const lengthUnit = hass.config.unit_system.length || \"\";\n  const energyUnits = {\n    energy: \"kWh\",\n    volume: lengthUnit === \"km\" ? \"m³\" : \"ft³\"\n  };\n  const waterUnits = {\n    volume: lengthUnit === \"km\" ? \"L\" : \"gal\"\n  };\n  const _energyStats = energyStatIds.length ? (0,_recorder__WEBPACK_IMPORTED_MODULE_4__.fetchStatistics)(hass, start, end, energyStatIds, period, energyUnits, [\"change\"]) : {};\n  const _waterStats = waterStatIds.length ? (0,_recorder__WEBPACK_IMPORTED_MODULE_4__.fetchStatistics)(hass, start, end, waterStatIds, period, waterUnits, [\"change\"]) : {};\n  let statsCompare;\n  let startCompare;\n  let endCompare;\n  let _energyStatsCompare = {};\n  let _waterStatsCompare = {};\n  if (compare) {\n    if ((0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDateProperty)(start, date_fns_esm__WEBPACK_IMPORTED_MODULE_6__[\"default\"], hass.locale, hass.config) && (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDateProperty)(end || new Date(), date_fns_esm__WEBPACK_IMPORTED_MODULE_7__[\"default\"], hass.locale, hass.config)) {\n      // When comparing a month (or multiple), we want to start at the begining of the month\n      startCompare = (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(start, date_fns_esm__WEBPACK_IMPORTED_MODULE_8__[\"default\"], hass.locale, hass.config, -(0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDateProperty)(end || new Date(), date_fns_esm__WEBPACK_IMPORTED_MODULE_9__[\"default\"], hass.locale, hass.config, start) - 1);\n    } else {\n      startCompare = (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(start, date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"], hass.locale, hass.config, (dayDifference + 1) * -1);\n    }\n    endCompare = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_11__[\"default\"])(start, -1);\n    if (energyStatIds.length) {\n      _energyStatsCompare = (0,_recorder__WEBPACK_IMPORTED_MODULE_4__.fetchStatistics)(hass, startCompare, endCompare, energyStatIds, period, energyUnits, [\"change\"]);\n    }\n    if (waterStatIds.length) {\n      _waterStatsCompare = (0,_recorder__WEBPACK_IMPORTED_MODULE_4__.fetchStatistics)(hass, startCompare, endCompare, waterStatIds, period, waterUnits, [\"change\"]);\n    }\n  }\n  let _fossilEnergyConsumption;\n  let _fossilEnergyConsumptionCompare;\n  if (co2SignalEntity !== undefined) {\n    _fossilEnergyConsumption = getFossilEnergyConsumption(hass, start, consumptionStatIDs, co2SignalEntity, end, dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\");\n    if (compare) {\n      _fossilEnergyConsumptionCompare = getFossilEnergyConsumption(hass, startCompare, consumptionStatIDs, co2SignalEntity, endCompare, dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\");\n    }\n  }\n  const statsMetadata = {};\n  const _getStatisticMetadata = allStatIDs.length ? (0,_recorder__WEBPACK_IMPORTED_MODULE_4__.getStatisticMetadata)(hass, allStatIDs) : [];\n  const [energyStats, waterStats, energyStatsCompare, waterStatsCompare, statsMetadataArray, fossilEnergyConsumption, fossilEnergyConsumptionCompare] = await Promise.all([_energyStats, _waterStats, _energyStatsCompare, _waterStatsCompare, _getStatisticMetadata, _fossilEnergyConsumption, _fossilEnergyConsumptionCompare]);\n  const stats = {\n    ...energyStats,\n    ...waterStats\n  };\n  if (compare) {\n    statsCompare = {\n      ...energyStatsCompare,\n      ...waterStatsCompare\n    };\n  }\n  if (allStatIDs.length) {\n    statsMetadataArray.forEach(x => {\n      statsMetadata[x.statistic_id] = x;\n    });\n  }\n  const data = {\n    start,\n    end,\n    startCompare,\n    endCompare,\n    info,\n    prefs,\n    stats,\n    statsMetadata,\n    statsCompare,\n    co2SignalConfigEntry,\n    co2SignalEntity,\n    fossilEnergyConsumption,\n    fossilEnergyConsumptionCompare\n  };\n  return data;\n};\nconst clearEnergyCollectionPreferences = hass => {\n  energyCollectionKeys.forEach(key => {\n    const energyCollection = getEnergyDataCollection(hass, {\n      key\n    });\n    energyCollection.clearPrefs();\n    if (energyCollection._active) {\n      energyCollection.refresh();\n    }\n  });\n};\nconst scheduleHourlyRefresh = collection => {\n  if (collection._refreshTimeout) {\n    clearTimeout(collection._refreshTimeout);\n  }\n  if (collection._active && (!collection.end || collection.end > new Date())) {\n    // The stats are created every hour\n    // Schedule a refresh for 20 minutes past the hour\n    // If the end is larger than the current time.\n    const nextFetch = new Date();\n    if (nextFetch.getMinutes() >= 20) {\n      nextFetch.setHours(nextFetch.getHours() + 1);\n    }\n    nextFetch.setMinutes(20, 0, 0);\n    collection._refreshTimeout = window.setTimeout(() => collection.refresh(), nextFetch.getTime() - Date.now());\n  }\n};\nconst getEnergyDataCollection = (hass, options = {}) => {\n  let key = \"_energy\";\n  if (options.key) {\n    if (!options.key.startsWith(\"energy_\")) {\n      throw new Error(\"Key need to start with energy_\");\n    }\n    key = `_${options.key}`;\n  }\n  if (hass.connection[key]) {\n    return hass.connection[key];\n  }\n  energyCollectionKeys.push(options.key);\n  const collection = (0,home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_12__.getCollection)(hass.connection, key, async () => {\n    if (!collection.prefs) {\n      // This will raise if not found.\n      // Detect by checking `e.code === \"not_found\"\n      collection.prefs = await getEnergyPreferences(hass);\n    }\n    scheduleHourlyRefresh(collection);\n    return getEnergyData(hass, collection.prefs, collection.start, collection.end, collection.compare);\n  });\n  const origSubscribe = collection.subscribe;\n  collection.subscribe = subscriber => {\n    const unsub = origSubscribe(subscriber);\n    collection._active++;\n    if (collection._refreshTimeout === undefined) {\n      scheduleHourlyRefresh(collection);\n    }\n    return () => {\n      collection._active--;\n      if (collection._active < 1) {\n        clearTimeout(collection._refreshTimeout);\n        collection._refreshTimeout = undefined;\n      }\n      unsub();\n    };\n  };\n  collection._active = 0;\n  collection.prefs = options.prefs;\n  const now = new Date();\n  const hour = (0,_common_datetime_format_time__WEBPACK_IMPORTED_MODULE_1__.formatTime24h)(now, hass.locale, hass.config).split(\":\")[0];\n  // Set start to start of today if we have data for today, otherwise yesterday\n  collection.start = (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(hour === \"0\" ? (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(now, -1) : now, date_fns_esm__WEBPACK_IMPORTED_MODULE_13__[\"default\"], hass.locale, hass.config);\n  collection.end = (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(hour === \"0\" ? (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(now, -1) : now, date_fns_esm__WEBPACK_IMPORTED_MODULE_14__[\"default\"], hass.locale, hass.config);\n  const scheduleUpdatePeriod = () => {\n    collection._updatePeriodTimeout = window.setTimeout(() => {\n      collection.start = (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(new Date(), date_fns_esm__WEBPACK_IMPORTED_MODULE_13__[\"default\"], hass.locale, hass.config);\n      collection.end = (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(new Date(), date_fns_esm__WEBPACK_IMPORTED_MODULE_14__[\"default\"], hass.locale, hass.config);\n      scheduleUpdatePeriod();\n    }, (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_15__[\"default\"])((0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(now, date_fns_esm__WEBPACK_IMPORTED_MODULE_14__[\"default\"], hass.locale, hass.config), 1).getTime() - Date.now() // Switch to next day an hour after the day changed\n    );\n  };\n  scheduleUpdatePeriod();\n  collection.clearPrefs = () => {\n    collection.prefs = undefined;\n  };\n  collection.setPeriod = (newStart, newEnd) => {\n    var _collection$end;\n    collection.start = newStart;\n    collection.end = newEnd;\n    if (collection.start.getTime() === (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(new Date(), date_fns_esm__WEBPACK_IMPORTED_MODULE_13__[\"default\"], hass.locale, hass.config).getTime() && ((_collection$end = collection.end) === null || _collection$end === void 0 ? void 0 : _collection$end.getTime()) === (0,_common_datetime_calc_date__WEBPACK_IMPORTED_MODULE_0__.calcDate)(new Date(), date_fns_esm__WEBPACK_IMPORTED_MODULE_14__[\"default\"], hass.locale, hass.config).getTime() && !collection._updatePeriodTimeout) {\n      scheduleUpdatePeriod();\n    } else if (collection._updatePeriodTimeout) {\n      clearTimeout(collection._updatePeriodTimeout);\n      collection._updatePeriodTimeout = undefined;\n    }\n  };\n  collection.setCompare = compare => {\n    collection.compare = compare;\n  };\n  return collection;\n};\nconst getEnergySolarForecasts = hass => hass.callWS({\n  type: \"energy/solar_forecast\"\n});\nconst energyGasUnitClass = [\"volume\", \"energy\"];\nconst getEnergyGasUnitClass = (prefs, statisticsMetaData = {}, excludeSource) => {\n  for (const source of prefs.energy_sources) {\n    if (source.type !== \"gas\") {\n      continue;\n    }\n    if (excludeSource && excludeSource === source.stat_energy_from) {\n      continue;\n    }\n    const statisticIdWithMeta = statisticsMetaData[source.stat_energy_from];\n    if (energyGasUnitClass.includes(statisticIdWithMeta === null || statisticIdWithMeta === void 0 ? void 0 : statisticIdWithMeta.unit_class)) {\n      return statisticIdWithMeta.unit_class;\n    }\n  }\n  return undefined;\n};\nconst getEnergyGasUnit = (hass, prefs, statisticsMetaData = {}) => {\n  const unitClass = getEnergyGasUnitClass(prefs, statisticsMetaData);\n  if (unitClass === undefined) {\n    return undefined;\n  }\n  return unitClass === \"energy\" ? \"kWh\" : hass.config.unit_system.length === \"km\" ? \"m³\" : \"ft³\";\n};\nconst getEnergyWaterUnit = hass => hass.config.unit_system.length === \"km\" ? \"L\" : \"gal\";\nconst energyStatisticHelpUrl = \"/docs/energy/faq/#troubleshooting-missing-entities\";\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9lbmVyZ3kudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFRQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFIQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBbUJBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFPQTtBQUNBO0FBQUE7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQWNBO0FBQ0E7QUFhQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFRQTtBQUNBO0FBUUE7QUFDQTtBQUVBO0FBQ0E7QUFLQTtBQWlCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBZUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQU9BO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQU9BO0FBQ0E7QUFFQTtBQU1BO0FBTUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUVBO0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lLWFzc2lzdGFudC1mcm9udGVuZC8uL3NyYy9kYXRhL2VuZXJneS50cz8yMjE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGFkZERheXMsXG4gIGFkZEhvdXJzLFxuICBhZGRNaWxsaXNlY29uZHMsXG4gIGFkZE1vbnRocyxcbiAgZGlmZmVyZW5jZUluRGF5cyxcbiAgZGlmZmVyZW5jZUluTW9udGhzLFxuICBlbmRPZkRheSxcbiAgc3RhcnRPZkRheSxcbiAgaXNGaXJzdERheU9mTW9udGgsXG4gIGlzTGFzdERheU9mTW9udGgsXG59IGZyb20gXCJkYXRlLWZucy9lc21cIjtcbmltcG9ydCB7IENvbGxlY3Rpb24sIGdldENvbGxlY3Rpb24gfSBmcm9tIFwiaG9tZS1hc3Npc3RhbnQtanMtd2Vic29ja2V0XCI7XG5pbXBvcnQgeyBjYWxjRGF0ZSwgY2FsY0RhdGVQcm9wZXJ0eSB9IGZyb20gXCIuLi9jb21tb24vZGF0ZXRpbWUvY2FsY19kYXRlXCI7XG5pbXBvcnQgeyBmb3JtYXRUaW1lMjRoIH0gZnJvbSBcIi4uL2NvbW1vbi9kYXRldGltZS9mb3JtYXRfdGltZVwiO1xuaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gXCIuLi9jb21tb24vdXRpbC9ncm91cC1ieVwiO1xuaW1wb3J0IHsgSG9tZUFzc2lzdGFudCB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgQ29uZmlnRW50cnksIGdldENvbmZpZ0VudHJpZXMgfSBmcm9tIFwiLi9jb25maWdfZW50cmllc1wiO1xuaW1wb3J0IHtcbiAgZmV0Y2hTdGF0aXN0aWNzLFxuICBnZXRTdGF0aXN0aWNNZXRhZGF0YSxcbiAgU3RhdGlzdGljcyxcbiAgU3RhdGlzdGljc01ldGFEYXRhLFxuICBTdGF0aXN0aWNzVW5pdENvbmZpZ3VyYXRpb24sXG59IGZyb20gXCIuL3JlY29yZGVyXCI7XG5cbmNvbnN0IGVuZXJneUNvbGxlY3Rpb25LZXlzOiAoc3RyaW5nIHwgdW5kZWZpbmVkKVtdID0gW107XG5cbmV4cG9ydCBjb25zdCBlbXB0eUZsb3dGcm9tR3JpZFNvdXJjZUVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogRmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICAgIHN0YXRfZW5lcmd5X2Zyb206IFwiXCIsXG4gICAgc3RhdF9jb3N0OiBudWxsLFxuICAgIGVudGl0eV9lbmVyZ3lfcHJpY2U6IG51bGwsXG4gICAgbnVtYmVyX2VuZXJneV9wcmljZTogbnVsbCxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBlbXB0eUZsb3dUb0dyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlID1cbiAgKCk6IEZsb3dUb0dyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlID0+ICh7XG4gICAgc3RhdF9lbmVyZ3lfdG86IFwiXCIsXG4gICAgc3RhdF9jb21wZW5zYXRpb246IG51bGwsXG4gICAgZW50aXR5X2VuZXJneV9wcmljZTogbnVsbCxcbiAgICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudWxsLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5R3JpZFNvdXJjZUVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogR3JpZFNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlID0+ICh7XG4gICAgdHlwZTogXCJncmlkXCIsXG4gICAgZmxvd19mcm9tOiBbXSxcbiAgICBmbG93X3RvOiBbXSxcbiAgICBjb3N0X2FkanVzdG1lbnRfZGF5OiAwLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5U29sYXJFbmVyZ3lQcmVmZXJlbmNlID1cbiAgKCk6IFNvbGFyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICB0eXBlOiBcInNvbGFyXCIsXG4gICAgc3RhdF9lbmVyZ3lfZnJvbTogXCJcIixcbiAgICBjb25maWdfZW50cnlfc29sYXJfZm9yZWNhc3Q6IG51bGwsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlCYXR0ZXJ5RW5lcmd5UHJlZmVyZW5jZSA9XG4gICgpOiBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICB0eXBlOiBcImJhdHRlcnlcIixcbiAgICBzdGF0X2VuZXJneV9mcm9tOiBcIlwiLFxuICAgIHN0YXRfZW5lcmd5X3RvOiBcIlwiLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5R2FzRW5lcmd5UHJlZmVyZW5jZSA9ICgpOiBHYXNTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICB0eXBlOiBcImdhc1wiLFxuICBzdGF0X2VuZXJneV9mcm9tOiBcIlwiLFxuICBzdGF0X2Nvc3Q6IG51bGwsXG4gIGVudGl0eV9lbmVyZ3lfcHJpY2U6IG51bGwsXG4gIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bGwsXG59KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5V2F0ZXJFbmVyZ3lQcmVmZXJlbmNlID1cbiAgKCk6IFdhdGVyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICB0eXBlOiBcIndhdGVyXCIsXG4gICAgc3RhdF9lbmVyZ3lfZnJvbTogXCJcIixcbiAgICBzdGF0X2Nvc3Q6IG51bGwsXG4gICAgZW50aXR5X2VuZXJneV9wcmljZTogbnVsbCxcbiAgICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudWxsLFxuICB9KTtcblxuaW50ZXJmYWNlIEVuZXJneVNvbGFyRm9yZWNhc3Qge1xuICB3aF9ob3VyczogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbn1cbmV4cG9ydCB0eXBlIEVuZXJneVNvbGFyRm9yZWNhc3RzID0ge1xuICBbY29uZmlnX2VudHJ5X2lkOiBzdHJpbmddOiBFbmVyZ3lTb2xhckZvcmVjYXN0O1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBEZXZpY2VDb25zdW1wdGlvbkVuZXJneVByZWZlcmVuY2Uge1xuICAvLyBUaGlzIGlzIGFuIGV2ZXIgaW5jcmVhc2luZyB2YWx1ZVxuICBzdGF0X2NvbnN1bXB0aW9uOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIC8vIGtXaCBtZXRlclxuICBzdGF0X2VuZXJneV9mcm9tOiBzdHJpbmc7XG5cbiAgLy8gJCBtZXRlclxuICBzdGF0X2Nvc3Q6IHN0cmluZyB8IG51bGw7XG5cbiAgLy8gQ2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgY29zdHMgaWYgc3RhdF9jb3N0IG9taXR0ZWRcbiAgZW50aXR5X2VuZXJneV9wcmljZTogc3RyaW5nIHwgbnVsbDtcbiAgbnVtYmVyX2VuZXJneV9wcmljZTogbnVtYmVyIHwgbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGbG93VG9HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIC8vIGtXaCBtZXRlclxuICBzdGF0X2VuZXJneV90bzogc3RyaW5nO1xuXG4gIC8vICQgbWV0ZXJcbiAgc3RhdF9jb21wZW5zYXRpb246IHN0cmluZyB8IG51bGw7XG5cbiAgLy8gQ2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgY29zdHMgaWYgc3RhdF9jb21wZW5zYXRpb24gb21pdHRlZFxuICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBzdHJpbmcgfCBudWxsO1xuICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudW1iZXIgfCBudWxsO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdyaWRTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIHR5cGU6IFwiZ3JpZFwiO1xuXG4gIGZsb3dfZnJvbTogRmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZVtdO1xuICBmbG93X3RvOiBGbG93VG9HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZVtdO1xuXG4gIGNvc3RfYWRqdXN0bWVudF9kYXk6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTb2xhclNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgdHlwZTogXCJzb2xhclwiO1xuXG4gIHN0YXRfZW5lcmd5X2Zyb206IHN0cmluZztcbiAgY29uZmlnX2VudHJ5X3NvbGFyX2ZvcmVjYXN0OiBzdHJpbmdbXSB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmF0dGVyeVNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgdHlwZTogXCJiYXR0ZXJ5XCI7XG4gIHN0YXRfZW5lcmd5X2Zyb206IHN0cmluZztcbiAgc3RhdF9lbmVyZ3lfdG86IHN0cmluZztcbn1cbmV4cG9ydCBpbnRlcmZhY2UgR2FzU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2Uge1xuICB0eXBlOiBcImdhc1wiO1xuXG4gIC8vIGtXaC92b2x1bWUgbWV0ZXJcbiAgc3RhdF9lbmVyZ3lfZnJvbTogc3RyaW5nO1xuXG4gIC8vICQgbWV0ZXJcbiAgc3RhdF9jb3N0OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8vIENhbiBiZSB1c2VkIHRvIGdlbmVyYXRlIGNvc3RzIGlmIHN0YXRfY29zdCBvbWl0dGVkXG4gIGVudGl0eV9lbmVyZ3lfcHJpY2U6IHN0cmluZyB8IG51bGw7XG4gIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bWJlciB8IG51bGw7XG4gIHVuaXRfb2ZfbWVhc3VyZW1lbnQ/OiBzdHJpbmcgfCBudWxsO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhdGVyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2Uge1xuICB0eXBlOiBcIndhdGVyXCI7XG5cbiAgLy8gdm9sdW1lIG1ldGVyXG4gIHN0YXRfZW5lcmd5X2Zyb206IHN0cmluZztcblxuICAvLyAkIG1ldGVyXG4gIHN0YXRfY29zdDogc3RyaW5nIHwgbnVsbDtcblxuICAvLyBDYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSBjb3N0cyBpZiBzdGF0X2Nvc3Qgb21pdHRlZFxuICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBzdHJpbmcgfCBudWxsO1xuICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudW1iZXIgfCBudWxsO1xuICB1bml0X29mX21lYXN1cmVtZW50Pzogc3RyaW5nIHwgbnVsbDtcbn1cblxudHlwZSBFbmVyZ3lTb3VyY2UgPVxuICB8IFNvbGFyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VcbiAgfCBHcmlkU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VcbiAgfCBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VcbiAgfCBHYXNTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVxuICB8IFdhdGVyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2U7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5UHJlZmVyZW5jZXMge1xuICBlbmVyZ3lfc291cmNlczogRW5lcmd5U291cmNlW107XG4gIGRldmljZV9jb25zdW1wdGlvbjogRGV2aWNlQ29uc3VtcHRpb25FbmVyZ3lQcmVmZXJlbmNlW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5SW5mbyB7XG4gIGNvc3Rfc2Vuc29yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgc29sYXJfZm9yZWNhc3RfZG9tYWluczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5VmFsaWRhdGlvbklzc3VlIHtcbiAgdHlwZTogc3RyaW5nO1xuICBhZmZlY3RlZF9lbnRpdGllczogW3N0cmluZywgdW5rbm93bl1bXTtcbiAgdHJhbnNsYXRpb25fcGxhY2Vob2xkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVuZXJneVByZWZlcmVuY2VzVmFsaWRhdGlvbiB7XG4gIGVuZXJneV9zb3VyY2VzOiBFbmVyZ3lWYWxpZGF0aW9uSXNzdWVbXVtdO1xuICBkZXZpY2VfY29uc3VtcHRpb246IEVuZXJneVZhbGlkYXRpb25Jc3N1ZVtdW107XG59XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lJbmZvID0gKGhhc3M6IEhvbWVBc3Npc3RhbnQpID0+XG4gIGhhc3MuY2FsbFdTPEVuZXJneUluZm8+KHtcbiAgICB0eXBlOiBcImVuZXJneS9pbmZvXCIsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZ2V0RW5lcmd5UHJlZmVyZW5jZVZhbGlkYXRpb24gPSBhc3luYyAoaGFzczogSG9tZUFzc2lzdGFudCkgPT4ge1xuICBhd2FpdCBoYXNzLmxvYWRCYWNrZW5kVHJhbnNsYXRpb24oXCJpc3N1ZXNcIiwgXCJlbmVyZ3lcIik7XG4gIHJldHVybiBoYXNzLmNhbGxXUzxFbmVyZ3lQcmVmZXJlbmNlc1ZhbGlkYXRpb24+KHtcbiAgICB0eXBlOiBcImVuZXJneS92YWxpZGF0ZVwiLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lQcmVmZXJlbmNlcyA9IChoYXNzOiBIb21lQXNzaXN0YW50KSA9PlxuICBoYXNzLmNhbGxXUzxFbmVyZ3lQcmVmZXJlbmNlcz4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L2dldF9wcmVmc1wiLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IHNhdmVFbmVyZ3lQcmVmZXJlbmNlcyA9IGFzeW5jIChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgcHJlZnM6IFBhcnRpYWw8RW5lcmd5UHJlZmVyZW5jZXM+XG4pID0+IHtcbiAgY29uc3QgbmV3UHJlZnMgPSBoYXNzLmNhbGxXUzxFbmVyZ3lQcmVmZXJlbmNlcz4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L3NhdmVfcHJlZnNcIixcbiAgICAuLi5wcmVmcyxcbiAgfSk7XG4gIGNsZWFyRW5lcmd5Q29sbGVjdGlvblByZWZlcmVuY2VzKGhhc3MpO1xuICByZXR1cm4gbmV3UHJlZnM7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uIHtcbiAgW2RhdGU6IHN0cmluZ106IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IGdldEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uID0gYXN5bmMgKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBzdGFydFRpbWU6IERhdGUsXG4gIGVuZXJneV9zdGF0aXN0aWNfaWRzOiBzdHJpbmdbXSxcbiAgY28yX3N0YXRpc3RpY19pZDogc3RyaW5nLFxuICBlbmRUaW1lPzogRGF0ZSxcbiAgcGVyaW9kOiBcIjVtaW51dGVcIiB8IFwiaG91clwiIHwgXCJkYXlcIiB8IFwibW9udGhcIiA9IFwiaG91clwiXG4pID0+XG4gIGhhc3MuY2FsbFdTPEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uPih7XG4gICAgdHlwZTogXCJlbmVyZ3kvZm9zc2lsX2VuZXJneV9jb25zdW1wdGlvblwiLFxuICAgIHN0YXJ0X3RpbWU6IHN0YXJ0VGltZS50b0lTT1N0cmluZygpLFxuICAgIGVuZF90aW1lOiBlbmRUaW1lPy50b0lTT1N0cmluZygpLFxuICAgIGVuZXJneV9zdGF0aXN0aWNfaWRzLFxuICAgIGNvMl9zdGF0aXN0aWNfaWQsXG4gICAgcGVyaW9kLFxuICB9KTtcblxuaW50ZXJmYWNlIEVuZXJneVNvdXJjZUJ5VHlwZSB7XG4gIGdyaWQ/OiBHcmlkU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgc29sYXI/OiBTb2xhclNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlW107XG4gIGJhdHRlcnk/OiBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgZ2FzPzogR2FzU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgd2F0ZXI/OiBXYXRlclNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlW107XG59XG5cbmV4cG9ydCBjb25zdCBlbmVyZ3lTb3VyY2VzQnlUeXBlID0gKHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlcykgPT5cbiAgZ3JvdXBCeShwcmVmcy5lbmVyZ3lfc291cmNlcywgKGl0ZW0pID0+IGl0ZW0udHlwZSkgYXMgRW5lcmd5U291cmNlQnlUeXBlO1xuXG5leHBvcnQgaW50ZXJmYWNlIEVuZXJneURhdGEge1xuICBzdGFydDogRGF0ZTtcbiAgZW5kPzogRGF0ZTtcbiAgc3RhcnRDb21wYXJlPzogRGF0ZTtcbiAgZW5kQ29tcGFyZT86IERhdGU7XG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlcztcbiAgaW5mbzogRW5lcmd5SW5mbztcbiAgc3RhdHM6IFN0YXRpc3RpY3M7XG4gIHN0YXRzTWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIFN0YXRpc3RpY3NNZXRhRGF0YT47XG4gIHN0YXRzQ29tcGFyZTogU3RhdGlzdGljcztcbiAgY28yU2lnbmFsQ29uZmlnRW50cnk/OiBDb25maWdFbnRyeTtcbiAgY28yU2lnbmFsRW50aXR5Pzogc3RyaW5nO1xuICBmb3NzaWxFbmVyZ3lDb25zdW1wdGlvbj86IEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uO1xuICBmb3NzaWxFbmVyZ3lDb25zdW1wdGlvbkNvbXBhcmU/OiBGb3NzaWxFbmVyZ3lDb25zdW1wdGlvbjtcbn1cblxuZXhwb3J0IGNvbnN0IGdldFJlZmVyZW5jZWRTdGF0aXN0aWNJZHMgPSAoXG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlcyxcbiAgaW5mbzogRW5lcmd5SW5mbyxcbiAgaW5jbHVkZVR5cGVzPzogc3RyaW5nW11cbik6IHN0cmluZ1tdID0+IHtcbiAgY29uc3Qgc3RhdElEczogc3RyaW5nW10gPSBbXTtcblxuICBmb3IgKGNvbnN0IHNvdXJjZSBvZiBwcmVmcy5lbmVyZ3lfc291cmNlcykge1xuICAgIGlmIChpbmNsdWRlVHlwZXMgJiYgIWluY2x1ZGVUeXBlcy5pbmNsdWRlcyhzb3VyY2UudHlwZSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChzb3VyY2UudHlwZSA9PT0gXCJzb2xhclwiKSB7XG4gICAgICBzdGF0SURzLnB1c2goc291cmNlLnN0YXRfZW5lcmd5X2Zyb20pO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKHNvdXJjZS50eXBlID09PSBcImdhc1wiIHx8IHNvdXJjZS50eXBlID09PSBcIndhdGVyXCIpIHtcbiAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSk7XG5cbiAgICAgIGlmIChzb3VyY2Uuc3RhdF9jb3N0KSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9jb3N0KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvc3RTdGF0SWQgPSBpbmZvLmNvc3Rfc2Vuc29yc1tzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbV07XG4gICAgICBpZiAoY29zdFN0YXRJZCkge1xuICAgICAgICBzdGF0SURzLnB1c2goY29zdFN0YXRJZCk7XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiYmF0dGVyeVwiKSB7XG4gICAgICBzdGF0SURzLnB1c2goc291cmNlLnN0YXRfZW5lcmd5X2Zyb20pO1xuICAgICAgc3RhdElEcy5wdXNoKHNvdXJjZS5zdGF0X2VuZXJneV90byk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBncmlkIHNvdXJjZVxuICAgIGZvciAoY29uc3QgZmxvd0Zyb20gb2Ygc291cmNlLmZsb3dfZnJvbSkge1xuICAgICAgc3RhdElEcy5wdXNoKGZsb3dGcm9tLnN0YXRfZW5lcmd5X2Zyb20pO1xuICAgICAgaWYgKGZsb3dGcm9tLnN0YXRfY29zdCkge1xuICAgICAgICBzdGF0SURzLnB1c2goZmxvd0Zyb20uc3RhdF9jb3N0KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvc3RTdGF0SWQgPSBpbmZvLmNvc3Rfc2Vuc29yc1tmbG93RnJvbS5zdGF0X2VuZXJneV9mcm9tXTtcbiAgICAgIGlmIChjb3N0U3RhdElkKSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChjb3N0U3RhdElkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yIChjb25zdCBmbG93VG8gb2Ygc291cmNlLmZsb3dfdG8pIHtcbiAgICAgIHN0YXRJRHMucHVzaChmbG93VG8uc3RhdF9lbmVyZ3lfdG8pO1xuICAgICAgaWYgKGZsb3dUby5zdGF0X2NvbXBlbnNhdGlvbikge1xuICAgICAgICBzdGF0SURzLnB1c2goZmxvd1RvLnN0YXRfY29tcGVuc2F0aW9uKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvc3RTdGF0SWQgPSBpbmZvLmNvc3Rfc2Vuc29yc1tmbG93VG8uc3RhdF9lbmVyZ3lfdG9dO1xuICAgICAgaWYgKGNvc3RTdGF0SWQpIHtcbiAgICAgICAgc3RhdElEcy5wdXNoKGNvc3RTdGF0SWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBzdGF0SURzO1xufTtcblxuY29uc3QgZ2V0RW5lcmd5RGF0YSA9IGFzeW5jIChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgcHJlZnM6IEVuZXJneVByZWZlcmVuY2VzLFxuICBzdGFydDogRGF0ZSxcbiAgZW5kPzogRGF0ZSxcbiAgY29tcGFyZT86IGJvb2xlYW5cbik6IFByb21pc2U8RW5lcmd5RGF0YT4gPT4ge1xuICBjb25zdCBbY29uZmlnRW50cmllcywgaW5mb10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgZ2V0Q29uZmlnRW50cmllcyhoYXNzLCB7IGRvbWFpbjogXCJjbzJzaWduYWxcIiB9KSxcbiAgICBnZXRFbmVyZ3lJbmZvKGhhc3MpLFxuICBdKTtcblxuICBjb25zdCBjbzJTaWduYWxDb25maWdFbnRyeSA9IGNvbmZpZ0VudHJpZXMubGVuZ3RoXG4gICAgPyBjb25maWdFbnRyaWVzWzBdXG4gICAgOiB1bmRlZmluZWQ7XG5cbiAgbGV0IGNvMlNpZ25hbEVudGl0eTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBpZiAoY28yU2lnbmFsQ29uZmlnRW50cnkpIHtcbiAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiBPYmplY3QudmFsdWVzKGhhc3MuZW50aXRpZXMpKSB7XG4gICAgICBpZiAoZW50aXR5LnBsYXRmb3JtICE9PSBcImNvMnNpZ25hbFwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgaW50ZWdyYXRpb24gb2ZmZXJzIDIgZW50aXRpZXMuIFdlIHdhbnQgdGhlICUgb25lLlxuICAgICAgY29uc3QgY28yU3RhdGUgPSBoYXNzLnN0YXRlc1tlbnRpdHkuZW50aXR5X2lkXTtcbiAgICAgIGlmICghY28yU3RhdGUgfHwgY28yU3RhdGUuYXR0cmlidXRlcy51bml0X29mX21lYXN1cmVtZW50ICE9PSBcIiVcIikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgY28yU2lnbmFsRW50aXR5ID0gY28yU3RhdGUuZW50aXR5X2lkO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgY29uc3VtcHRpb25TdGF0SURzOiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGNvbnN0IHNvdXJjZSBvZiBwcmVmcy5lbmVyZ3lfc291cmNlcykge1xuICAgIC8vIGdyaWQgc291cmNlXG4gICAgaWYgKHNvdXJjZS50eXBlID09PSBcImdyaWRcIikge1xuICAgICAgZm9yIChjb25zdCBmbG93RnJvbSBvZiBzb3VyY2UuZmxvd19mcm9tKSB7XG4gICAgICAgIGNvbnN1bXB0aW9uU3RhdElEcy5wdXNoKGZsb3dGcm9tLnN0YXRfZW5lcmd5X2Zyb20pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBjb25zdCBlbmVyZ3lTdGF0SWRzID0gZ2V0UmVmZXJlbmNlZFN0YXRpc3RpY0lkcyhwcmVmcywgaW5mbywgW1xuICAgIFwiZ3JpZFwiLFxuICAgIFwic29sYXJcIixcbiAgICBcImJhdHRlcnlcIixcbiAgICBcImdhc1wiLFxuICBdKTtcbiAgY29uc3Qgd2F0ZXJTdGF0SWRzID0gZ2V0UmVmZXJlbmNlZFN0YXRpc3RpY0lkcyhwcmVmcywgaW5mbywgW1wid2F0ZXJcIl0pO1xuXG4gIGNvbnN0IGFsbFN0YXRJRHMgPSBbLi4uZW5lcmd5U3RhdElkcywgLi4ud2F0ZXJTdGF0SWRzXTtcblxuICBjb25zdCBkYXlEaWZmZXJlbmNlID0gZGlmZmVyZW5jZUluRGF5cyhlbmQgfHwgbmV3IERhdGUoKSwgc3RhcnQpO1xuICBjb25zdCBwZXJpb2QgPVxuICAgIGRheURpZmZlcmVuY2UgPiAzNSA/IFwibW9udGhcIiA6IGRheURpZmZlcmVuY2UgPiAyID8gXCJkYXlcIiA6IFwiaG91clwiO1xuXG4gIGNvbnN0IGxlbmd0aFVuaXQgPSBoYXNzLmNvbmZpZy51bml0X3N5c3RlbS5sZW5ndGggfHwgXCJcIjtcbiAgY29uc3QgZW5lcmd5VW5pdHM6IFN0YXRpc3RpY3NVbml0Q29uZmlndXJhdGlvbiA9IHtcbiAgICBlbmVyZ3k6IFwia1doXCIsXG4gICAgdm9sdW1lOiBsZW5ndGhVbml0ID09PSBcImttXCIgPyBcIm3Cs1wiIDogXCJmdMKzXCIsXG4gIH07XG4gIGNvbnN0IHdhdGVyVW5pdHM6IFN0YXRpc3RpY3NVbml0Q29uZmlndXJhdGlvbiA9IHtcbiAgICB2b2x1bWU6IGxlbmd0aFVuaXQgPT09IFwia21cIiA/IFwiTFwiIDogXCJnYWxcIixcbiAgfTtcblxuICBjb25zdCBfZW5lcmd5U3RhdHM6IFN0YXRpc3RpY3MgfCBQcm9taXNlPFN0YXRpc3RpY3M+ID0gZW5lcmd5U3RhdElkcy5sZW5ndGhcbiAgICA/IGZldGNoU3RhdGlzdGljcyhoYXNzISwgc3RhcnQsIGVuZCwgZW5lcmd5U3RhdElkcywgcGVyaW9kLCBlbmVyZ3lVbml0cywgW1xuICAgICAgICBcImNoYW5nZVwiLFxuICAgICAgXSlcbiAgICA6IHt9O1xuICBjb25zdCBfd2F0ZXJTdGF0czogU3RhdGlzdGljcyB8IFByb21pc2U8U3RhdGlzdGljcz4gPSB3YXRlclN0YXRJZHMubGVuZ3RoXG4gICAgPyBmZXRjaFN0YXRpc3RpY3MoaGFzcyEsIHN0YXJ0LCBlbmQsIHdhdGVyU3RhdElkcywgcGVyaW9kLCB3YXRlclVuaXRzLCBbXG4gICAgICAgIFwiY2hhbmdlXCIsXG4gICAgICBdKVxuICAgIDoge307XG5cbiAgbGV0IHN0YXRzQ29tcGFyZTtcbiAgbGV0IHN0YXJ0Q29tcGFyZTtcbiAgbGV0IGVuZENvbXBhcmU7XG4gIGxldCBfZW5lcmd5U3RhdHNDb21wYXJlOiBTdGF0aXN0aWNzIHwgUHJvbWlzZTxTdGF0aXN0aWNzPiA9IHt9O1xuICBsZXQgX3dhdGVyU3RhdHNDb21wYXJlOiBTdGF0aXN0aWNzIHwgUHJvbWlzZTxTdGF0aXN0aWNzPiA9IHt9O1xuXG4gIGlmIChjb21wYXJlKSB7XG4gICAgaWYgKFxuICAgICAgKGNhbGNEYXRlUHJvcGVydHkoXG4gICAgICAgIHN0YXJ0LFxuICAgICAgICBpc0ZpcnN0RGF5T2ZNb250aCxcbiAgICAgICAgaGFzcy5sb2NhbGUsXG4gICAgICAgIGhhc3MuY29uZmlnXG4gICAgICApIGFzIGJvb2xlYW4pICYmXG4gICAgICAoY2FsY0RhdGVQcm9wZXJ0eShcbiAgICAgICAgZW5kIHx8IG5ldyBEYXRlKCksXG4gICAgICAgIGlzTGFzdERheU9mTW9udGgsXG4gICAgICAgIGhhc3MubG9jYWxlLFxuICAgICAgICBoYXNzLmNvbmZpZ1xuICAgICAgKSBhcyBib29sZWFuKVxuICAgICkge1xuICAgICAgLy8gV2hlbiBjb21wYXJpbmcgYSBtb250aCAob3IgbXVsdGlwbGUpLCB3ZSB3YW50IHRvIHN0YXJ0IGF0IHRoZSBiZWdpbmluZyBvZiB0aGUgbW9udGhcbiAgICAgIHN0YXJ0Q29tcGFyZSA9IGNhbGNEYXRlKFxuICAgICAgICBzdGFydCxcbiAgICAgICAgYWRkTW9udGhzLFxuICAgICAgICBoYXNzLmxvY2FsZSxcbiAgICAgICAgaGFzcy5jb25maWcsXG4gICAgICAgIC0oY2FsY0RhdGVQcm9wZXJ0eShcbiAgICAgICAgICBlbmQgfHwgbmV3IERhdGUoKSxcbiAgICAgICAgICBkaWZmZXJlbmNlSW5Nb250aHMsXG4gICAgICAgICAgaGFzcy5sb2NhbGUsXG4gICAgICAgICAgaGFzcy5jb25maWcsXG4gICAgICAgICAgc3RhcnRcbiAgICAgICAgKSBhcyBudW1iZXIpIC0gMVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhcnRDb21wYXJlID0gY2FsY0RhdGUoXG4gICAgICAgIHN0YXJ0LFxuICAgICAgICBhZGREYXlzLFxuICAgICAgICBoYXNzLmxvY2FsZSxcbiAgICAgICAgaGFzcy5jb25maWcsXG4gICAgICAgIChkYXlEaWZmZXJlbmNlICsgMSkgKiAtMVxuICAgICAgKTtcbiAgICB9XG4gICAgZW5kQ29tcGFyZSA9IGFkZE1pbGxpc2Vjb25kcyhzdGFydCwgLTEpO1xuICAgIGlmIChlbmVyZ3lTdGF0SWRzLmxlbmd0aCkge1xuICAgICAgX2VuZXJneVN0YXRzQ29tcGFyZSA9IGZldGNoU3RhdGlzdGljcyhcbiAgICAgICAgaGFzcyEsXG4gICAgICAgIHN0YXJ0Q29tcGFyZSxcbiAgICAgICAgZW5kQ29tcGFyZSxcbiAgICAgICAgZW5lcmd5U3RhdElkcyxcbiAgICAgICAgcGVyaW9kLFxuICAgICAgICBlbmVyZ3lVbml0cyxcbiAgICAgICAgW1wiY2hhbmdlXCJdXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAod2F0ZXJTdGF0SWRzLmxlbmd0aCkge1xuICAgICAgX3dhdGVyU3RhdHNDb21wYXJlID0gZmV0Y2hTdGF0aXN0aWNzKFxuICAgICAgICBoYXNzISxcbiAgICAgICAgc3RhcnRDb21wYXJlLFxuICAgICAgICBlbmRDb21wYXJlLFxuICAgICAgICB3YXRlclN0YXRJZHMsXG4gICAgICAgIHBlcmlvZCxcbiAgICAgICAgd2F0ZXJVbml0cyxcbiAgICAgICAgW1wiY2hhbmdlXCJdXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGxldCBfZm9zc2lsRW5lcmd5Q29uc3VtcHRpb246IHVuZGVmaW5lZCB8IFByb21pc2U8Rm9zc2lsRW5lcmd5Q29uc3VtcHRpb24+O1xuICBsZXQgX2Zvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZTpcbiAgICB8IHVuZGVmaW5lZFxuICAgIHwgUHJvbWlzZTxGb3NzaWxFbmVyZ3lDb25zdW1wdGlvbj47XG4gIGlmIChjbzJTaWduYWxFbnRpdHkgIT09IHVuZGVmaW5lZCkge1xuICAgIF9mb3NzaWxFbmVyZ3lDb25zdW1wdGlvbiA9IGdldEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uKFxuICAgICAgaGFzcyEsXG4gICAgICBzdGFydCxcbiAgICAgIGNvbnN1bXB0aW9uU3RhdElEcyxcbiAgICAgIGNvMlNpZ25hbEVudGl0eSxcbiAgICAgIGVuZCxcbiAgICAgIGRheURpZmZlcmVuY2UgPiAzNSA/IFwibW9udGhcIiA6IGRheURpZmZlcmVuY2UgPiAyID8gXCJkYXlcIiA6IFwiaG91clwiXG4gICAgKTtcbiAgICBpZiAoY29tcGFyZSkge1xuICAgICAgX2Zvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZSA9IGdldEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uKFxuICAgICAgICBoYXNzISxcbiAgICAgICAgc3RhcnRDb21wYXJlLFxuICAgICAgICBjb25zdW1wdGlvblN0YXRJRHMsXG4gICAgICAgIGNvMlNpZ25hbEVudGl0eSxcbiAgICAgICAgZW5kQ29tcGFyZSxcbiAgICAgICAgZGF5RGlmZmVyZW5jZSA+IDM1ID8gXCJtb250aFwiIDogZGF5RGlmZmVyZW5jZSA+IDIgPyBcImRheVwiIDogXCJob3VyXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc3RhdHNNZXRhZGF0YTogUmVjb3JkPHN0cmluZywgU3RhdGlzdGljc01ldGFEYXRhPiA9IHt9O1xuICBjb25zdCBfZ2V0U3RhdGlzdGljTWV0YWRhdGE6XG4gICAgfCBQcm9taXNlPFN0YXRpc3RpY3NNZXRhRGF0YVtdPlxuICAgIHwgU3RhdGlzdGljc01ldGFEYXRhW10gPSBhbGxTdGF0SURzLmxlbmd0aFxuICAgID8gZ2V0U3RhdGlzdGljTWV0YWRhdGEoaGFzcywgYWxsU3RhdElEcylcbiAgICA6IFtdO1xuICBjb25zdCBbXG4gICAgZW5lcmd5U3RhdHMsXG4gICAgd2F0ZXJTdGF0cyxcbiAgICBlbmVyZ3lTdGF0c0NvbXBhcmUsXG4gICAgd2F0ZXJTdGF0c0NvbXBhcmUsXG4gICAgc3RhdHNNZXRhZGF0YUFycmF5LFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uLFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZSxcbiAgXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBfZW5lcmd5U3RhdHMsXG4gICAgX3dhdGVyU3RhdHMsXG4gICAgX2VuZXJneVN0YXRzQ29tcGFyZSxcbiAgICBfd2F0ZXJTdGF0c0NvbXBhcmUsXG4gICAgX2dldFN0YXRpc3RpY01ldGFkYXRhLFxuICAgIF9mb3NzaWxFbmVyZ3lDb25zdW1wdGlvbixcbiAgICBfZm9zc2lsRW5lcmd5Q29uc3VtcHRpb25Db21wYXJlLFxuICBdKTtcbiAgY29uc3Qgc3RhdHMgPSB7IC4uLmVuZXJneVN0YXRzLCAuLi53YXRlclN0YXRzIH07XG4gIGlmIChjb21wYXJlKSB7XG4gICAgc3RhdHNDb21wYXJlID0geyAuLi5lbmVyZ3lTdGF0c0NvbXBhcmUsIC4uLndhdGVyU3RhdHNDb21wYXJlIH07XG4gIH1cbiAgaWYgKGFsbFN0YXRJRHMubGVuZ3RoKSB7XG4gICAgc3RhdHNNZXRhZGF0YUFycmF5LmZvckVhY2goKHgpID0+IHtcbiAgICAgIHN0YXRzTWV0YWRhdGFbeC5zdGF0aXN0aWNfaWRdID0geDtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGRhdGE6IEVuZXJneURhdGEgPSB7XG4gICAgc3RhcnQsXG4gICAgZW5kLFxuICAgIHN0YXJ0Q29tcGFyZSxcbiAgICBlbmRDb21wYXJlLFxuICAgIGluZm8sXG4gICAgcHJlZnMsXG4gICAgc3RhdHMsXG4gICAgc3RhdHNNZXRhZGF0YSxcbiAgICBzdGF0c0NvbXBhcmUsXG4gICAgY28yU2lnbmFsQ29uZmlnRW50cnksXG4gICAgY28yU2lnbmFsRW50aXR5LFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uLFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZSxcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5Q29sbGVjdGlvbiBleHRlbmRzIENvbGxlY3Rpb248RW5lcmd5RGF0YT4ge1xuICBzdGFydDogRGF0ZTtcbiAgZW5kPzogRGF0ZTtcbiAgY29tcGFyZT86IGJvb2xlYW47XG4gIHByZWZzPzogRW5lcmd5UHJlZmVyZW5jZXM7XG4gIGNsZWFyUHJlZnMoKTogdm9pZDtcbiAgc2V0UGVyaW9kKG5ld1N0YXJ0OiBEYXRlLCBuZXdFbmQ/OiBEYXRlKTogdm9pZDtcbiAgc2V0Q29tcGFyZShjb21wYXJlOiBib29sZWFuKTogdm9pZDtcbiAgX3JlZnJlc2hUaW1lb3V0PzogbnVtYmVyO1xuICBfdXBkYXRlUGVyaW9kVGltZW91dD86IG51bWJlcjtcbiAgX2FjdGl2ZTogbnVtYmVyO1xufVxuXG5jb25zdCBjbGVhckVuZXJneUNvbGxlY3Rpb25QcmVmZXJlbmNlcyA9IChoYXNzOiBIb21lQXNzaXN0YW50KSA9PiB7XG4gIGVuZXJneUNvbGxlY3Rpb25LZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGNvbnN0IGVuZXJneUNvbGxlY3Rpb24gPSBnZXRFbmVyZ3lEYXRhQ29sbGVjdGlvbihoYXNzLCB7IGtleSB9KTtcbiAgICBlbmVyZ3lDb2xsZWN0aW9uLmNsZWFyUHJlZnMoKTtcbiAgICBpZiAoZW5lcmd5Q29sbGVjdGlvbi5fYWN0aXZlKSB7XG4gICAgICBlbmVyZ3lDb2xsZWN0aW9uLnJlZnJlc2goKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3Qgc2NoZWR1bGVIb3VybHlSZWZyZXNoID0gKGNvbGxlY3Rpb246IEVuZXJneUNvbGxlY3Rpb24pID0+IHtcbiAgaWYgKGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0KSB7XG4gICAgY2xlYXJUaW1lb3V0KGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0KTtcbiAgfVxuXG4gIGlmIChjb2xsZWN0aW9uLl9hY3RpdmUgJiYgKCFjb2xsZWN0aW9uLmVuZCB8fCBjb2xsZWN0aW9uLmVuZCA+IG5ldyBEYXRlKCkpKSB7XG4gICAgLy8gVGhlIHN0YXRzIGFyZSBjcmVhdGVkIGV2ZXJ5IGhvdXJcbiAgICAvLyBTY2hlZHVsZSBhIHJlZnJlc2ggZm9yIDIwIG1pbnV0ZXMgcGFzdCB0aGUgaG91clxuICAgIC8vIElmIHRoZSBlbmQgaXMgbGFyZ2VyIHRoYW4gdGhlIGN1cnJlbnQgdGltZS5cbiAgICBjb25zdCBuZXh0RmV0Y2ggPSBuZXcgRGF0ZSgpO1xuICAgIGlmIChuZXh0RmV0Y2guZ2V0TWludXRlcygpID49IDIwKSB7XG4gICAgICBuZXh0RmV0Y2guc2V0SG91cnMobmV4dEZldGNoLmdldEhvdXJzKCkgKyAxKTtcbiAgICB9XG4gICAgbmV4dEZldGNoLnNldE1pbnV0ZXMoMjAsIDAsIDApO1xuXG4gICAgY29sbGVjdGlvbi5fcmVmcmVzaFRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChcbiAgICAgICgpID0+IGNvbGxlY3Rpb24ucmVmcmVzaCgpLFxuICAgICAgbmV4dEZldGNoLmdldFRpbWUoKSAtIERhdGUubm93KClcbiAgICApO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RW5lcmd5RGF0YUNvbGxlY3Rpb24gPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIG9wdGlvbnM6IHsgcHJlZnM/OiBFbmVyZ3lQcmVmZXJlbmNlczsga2V5Pzogc3RyaW5nIH0gPSB7fVxuKTogRW5lcmd5Q29sbGVjdGlvbiA9PiB7XG4gIGxldCBrZXkgPSBcIl9lbmVyZ3lcIjtcbiAgaWYgKG9wdGlvbnMua2V5KSB7XG4gICAgaWYgKCFvcHRpb25zLmtleS5zdGFydHNXaXRoKFwiZW5lcmd5X1wiKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiS2V5IG5lZWQgdG8gc3RhcnQgd2l0aCBlbmVyZ3lfXCIpO1xuICAgIH1cbiAgICBrZXkgPSBgXyR7b3B0aW9ucy5rZXl9YDtcbiAgfVxuXG4gIGlmICgoaGFzcy5jb25uZWN0aW9uIGFzIGFueSlba2V5XSkge1xuICAgIHJldHVybiAoaGFzcy5jb25uZWN0aW9uIGFzIGFueSlba2V5XTtcbiAgfVxuXG4gIGVuZXJneUNvbGxlY3Rpb25LZXlzLnB1c2gob3B0aW9ucy5rZXkpO1xuXG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBnZXRDb2xsZWN0aW9uPEVuZXJneURhdGE+KFxuICAgIGhhc3MuY29ubmVjdGlvbixcbiAgICBrZXksXG4gICAgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFjb2xsZWN0aW9uLnByZWZzKSB7XG4gICAgICAgIC8vIFRoaXMgd2lsbCByYWlzZSBpZiBub3QgZm91bmQuXG4gICAgICAgIC8vIERldGVjdCBieSBjaGVja2luZyBgZS5jb2RlID09PSBcIm5vdF9mb3VuZFwiXG4gICAgICAgIGNvbGxlY3Rpb24ucHJlZnMgPSBhd2FpdCBnZXRFbmVyZ3lQcmVmZXJlbmNlcyhoYXNzKTtcbiAgICAgIH1cblxuICAgICAgc2NoZWR1bGVIb3VybHlSZWZyZXNoKGNvbGxlY3Rpb24pO1xuXG4gICAgICByZXR1cm4gZ2V0RW5lcmd5RGF0YShcbiAgICAgICAgaGFzcyxcbiAgICAgICAgY29sbGVjdGlvbi5wcmVmcyxcbiAgICAgICAgY29sbGVjdGlvbi5zdGFydCxcbiAgICAgICAgY29sbGVjdGlvbi5lbmQsXG4gICAgICAgIGNvbGxlY3Rpb24uY29tcGFyZVxuICAgICAgKTtcbiAgICB9XG4gICkgYXMgRW5lcmd5Q29sbGVjdGlvbjtcblxuICBjb25zdCBvcmlnU3Vic2NyaWJlID0gY29sbGVjdGlvbi5zdWJzY3JpYmU7XG5cbiAgY29sbGVjdGlvbi5zdWJzY3JpYmUgPSAoc3Vic2NyaWJlcjogKGRhdGE6IEVuZXJneURhdGEpID0+IHZvaWQpID0+IHtcbiAgICBjb25zdCB1bnN1YiA9IG9yaWdTdWJzY3JpYmUoc3Vic2NyaWJlcik7XG4gICAgY29sbGVjdGlvbi5fYWN0aXZlKys7XG5cbiAgICBpZiAoY29sbGVjdGlvbi5fcmVmcmVzaFRpbWVvdXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgc2NoZWR1bGVIb3VybHlSZWZyZXNoKGNvbGxlY3Rpb24pO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjb2xsZWN0aW9uLl9hY3RpdmUtLTtcbiAgICAgIGlmIChjb2xsZWN0aW9uLl9hY3RpdmUgPCAxKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChjb2xsZWN0aW9uLl9yZWZyZXNoVGltZW91dCk7XG4gICAgICAgIGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdW5zdWIoKTtcbiAgICB9O1xuICB9O1xuXG4gIGNvbGxlY3Rpb24uX2FjdGl2ZSA9IDA7XG4gIGNvbGxlY3Rpb24ucHJlZnMgPSBvcHRpb25zLnByZWZzO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBob3VyID0gZm9ybWF0VGltZTI0aChub3csIGhhc3MubG9jYWxlLCBoYXNzLmNvbmZpZykuc3BsaXQoXCI6XCIpWzBdO1xuICAvLyBTZXQgc3RhcnQgdG8gc3RhcnQgb2YgdG9kYXkgaWYgd2UgaGF2ZSBkYXRhIGZvciB0b2RheSwgb3RoZXJ3aXNlIHllc3RlcmRheVxuICBjb2xsZWN0aW9uLnN0YXJ0ID0gY2FsY0RhdGUoXG4gICAgaG91ciA9PT0gXCIwXCIgPyBhZGREYXlzKG5vdywgLTEpIDogbm93LFxuICAgIHN0YXJ0T2ZEYXksXG4gICAgaGFzcy5sb2NhbGUsXG4gICAgaGFzcy5jb25maWdcbiAgKTtcbiAgY29sbGVjdGlvbi5lbmQgPSBjYWxjRGF0ZShcbiAgICBob3VyID09PSBcIjBcIiA/IGFkZERheXMobm93LCAtMSkgOiBub3csXG4gICAgZW5kT2ZEYXksXG4gICAgaGFzcy5sb2NhbGUsXG4gICAgaGFzcy5jb25maWdcbiAgKTtcblxuICBjb25zdCBzY2hlZHVsZVVwZGF0ZVBlcmlvZCA9ICgpID0+IHtcbiAgICBjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbGxlY3Rpb24uc3RhcnQgPSBjYWxjRGF0ZShcbiAgICAgICAgICBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHN0YXJ0T2ZEYXksXG4gICAgICAgICAgaGFzcy5sb2NhbGUsXG4gICAgICAgICAgaGFzcy5jb25maWdcbiAgICAgICAgKTtcbiAgICAgICAgY29sbGVjdGlvbi5lbmQgPSBjYWxjRGF0ZShcbiAgICAgICAgICBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGVuZE9mRGF5LFxuICAgICAgICAgIGhhc3MubG9jYWxlLFxuICAgICAgICAgIGhhc3MuY29uZmlnXG4gICAgICAgICk7XG4gICAgICAgIHNjaGVkdWxlVXBkYXRlUGVyaW9kKCk7XG4gICAgICB9LFxuICAgICAgYWRkSG91cnMoY2FsY0RhdGUobm93LCBlbmRPZkRheSwgaGFzcy5sb2NhbGUsIGhhc3MuY29uZmlnKSwgMSkuZ2V0VGltZSgpIC1cbiAgICAgICAgRGF0ZS5ub3coKSAvLyBTd2l0Y2ggdG8gbmV4dCBkYXkgYW4gaG91ciBhZnRlciB0aGUgZGF5IGNoYW5nZWRcbiAgICApO1xuICB9O1xuICBzY2hlZHVsZVVwZGF0ZVBlcmlvZCgpO1xuXG4gIGNvbGxlY3Rpb24uY2xlYXJQcmVmcyA9ICgpID0+IHtcbiAgICBjb2xsZWN0aW9uLnByZWZzID0gdW5kZWZpbmVkO1xuICB9O1xuICBjb2xsZWN0aW9uLnNldFBlcmlvZCA9IChuZXdTdGFydDogRGF0ZSwgbmV3RW5kPzogRGF0ZSkgPT4ge1xuICAgIGNvbGxlY3Rpb24uc3RhcnQgPSBuZXdTdGFydDtcbiAgICBjb2xsZWN0aW9uLmVuZCA9IG5ld0VuZDtcbiAgICBpZiAoXG4gICAgICBjb2xsZWN0aW9uLnN0YXJ0LmdldFRpbWUoKSA9PT1cbiAgICAgICAgY2FsY0RhdGUobmV3IERhdGUoKSwgc3RhcnRPZkRheSwgaGFzcy5sb2NhbGUsIGhhc3MuY29uZmlnKS5nZXRUaW1lKCkgJiZcbiAgICAgIGNvbGxlY3Rpb24uZW5kPy5nZXRUaW1lKCkgPT09XG4gICAgICAgIGNhbGNEYXRlKG5ldyBEYXRlKCksIGVuZE9mRGF5LCBoYXNzLmxvY2FsZSwgaGFzcy5jb25maWcpLmdldFRpbWUoKSAmJlxuICAgICAgIWNvbGxlY3Rpb24uX3VwZGF0ZVBlcmlvZFRpbWVvdXRcbiAgICApIHtcbiAgICAgIHNjaGVkdWxlVXBkYXRlUGVyaW9kKCk7XG4gICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQoY29sbGVjdGlvbi5fdXBkYXRlUGVyaW9kVGltZW91dCk7XG4gICAgICBjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfTtcbiAgY29sbGVjdGlvbi5zZXRDb21wYXJlID0gKGNvbXBhcmU6IGJvb2xlYW4pID0+IHtcbiAgICBjb2xsZWN0aW9uLmNvbXBhcmUgPSBjb21wYXJlO1xuICB9O1xuICByZXR1cm4gY29sbGVjdGlvbjtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lTb2xhckZvcmVjYXN0cyA9IChoYXNzOiBIb21lQXNzaXN0YW50KSA9PlxuICBoYXNzLmNhbGxXUzxFbmVyZ3lTb2xhckZvcmVjYXN0cz4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L3NvbGFyX2ZvcmVjYXN0XCIsXG4gIH0pO1xuXG5jb25zdCBlbmVyZ3lHYXNVbml0Q2xhc3MgPSBbXCJ2b2x1bWVcIiwgXCJlbmVyZ3lcIl0gYXMgY29uc3Q7XG5leHBvcnQgdHlwZSBFbmVyZ3lHYXNVbml0Q2xhc3MgPSAodHlwZW9mIGVuZXJneUdhc1VuaXRDbGFzcylbbnVtYmVyXTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneUdhc1VuaXRDbGFzcyA9IChcbiAgcHJlZnM6IEVuZXJneVByZWZlcmVuY2VzLFxuICBzdGF0aXN0aWNzTWV0YURhdGE6IFJlY29yZDxzdHJpbmcsIFN0YXRpc3RpY3NNZXRhRGF0YT4gPSB7fSxcbiAgZXhjbHVkZVNvdXJjZT86IHN0cmluZ1xuKTogRW5lcmd5R2FzVW5pdENsYXNzIHwgdW5kZWZpbmVkID0+IHtcbiAgZm9yIChjb25zdCBzb3VyY2Ugb2YgcHJlZnMuZW5lcmd5X3NvdXJjZXMpIHtcbiAgICBpZiAoc291cmNlLnR5cGUgIT09IFwiZ2FzXCIpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZXhjbHVkZVNvdXJjZSAmJiBleGNsdWRlU291cmNlID09PSBzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHN0YXRpc3RpY0lkV2l0aE1ldGEgPSBzdGF0aXN0aWNzTWV0YURhdGFbc291cmNlLnN0YXRfZW5lcmd5X2Zyb21dO1xuICAgIGlmIChcbiAgICAgIGVuZXJneUdhc1VuaXRDbGFzcy5pbmNsdWRlcyhcbiAgICAgICAgc3RhdGlzdGljSWRXaXRoTWV0YT8udW5pdF9jbGFzcyBhcyBFbmVyZ3lHYXNVbml0Q2xhc3NcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybiBzdGF0aXN0aWNJZFdpdGhNZXRhLnVuaXRfY2xhc3MgYXMgRW5lcmd5R2FzVW5pdENsYXNzO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneUdhc1VuaXQgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlcyxcbiAgc3RhdGlzdGljc01ldGFEYXRhOiBSZWNvcmQ8c3RyaW5nLCBTdGF0aXN0aWNzTWV0YURhdGE+ID0ge31cbik6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gIGNvbnN0IHVuaXRDbGFzcyA9IGdldEVuZXJneUdhc1VuaXRDbGFzcyhwcmVmcywgc3RhdGlzdGljc01ldGFEYXRhKTtcbiAgaWYgKHVuaXRDbGFzcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gdW5pdENsYXNzID09PSBcImVuZXJneVwiXG4gICAgPyBcImtXaFwiXG4gICAgOiBoYXNzLmNvbmZpZy51bml0X3N5c3RlbS5sZW5ndGggPT09IFwia21cIlxuICAgICAgPyBcIm3Cs1wiXG4gICAgICA6IFwiZnTCs1wiO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneVdhdGVyVW5pdCA9IChoYXNzOiBIb21lQXNzaXN0YW50KTogc3RyaW5nIHwgdW5kZWZpbmVkID0+XG4gIGhhc3MuY29uZmlnLnVuaXRfc3lzdGVtLmxlbmd0aCA9PT0gXCJrbVwiID8gXCJMXCIgOiBcImdhbFwiO1xuXG5leHBvcnQgY29uc3QgZW5lcmd5U3RhdGlzdGljSGVscFVybCA9XG4gIFwiL2RvY3MvZW5lcmd5L2ZhcS8jdHJvdWJsZXNob290aW5nLW1pc3NpbmctZW50aXRpZXNcIjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/data/energy.ts\n");

/***/ })

};
