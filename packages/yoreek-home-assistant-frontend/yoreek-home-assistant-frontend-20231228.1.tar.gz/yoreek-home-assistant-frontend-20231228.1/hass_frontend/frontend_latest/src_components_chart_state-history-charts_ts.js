/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
export const id = "src_components_chart_state-history-charts_ts";
export const ids = ["src_components_chart_state-history-charts_ts"];
export const modules = {

/***/ "./src/common/decorators/restore-scroll.ts":
/*!*************************************************!*\
  !*** ./src/common/decorators/restore-scroll.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   restoreScroll: () => (/* binding */ restoreScroll)\n/* harmony export */ });\n/* harmony import */ var _util_throttle__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/throttle */ \"./src/common/util/throttle.ts\");\n\nconst throttleReplaceState = (0,_util_throttle__WEBPACK_IMPORTED_MODULE_0__.throttle)(value => {\n  history.replaceState({\n    scrollPosition: value\n  }, \"\");\n}, 300);\nconst restoreScroll = selector => element => ({\n  kind: \"method\",\n  placement: \"prototype\",\n  key: element.key,\n  descriptor: {\n    set(value) {\n      throttleReplaceState(value);\n      this[`__${String(element.key)}`] = value;\n    },\n    get() {\n      var _history$state;\n      return this[`__${String(element.key)}`] || ((_history$state = history.state) === null || _history$state === void 0 ? void 0 : _history$state.scrollPosition);\n    },\n    enumerable: true,\n    configurable: true\n  },\n  finisher(cls) {\n    const connectedCallback = cls.prototype.connectedCallback;\n    cls.prototype.connectedCallback = function () {\n      connectedCallback.call(this);\n      const scrollPos = this[element.key];\n      if (scrollPos) {\n        this.updateComplete.then(() => {\n          const target = this.renderRoot.querySelector(selector);\n          if (!target) {\n            return;\n          }\n          setTimeout(() => {\n            target.scrollTop = scrollPos;\n          }, 0);\n        });\n      }\n    };\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL2RlY29yYXRvcnMvcmVzdG9yZS1zY3JvbGwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvY29tbW9uL2RlY29yYXRvcnMvcmVzdG9yZS1zY3JvbGwudHM/YjY3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IExpdEVsZW1lbnQgfSBmcm9tIFwibGl0XCI7XG5pbXBvcnQgdHlwZSB7IENsYXNzRWxlbWVudCB9IGZyb20gXCIuLi8uLi90eXBlc1wiO1xuaW1wb3J0IHsgdGhyb3R0bGUgfSBmcm9tIFwiLi4vdXRpbC90aHJvdHRsZVwiO1xuXG5jb25zdCB0aHJvdHRsZVJlcGxhY2VTdGF0ZSA9IHRocm90dGxlKCh2YWx1ZSkgPT4ge1xuICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7IHNjcm9sbFBvc2l0aW9uOiB2YWx1ZSB9LCBcIlwiKTtcbn0sIDMwMCk7XG5cbmV4cG9ydCBjb25zdCByZXN0b3JlU2Nyb2xsID1cbiAgKHNlbGVjdG9yOiBzdHJpbmcpOiBhbnkgPT5cbiAgKGVsZW1lbnQ6IENsYXNzRWxlbWVudCkgPT4gKHtcbiAgICBraW5kOiBcIm1ldGhvZFwiLFxuICAgIHBsYWNlbWVudDogXCJwcm90b3R5cGVcIixcbiAgICBrZXk6IGVsZW1lbnQua2V5LFxuICAgIGRlc2NyaXB0b3I6IHtcbiAgICAgIHNldCh0aGlzOiBMaXRFbGVtZW50LCB2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRocm90dGxlUmVwbGFjZVN0YXRlKHZhbHVlKTtcbiAgICAgICAgdGhpc1tgX18ke1N0cmluZyhlbGVtZW50LmtleSl9YF0gPSB2YWx1ZTtcbiAgICAgIH0sXG4gICAgICBnZXQodGhpczogTGl0RWxlbWVudCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIHRoaXNbYF9fJHtTdHJpbmcoZWxlbWVudC5rZXkpfWBdIHx8IGhpc3Rvcnkuc3RhdGU/LnNjcm9sbFBvc2l0aW9uXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICB9LFxuICAgIGZpbmlzaGVyKGNsczogdHlwZW9mIExpdEVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGNvbm5lY3RlZENhbGxiYWNrID0gY2xzLnByb3RvdHlwZS5jb25uZWN0ZWRDYWxsYmFjaztcbiAgICAgIGNscy5wcm90b3R5cGUuY29ubmVjdGVkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbm5lY3RlZENhbGxiYWNrLmNhbGwodGhpcyk7XG4gICAgICAgIGNvbnN0IHNjcm9sbFBvcyA9IHRoaXNbZWxlbWVudC5rZXldO1xuICAgICAgICBpZiAoc2Nyb2xsUG9zKSB7XG4gICAgICAgICAgdGhpcy51cGRhdGVDb21wbGV0ZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMucmVuZGVyUm9vdC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICB0YXJnZXQuc2Nyb2xsVG9wID0gc2Nyb2xsUG9zO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgfSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/common/decorators/restore-scroll.ts\n");

/***/ }),

/***/ "./src/components/chart/state-history-chart-line.ts":
/*!**********************************************************!*\
  !*** ./src/components/chart/state-history-chart-line.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateHistoryChartLine: () => (/* binding */ StateHistoryChartLine)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var _common_color_colors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/color/colors */ \"./src/common/color/colors.ts\");\n/* harmony import */ var _common_dom_fire_event__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/dom/fire_event */ \"./src/common/dom/fire_event.ts\");\n/* harmony import */ var _common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/util/compute_rtl */ \"./src/common/util/compute_rtl.ts\");\n/* harmony import */ var _common_number_format_number__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/number/format_number */ \"./src/common/number/format_number.ts\");\n/* harmony import */ var _ha_chart_base__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ha-chart-base */ \"./src/components/chart/ha-chart-base.ts\");\n\n\n\n\n\n\n\n\nconst safeParseFloat = value => {\n  const parsed = parseFloat(value);\n  return isFinite(parsed) ? parsed : null;\n};\nlet StateHistoryChartLine = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(null, function (_initialize, _LitElement) {\n  class StateHistoryChartLine extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: StateHistoryChartLine,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"data\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"names\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"unit\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"identifier\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"showNames\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"clickForMoreInfo\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"startTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"endTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"paddingYAxis\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"chartIndex\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"logarithmicScale\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_chartData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_entityIds\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      key: \"_datasetToDataIndex\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_chartOptions\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_yWidth\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_chartTime\",\n      value() {\n        return new Date();\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.query)(\"ha-chart-base\")],\n      key: \"_chart\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value() {\n        return options => {\n          var _this$_chart;\n          (_this$_chart = this._chart) === null || _this$_chart === void 0 || _this$_chart.resize(options);\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`\n      <ha-chart-base\n        .hass=${this.hass}\n        .data=${this._chartData}\n        .options=${this._chartOptions}\n        .paddingYAxis=${this.paddingYAxis - this._yWidth}\n        chart-type=\"line\"\n      ></ha-chart-base>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (!this.hasUpdated || changedProps.has(\"showNames\") || changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || changedProps.has(\"unit\") || changedProps.has(\"logarithmicScale\")) {\n          this._chartOptions = {\n            parsing: false,\n            animation: false,\n            interaction: {\n              mode: \"nearest\",\n              axis: \"xy\"\n            },\n            scales: {\n              x: {\n                type: \"time\",\n                adapters: {\n                  date: {\n                    locale: this.hass.locale,\n                    config: this.hass.config\n                  }\n                },\n                suggestedMin: this.startTime,\n                suggestedMax: this.endTime,\n                ticks: {\n                  maxRotation: 0,\n                  sampleSize: 5,\n                  autoSkipPadding: 20,\n                  major: {\n                    enabled: true\n                  },\n                  font: context => context.tick && context.tick.major ? {\n                    weight: \"bold\"\n                  } : {}\n                },\n                time: {\n                  tooltipFormat: \"datetimeseconds\"\n                }\n              },\n              y: {\n                ticks: {\n                  maxTicksLimit: 7\n                },\n                title: {\n                  display: true,\n                  text: this.unit\n                },\n                afterUpdate: y => {\n                  if (this._yWidth !== Math.floor(y.width)) {\n                    this._yWidth = Math.floor(y.width);\n                    (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_4__.fireEvent)(this, \"y-width-changed\", {\n                      value: this._yWidth,\n                      chartIndex: this.chartIndex\n                    });\n                  }\n                },\n                position: (0,_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_5__.computeRTL)(this.hass) ? \"right\" : \"left\",\n                type: this.logarithmicScale ? \"logarithmic\" : \"linear\"\n              }\n            },\n            plugins: {\n              tooltip: {\n                callbacks: {\n                  label: context => {\n                    let label = `${context.dataset.label}: ${(0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_6__.formatNumber)(context.parsed.y, this.hass.locale, (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_6__.getNumberFormatOptions)(undefined, this.hass.entities[this._entityIds[context.datasetIndex]]))} ${this.unit}`;\n                    const dataIndex = this._datasetToDataIndex[context.datasetIndex];\n                    const data = this.data[dataIndex];\n                    if (data.statistics && data.statistics.length > 0) {\n                      const source = data.states.length === 0 || context.parsed.x < data.states[0].last_changed ? `\\n${this.hass.localize(\"ui.components.history_charts.source_stats\")}` : `\\n${this.hass.localize(\"ui.components.history_charts.source_history\")}`;\n                      label += source;\n                    }\n                    return label;\n                  }\n                }\n              },\n              filler: {\n                propagate: true\n              },\n              legend: {\n                display: this.showNames,\n                labels: {\n                  usePointStyle: true\n                }\n              }\n            },\n            elements: {\n              line: {\n                tension: 0.1,\n                borderWidth: 1.5\n              },\n              point: {\n                hitRadius: 50\n              }\n            },\n            segment: {\n              borderColor: context => {\n                // render stat data with a slightly transparent line\n                const dataIndex = this._datasetToDataIndex[context.datasetIndex];\n                const data = this.data[dataIndex];\n                return data.statistics && data.statistics.length > 0 && (data.states.length === 0 || context.p0.parsed.x < data.states[0].last_changed) ? this._chartData.datasets[dataIndex].borderColor + \"7F\" : undefined;\n              }\n            },\n            // @ts-expect-error\n            locale: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_6__.numberFormatToLocale)(this.hass.locale),\n            onClick: e => {\n              if (!this.clickForMoreInfo) {\n                return;\n              }\n              const chart = e.chart;\n              const points = chart.getElementsAtEventForMode(e, \"nearest\", {\n                intersect: true\n              }, true);\n              if (points.length) {\n                const firstPoint = points[0];\n                (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_4__.fireEvent)(this, \"hass-more-info\", {\n                  entityId: this._entityIds[firstPoint.datasetIndex]\n                });\n                chart.canvas.dispatchEvent(new Event(\"mouseout\")); // to hide tooltip\n              }\n            }\n          };\n        }\n        if (changedProps.has(\"data\") || changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || this._chartTime < new Date(this.endTime.getTime() - _ha_chart_base__WEBPACK_IMPORTED_MODULE_7__.MIN_TIME_BETWEEN_UPDATES)) {\n          // If the line is more than 5 minutes old, re-gen it\n          // so the X axis grows even if there is no new data\n          this._generateData();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_generateData\",\n      value: function _generateData() {\n        let colorIndex = 0;\n        const computedStyles = getComputedStyle(this);\n        const entityStates = this.data;\n        const datasets = [];\n        const entityIds = [];\n        const datasetToDataIndex = [];\n        if (entityStates.length === 0) {\n          return;\n        }\n        this._chartTime = new Date();\n        const endTime = this.endTime;\n        const names = this.names || {};\n        entityStates.forEach((states, dataIdx) => {\n          const domain = states.domain;\n          const name = names[states.entity_id] || states.name;\n          // array containing [value1, value2, etc]\n          let prevValues = null;\n          const data = [];\n          const pushData = (timestamp, datavalues) => {\n            if (!datavalues) return;\n            if (timestamp > endTime) {\n              // Drop data points that are after the requested endTime. This could happen if\n              // endTime is \"now\" and client time is not in sync with server time.\n              return;\n            }\n            data.forEach((d, i) => {\n              if (datavalues[i] === null && prevValues && prevValues[i] !== null) {\n                // null data values show up as gaps in the chart.\n                // If the current value for the dataset is null and the previous\n                // value of the data set is not null, then add an 'end' point\n                // to the chart for the previous value. Otherwise the gap will\n                // be too big. It will go from the start of the previous data\n                // value until the start of the next data value.\n                d.data.push({\n                  x: timestamp.getTime(),\n                  y: prevValues[i]\n                });\n              }\n              d.data.push({\n                x: timestamp.getTime(),\n                y: datavalues[i]\n              });\n            });\n            prevValues = datavalues;\n          };\n          const addDataSet = (nameY, fill = false, color) => {\n            if (!color) {\n              color = (0,_common_color_colors__WEBPACK_IMPORTED_MODULE_3__.getGraphColorByIndex)(colorIndex, computedStyles);\n              colorIndex++;\n            }\n            data.push({\n              label: nameY,\n              fill: fill ? \"origin\" : false,\n              borderColor: color,\n              backgroundColor: color + \"7F\",\n              stepped: \"before\",\n              pointRadius: 0,\n              data: []\n            });\n            entityIds.push(states.entity_id);\n            datasetToDataIndex.push(dataIdx);\n          };\n          if (domain === \"thermostat\" || domain === \"climate\" || domain === \"water_heater\") {\n            const hasHvacAction = states.states.some(entityState => {\n              var _entityState$attribut;\n              return (_entityState$attribut = entityState.attributes) === null || _entityState$attribut === void 0 ? void 0 : _entityState$attribut.hvac_action;\n            });\n            const isHeating = domain === \"climate\" && hasHvacAction ? entityState => {\n              var _entityState$attribut2;\n              return ((_entityState$attribut2 = entityState.attributes) === null || _entityState$attribut2 === void 0 ? void 0 : _entityState$attribut2.hvac_action) === \"heating\";\n            } : entityState => entityState.state === \"heat\";\n            const isCooling = domain === \"climate\" && hasHvacAction ? entityState => {\n              var _entityState$attribut3;\n              return ((_entityState$attribut3 = entityState.attributes) === null || _entityState$attribut3 === void 0 ? void 0 : _entityState$attribut3.hvac_action) === \"cooling\";\n            } : entityState => entityState.state === \"cool\";\n            const hasHeat = states.states.some(isHeating);\n            const hasCool = states.states.some(isCooling);\n            // We differentiate between thermostats that have a target temperature\n            // range versus ones that have just a target temperature\n\n            // Using step chart by step-before so manually interpolation not needed.\n            const hasTargetRange = states.states.some(entityState => entityState.attributes && entityState.attributes.target_temp_high !== entityState.attributes.target_temp_low);\n            addDataSet(`${this.hass.localize(\"ui.card.climate.current_temperature\", {\n              name: name\n            })}`);\n            if (hasHeat) {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.heating\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-climate-heat-color\"));\n              // The \"heating\" series uses steppedArea to shade the area below the current\n              // temperature when the thermostat is calling for heat.\n            }\n            if (hasCool) {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.cooling\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-climate-cool-color\"));\n              // The \"cooling\" series uses steppedArea to shade the area below the current\n              // temperature when the thermostat is calling for heat.\n            }\n            if (hasTargetRange) {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.target_temperature_mode\", {\n                name: name,\n                mode: this.hass.localize(\"ui.card.climate.high\")\n              })}`);\n              addDataSet(`${this.hass.localize(\"ui.card.climate.target_temperature_mode\", {\n                name: name,\n                mode: this.hass.localize(\"ui.card.climate.low\")\n              })}`);\n            } else {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.target_temperature_entity\", {\n                name: name\n              })}`);\n            }\n            states.states.forEach(entityState => {\n              if (!entityState.attributes) return;\n              const curTemp = safeParseFloat(entityState.attributes.current_temperature);\n              const series = [curTemp];\n              if (hasHeat) {\n                series.push(isHeating(entityState) ? curTemp : null);\n              }\n              if (hasCool) {\n                series.push(isCooling(entityState) ? curTemp : null);\n              }\n              if (hasTargetRange) {\n                const targetHigh = safeParseFloat(entityState.attributes.target_temp_high);\n                const targetLow = safeParseFloat(entityState.attributes.target_temp_low);\n                series.push(targetHigh, targetLow);\n                pushData(new Date(entityState.last_changed), series);\n              } else {\n                const target = safeParseFloat(entityState.attributes.temperature);\n                series.push(target);\n                pushData(new Date(entityState.last_changed), series);\n              }\n            });\n          } else if (domain === \"humidifier\") {\n            const hasAction = states.states.some(entityState => {\n              var _entityState$attribut4;\n              return (_entityState$attribut4 = entityState.attributes) === null || _entityState$attribut4 === void 0 ? void 0 : _entityState$attribut4.action;\n            });\n            const hasCurrent = states.states.some(entityState => {\n              var _entityState$attribut5;\n              return (_entityState$attribut5 = entityState.attributes) === null || _entityState$attribut5 === void 0 ? void 0 : _entityState$attribut5.current_humidity;\n            });\n            const hasHumidifying = hasAction && states.states.some(entityState => {\n              var _entityState$attribut6;\n              return ((_entityState$attribut6 = entityState.attributes) === null || _entityState$attribut6 === void 0 ? void 0 : _entityState$attribut6.action) === \"humidifying\";\n            });\n            const hasDrying = hasAction && states.states.some(entityState => {\n              var _entityState$attribut7;\n              return ((_entityState$attribut7 = entityState.attributes) === null || _entityState$attribut7 === void 0 ? void 0 : _entityState$attribut7.action) === \"drying\";\n            });\n            addDataSet(`${this.hass.localize(\"ui.card.humidifier.target_humidity_entity\", {\n              name: name\n            })}`);\n            if (hasCurrent) {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.current_humidity_entity\", {\n                name: name\n              })}`);\n            }\n\n            // If action attribute is available, we used it to shade the area below the humidity.\n            // If action attribute is not available, we shade the area when the device is on\n            if (hasHumidifying) {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.humidifying\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-humidifier-on-color\"));\n            } else if (hasDrying) {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.drying\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-humidifier-on-color\"));\n            } else {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.on_entity\", {\n                name: name\n              })}`, true);\n            }\n            states.states.forEach(entityState => {\n              var _entityState$attribut8;\n              if (!entityState.attributes) return;\n              const target = safeParseFloat(entityState.attributes.humidity);\n              // If the current humidity is not available, then we fill up to the target humidity\n              const current = hasCurrent ? safeParseFloat((_entityState$attribut8 = entityState.attributes) === null || _entityState$attribut8 === void 0 ? void 0 : _entityState$attribut8.current_humidity) : target;\n              const series = [target];\n              if (hasCurrent) {\n                series.push(current);\n              }\n              if (hasHumidifying) {\n                var _entityState$attribut9;\n                series.push(((_entityState$attribut9 = entityState.attributes) === null || _entityState$attribut9 === void 0 ? void 0 : _entityState$attribut9.action) === \"humidifying\" ? current : null);\n              } else if (hasDrying) {\n                var _entityState$attribut10;\n                series.push(((_entityState$attribut10 = entityState.attributes) === null || _entityState$attribut10 === void 0 ? void 0 : _entityState$attribut10.action) === \"drying\" ? current : null);\n              } else {\n                series.push(entityState.state === \"on\" ? current : null);\n              }\n              pushData(new Date(entityState.last_changed), series);\n            });\n          } else {\n            addDataSet(name);\n            let lastValue;\n            let lastDate;\n            let lastNullDate = null;\n\n            // Process chart data.\n            // When state is `unknown`, calculate the value and break the line.\n            const processData = entityState => {\n              const value = safeParseFloat(entityState.state);\n              const date = new Date(entityState.last_changed);\n              if (value !== null && lastNullDate) {\n                var _lastDate;\n                const dateTime = date.getTime();\n                const lastNullDateTime = lastNullDate.getTime();\n                const lastDateTime = (_lastDate = lastDate) === null || _lastDate === void 0 ? void 0 : _lastDate.getTime();\n                const tmpValue = (value - lastValue) * ((lastNullDateTime - lastDateTime) / (dateTime - lastDateTime)) + lastValue;\n                pushData(lastNullDate, [tmpValue]);\n                pushData(new Date(lastNullDateTime + 1), [null]);\n                pushData(date, [value]);\n                lastDate = date;\n                lastValue = value;\n                lastNullDate = null;\n              } else if (value !== null && lastNullDate === null) {\n                pushData(date, [value]);\n                lastDate = date;\n                lastValue = value;\n              } else if (value === null && lastNullDate === null && lastValue !== undefined) {\n                lastNullDate = date;\n              }\n            };\n            if (states.statistics) {\n              const stopTime = !states.states || states.states.length === 0 ? 0 : states.states[0].last_changed;\n              for (let i = 0; i < states.statistics.length; i++) {\n                if (stopTime && states.statistics[i].last_changed >= stopTime) {\n                  break;\n                }\n                processData(states.statistics[i]);\n              }\n            }\n            states.states.forEach(entityState => {\n              processData(entityState);\n            });\n            if (lastNullDate !== null) {\n              pushData(lastNullDate, [null]);\n            }\n          }\n\n          // Add an entry for final values\n          pushData(endTime, prevValues);\n\n          // Concat two arrays\n          Array.prototype.push.apply(datasets, data);\n        });\n        this._chartData = {\n          datasets\n        };\n        this._entityIds = entityIds;\n        this._datasetToDataIndex = datasetToDataIndex;\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_1__.LitElement);\ncustomElements.define(\"state-history-chart-line\", StateHistoryChartLine);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUF1aUJBO0FBQUE7QUFBQTtBQXZpQkE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFFQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBR0E7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBTUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUdBO0FBQUE7QUFDQTtBQUVBO0FBR0E7QUFBQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUlBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2NvbXBvbmVudHMvY2hhcnQvc3RhdGUtaGlzdG9yeS1jaGFydC1saW5lLnRzPzNlMGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDaGFydERhdGEsIENoYXJ0RGF0YXNldCwgQ2hhcnRPcHRpb25zIH0gZnJvbSBcImNoYXJ0LmpzXCI7XG5pbXBvcnQgeyBodG1sLCBMaXRFbGVtZW50LCBQcm9wZXJ0eVZhbHVlcyB9IGZyb20gXCJsaXRcIjtcbmltcG9ydCB7IHByb3BlcnR5LCBxdWVyeSwgc3RhdGUgfSBmcm9tIFwibGl0L2RlY29yYXRvcnNcIjtcbmltcG9ydCB7IGdldEdyYXBoQ29sb3JCeUluZGV4IH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9jb2xvci9jb2xvcnNcIjtcbmltcG9ydCB7IGZpcmVFdmVudCB9IGZyb20gXCIuLi8uLi9jb21tb24vZG9tL2ZpcmVfZXZlbnRcIjtcbmltcG9ydCB7IGNvbXB1dGVSVEwgfSBmcm9tIFwiLi4vLi4vY29tbW9uL3V0aWwvY29tcHV0ZV9ydGxcIjtcbmltcG9ydCB7XG4gIGZvcm1hdE51bWJlcixcbiAgbnVtYmVyRm9ybWF0VG9Mb2NhbGUsXG4gIGdldE51bWJlckZvcm1hdE9wdGlvbnMsXG59IGZyb20gXCIuLi8uLi9jb21tb24vbnVtYmVyL2Zvcm1hdF9udW1iZXJcIjtcbmltcG9ydCB7IExpbmVDaGFydEVudGl0eSwgTGluZUNoYXJ0U3RhdGUgfSBmcm9tIFwiLi4vLi4vZGF0YS9oaXN0b3J5XCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uLy4uL3R5cGVzXCI7XG5pbXBvcnQge1xuICBDaGFydFJlc2l6ZU9wdGlvbnMsXG4gIEhhQ2hhcnRCYXNlLFxuICBNSU5fVElNRV9CRVRXRUVOX1VQREFURVMsXG59IGZyb20gXCIuL2hhLWNoYXJ0LWJhc2VcIjtcblxuY29uc3Qgc2FmZVBhcnNlRmxvYXQgPSAodmFsdWUpID0+IHtcbiAgY29uc3QgcGFyc2VkID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gIHJldHVybiBpc0Zpbml0ZShwYXJzZWQpID8gcGFyc2VkIDogbnVsbDtcbn07XG5cbmV4cG9ydCBjbGFzcyBTdGF0ZUhpc3RvcnlDaGFydExpbmUgZXh0ZW5kcyBMaXRFbGVtZW50IHtcbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgaGFzcyE6IEhvbWVBc3Npc3RhbnQ7XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgZGF0YTogTGluZUNoYXJ0RW50aXR5W10gPSBbXTtcblxuICBAcHJvcGVydHkoKSBwdWJsaWMgbmFtZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyB1bml0Pzogc3RyaW5nO1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyBpZGVudGlmaWVyPzogc3RyaW5nO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIHNob3dOYW1lcyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgY2xpY2tGb3JNb3JlSW5mbyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgc3RhcnRUaW1lITogRGF0ZTtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBlbmRUaW1lITogRGF0ZTtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBOdW1iZXIgfSkgcHVibGljIHBhZGRpbmdZQXhpcyA9IDA7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogTnVtYmVyIH0pIHB1YmxpYyBjaGFydEluZGV4PztcblxuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuIH0pIHB1YmxpYyBsb2dhcml0aG1pY1NjYWxlID0gZmFsc2U7XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfY2hhcnREYXRhPzogQ2hhcnREYXRhPFwibGluZVwiPjtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9lbnRpdHlJZHM6IHN0cmluZ1tdID0gW107XG5cbiAgcHJpdmF0ZSBfZGF0YXNldFRvRGF0YUluZGV4OiBudW1iZXJbXSA9IFtdO1xuXG4gIEBzdGF0ZSgpIHByaXZhdGUgX2NoYXJ0T3B0aW9ucz86IENoYXJ0T3B0aW9ucztcblxuICBAc3RhdGUoKSBwcml2YXRlIF95V2lkdGggPSAwO1xuXG4gIHByaXZhdGUgX2NoYXJ0VGltZTogRGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgQHF1ZXJ5KFwiaGEtY2hhcnQtYmFzZVwiKSBwcml2YXRlIF9jaGFydD86IEhhQ2hhcnRCYXNlO1xuXG4gIHB1YmxpYyByZXNpemUgPSAob3B0aW9ucz86IENoYXJ0UmVzaXplT3B0aW9ucyk6IHZvaWQgPT4ge1xuICAgIHRoaXMuX2NoYXJ0Py5yZXNpemUob3B0aW9ucyk7XG4gIH07XG5cbiAgcHJvdGVjdGVkIHJlbmRlcigpIHtcbiAgICByZXR1cm4gaHRtbGBcbiAgICAgIDxoYS1jaGFydC1iYXNlXG4gICAgICAgIC5oYXNzPSR7dGhpcy5oYXNzfVxuICAgICAgICAuZGF0YT0ke3RoaXMuX2NoYXJ0RGF0YX1cbiAgICAgICAgLm9wdGlvbnM9JHt0aGlzLl9jaGFydE9wdGlvbnN9XG4gICAgICAgIC5wYWRkaW5nWUF4aXM9JHt0aGlzLnBhZGRpbmdZQXhpcyAtIHRoaXMuX3lXaWR0aH1cbiAgICAgICAgY2hhcnQtdHlwZT1cImxpbmVcIlxuICAgICAgPjwvaGEtY2hhcnQtYmFzZT5cbiAgICBgO1xuICB9XG5cbiAgcHVibGljIHdpbGxVcGRhdGUoY2hhbmdlZFByb3BzOiBQcm9wZXJ0eVZhbHVlcykge1xuICAgIGlmIChcbiAgICAgICF0aGlzLmhhc1VwZGF0ZWQgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzaG93TmFtZXNcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzdGFydFRpbWVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJlbmRUaW1lXCIpIHx8XG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwidW5pdFwiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImxvZ2FyaXRobWljU2NhbGVcIilcbiAgICApIHtcbiAgICAgIHRoaXMuX2NoYXJ0T3B0aW9ucyA9IHtcbiAgICAgICAgcGFyc2luZzogZmFsc2UsXG4gICAgICAgIGFuaW1hdGlvbjogZmFsc2UsXG4gICAgICAgIGludGVyYWN0aW9uOiB7XG4gICAgICAgICAgbW9kZTogXCJuZWFyZXN0XCIsXG4gICAgICAgICAgYXhpczogXCJ4eVwiLFxuICAgICAgICB9LFxuICAgICAgICBzY2FsZXM6IHtcbiAgICAgICAgICB4OiB7XG4gICAgICAgICAgICB0eXBlOiBcInRpbWVcIixcbiAgICAgICAgICAgIGFkYXB0ZXJzOiB7XG4gICAgICAgICAgICAgIGRhdGU6IHtcbiAgICAgICAgICAgICAgICBsb2NhbGU6IHRoaXMuaGFzcy5sb2NhbGUsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB0aGlzLmhhc3MuY29uZmlnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Z2dlc3RlZE1pbjogdGhpcy5zdGFydFRpbWUsXG4gICAgICAgICAgICBzdWdnZXN0ZWRNYXg6IHRoaXMuZW5kVGltZSxcbiAgICAgICAgICAgIHRpY2tzOiB7XG4gICAgICAgICAgICAgIG1heFJvdGF0aW9uOiAwLFxuICAgICAgICAgICAgICBzYW1wbGVTaXplOiA1LFxuICAgICAgICAgICAgICBhdXRvU2tpcFBhZGRpbmc6IDIwLFxuICAgICAgICAgICAgICBtYWpvcjoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZvbnQ6IChjb250ZXh0KSA9PlxuICAgICAgICAgICAgICAgIGNvbnRleHQudGljayAmJiBjb250ZXh0LnRpY2subWFqb3JcbiAgICAgICAgICAgICAgICAgID8gKHsgd2VpZ2h0OiBcImJvbGRcIiB9IGFzIGFueSlcbiAgICAgICAgICAgICAgICAgIDoge30sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGltZToge1xuICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBcImRhdGV0aW1lc2Vjb25kc1wiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHk6IHtcbiAgICAgICAgICAgIHRpY2tzOiB7XG4gICAgICAgICAgICAgIG1heFRpY2tzTGltaXQ6IDcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICAgICAgZGlzcGxheTogdHJ1ZSxcbiAgICAgICAgICAgICAgdGV4dDogdGhpcy51bml0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFmdGVyVXBkYXRlOiAoeSkgPT4ge1xuICAgICAgICAgICAgICBpZiAodGhpcy5feVdpZHRoICE9PSBNYXRoLmZsb29yKHkud2lkdGgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feVdpZHRoID0gTWF0aC5mbG9vcih5LndpZHRoKTtcbiAgICAgICAgICAgICAgICBmaXJlRXZlbnQodGhpcywgXCJ5LXdpZHRoLWNoYW5nZWRcIiwge1xuICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuX3lXaWR0aCxcbiAgICAgICAgICAgICAgICAgIGNoYXJ0SW5kZXg6IHRoaXMuY2hhcnRJbmRleCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiBjb21wdXRlUlRMKHRoaXMuaGFzcykgPyBcInJpZ2h0XCIgOiBcImxlZnRcIixcbiAgICAgICAgICAgIHR5cGU6IHRoaXMubG9nYXJpdGhtaWNTY2FsZSA/IFwibG9nYXJpdGhtaWNcIiA6IFwibGluZWFyXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcGx1Z2luczoge1xuICAgICAgICAgIHRvb2x0aXA6IHtcbiAgICAgICAgICAgIGNhbGxiYWNrczoge1xuICAgICAgICAgICAgICBsYWJlbDogKGNvbnRleHQpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgbGFiZWwgPSBgJHtjb250ZXh0LmRhdGFzZXQubGFiZWx9OiAke2Zvcm1hdE51bWJlcihcbiAgICAgICAgICAgICAgICAgIGNvbnRleHQucGFyc2VkLnksXG4gICAgICAgICAgICAgICAgICB0aGlzLmhhc3MubG9jYWxlLFxuICAgICAgICAgICAgICAgICAgZ2V0TnVtYmVyRm9ybWF0T3B0aW9ucyhcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc3MuZW50aXRpZXNbdGhpcy5fZW50aXR5SWRzW2NvbnRleHQuZGF0YXNldEluZGV4XV1cbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApfSAke3RoaXMudW5pdH1gO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJbmRleCA9XG4gICAgICAgICAgICAgICAgICB0aGlzLl9kYXRhc2V0VG9EYXRhSW5kZXhbY29udGV4dC5kYXRhc2V0SW5kZXhdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGFbZGF0YUluZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0aXN0aWNzICYmIGRhdGEuc3RhdGlzdGljcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2UgPVxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXRlcy5sZW5ndGggPT09IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5wYXJzZWQueCA8IGRhdGEuc3RhdGVzWzBdLmxhc3RfY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgID8gYFxcbiR7dGhpcy5oYXNzLmxvY2FsaXplKFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcInVpLmNvbXBvbmVudHMuaGlzdG9yeV9jaGFydHMuc291cmNlX3N0YXRzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9YFxuICAgICAgICAgICAgICAgICAgICAgIDogYFxcbiR7dGhpcy5oYXNzLmxvY2FsaXplKFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcInVpLmNvbXBvbmVudHMuaGlzdG9yeV9jaGFydHMuc291cmNlX2hpc3RvcnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1gO1xuICAgICAgICAgICAgICAgICAgbGFiZWwgKz0gc291cmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmlsbGVyOiB7XG4gICAgICAgICAgICBwcm9wYWdhdGU6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBsZWdlbmQ6IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IHRoaXMuc2hvd05hbWVzLFxuICAgICAgICAgICAgbGFiZWxzOiB7XG4gICAgICAgICAgICAgIHVzZVBvaW50U3R5bGU6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgICAgbGluZToge1xuICAgICAgICAgICAgdGVuc2lvbjogMC4xLFxuICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDEuNSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBvaW50OiB7XG4gICAgICAgICAgICBoaXRSYWRpdXM6IDUwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHNlZ21lbnQ6IHtcbiAgICAgICAgICBib3JkZXJDb2xvcjogKGNvbnRleHQpID0+IHtcbiAgICAgICAgICAgIC8vIHJlbmRlciBzdGF0IGRhdGEgd2l0aCBhIHNsaWdodGx5IHRyYW5zcGFyZW50IGxpbmVcbiAgICAgICAgICAgIGNvbnN0IGRhdGFJbmRleCA9IHRoaXMuX2RhdGFzZXRUb0RhdGFJbmRleFtjb250ZXh0LmRhdGFzZXRJbmRleF07XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhW2RhdGFJbmRleF07XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5zdGF0aXN0aWNzICYmXG4gICAgICAgICAgICAgIGRhdGEuc3RhdGlzdGljcy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICAgIChkYXRhLnN0YXRlcy5sZW5ndGggPT09IDAgfHxcbiAgICAgICAgICAgICAgICBjb250ZXh0LnAwLnBhcnNlZC54IDwgZGF0YS5zdGF0ZXNbMF0ubGFzdF9jaGFuZ2VkKVxuICAgICAgICAgICAgICA/IHRoaXMuX2NoYXJ0RGF0YSEuZGF0YXNldHNbZGF0YUluZGV4XS5ib3JkZXJDb2xvciArIFwiN0ZcIlxuICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICAgIGxvY2FsZTogbnVtYmVyRm9ybWF0VG9Mb2NhbGUodGhpcy5oYXNzLmxvY2FsZSksXG4gICAgICAgIG9uQ2xpY2s6IChlOiBhbnkpID0+IHtcbiAgICAgICAgICBpZiAoIXRoaXMuY2xpY2tGb3JNb3JlSW5mbykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGNoYXJ0ID0gZS5jaGFydDtcblxuICAgICAgICAgIGNvbnN0IHBvaW50cyA9IGNoYXJ0LmdldEVsZW1lbnRzQXRFdmVudEZvck1vZGUoXG4gICAgICAgICAgICBlLFxuICAgICAgICAgICAgXCJuZWFyZXN0XCIsXG4gICAgICAgICAgICB7IGludGVyc2VjdDogdHJ1ZSB9LFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgZmlyc3RQb2ludCA9IHBvaW50c1swXTtcbiAgICAgICAgICAgIGZpcmVFdmVudCh0aGlzLCBcImhhc3MtbW9yZS1pbmZvXCIsIHtcbiAgICAgICAgICAgICAgZW50aXR5SWQ6IHRoaXMuX2VudGl0eUlkc1tmaXJzdFBvaW50LmRhdGFzZXRJbmRleF0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNoYXJ0LmNhbnZhcy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcIm1vdXNlb3V0XCIpKTsgLy8gdG8gaGlkZSB0b29sdGlwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImRhdGFcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzdGFydFRpbWVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJlbmRUaW1lXCIpIHx8XG4gICAgICB0aGlzLl9jaGFydFRpbWUgPFxuICAgICAgICBuZXcgRGF0ZSh0aGlzLmVuZFRpbWUuZ2V0VGltZSgpIC0gTUlOX1RJTUVfQkVUV0VFTl9VUERBVEVTKVxuICAgICkge1xuICAgICAgLy8gSWYgdGhlIGxpbmUgaXMgbW9yZSB0aGFuIDUgbWludXRlcyBvbGQsIHJlLWdlbiBpdFxuICAgICAgLy8gc28gdGhlIFggYXhpcyBncm93cyBldmVuIGlmIHRoZXJlIGlzIG5vIG5ldyBkYXRhXG4gICAgICB0aGlzLl9nZW5lcmF0ZURhdGEoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9nZW5lcmF0ZURhdGEoKSB7XG4gICAgbGV0IGNvbG9ySW5kZXggPSAwO1xuICAgIGNvbnN0IGNvbXB1dGVkU3R5bGVzID0gZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzKTtcbiAgICBjb25zdCBlbnRpdHlTdGF0ZXMgPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgZGF0YXNldHM6IENoYXJ0RGF0YXNldDxcImxpbmVcIj5bXSA9IFtdO1xuICAgIGNvbnN0IGVudGl0eUlkczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBkYXRhc2V0VG9EYXRhSW5kZXg6IG51bWJlcltdID0gW107XG4gICAgaWYgKGVudGl0eVN0YXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9jaGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGVuZFRpbWUgPSB0aGlzLmVuZFRpbWU7XG4gICAgY29uc3QgbmFtZXMgPSB0aGlzLm5hbWVzIHx8IHt9O1xuICAgIGVudGl0eVN0YXRlcy5mb3JFYWNoKChzdGF0ZXMsIGRhdGFJZHgpID0+IHtcbiAgICAgIGNvbnN0IGRvbWFpbiA9IHN0YXRlcy5kb21haW47XG4gICAgICBjb25zdCBuYW1lID0gbmFtZXNbc3RhdGVzLmVudGl0eV9pZF0gfHwgc3RhdGVzLm5hbWU7XG4gICAgICAvLyBhcnJheSBjb250YWluaW5nIFt2YWx1ZTEsIHZhbHVlMiwgZXRjXVxuICAgICAgbGV0IHByZXZWYWx1ZXM6IGFueVtdIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgIGNvbnN0IGRhdGE6IENoYXJ0RGF0YXNldDxcImxpbmVcIj5bXSA9IFtdO1xuXG4gICAgICBjb25zdCBwdXNoRGF0YSA9ICh0aW1lc3RhbXA6IERhdGUsIGRhdGF2YWx1ZXM6IGFueVtdIHwgbnVsbCkgPT4ge1xuICAgICAgICBpZiAoIWRhdGF2YWx1ZXMpIHJldHVybjtcbiAgICAgICAgaWYgKHRpbWVzdGFtcCA+IGVuZFRpbWUpIHtcbiAgICAgICAgICAvLyBEcm9wIGRhdGEgcG9pbnRzIHRoYXQgYXJlIGFmdGVyIHRoZSByZXF1ZXN0ZWQgZW5kVGltZS4gVGhpcyBjb3VsZCBoYXBwZW4gaWZcbiAgICAgICAgICAvLyBlbmRUaW1lIGlzIFwibm93XCIgYW5kIGNsaWVudCB0aW1lIGlzIG5vdCBpbiBzeW5jIHdpdGggc2VydmVyIHRpbWUuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEuZm9yRWFjaCgoZCwgaSkgPT4ge1xuICAgICAgICAgIGlmIChkYXRhdmFsdWVzW2ldID09PSBudWxsICYmIHByZXZWYWx1ZXMgJiYgcHJldlZhbHVlc1tpXSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gbnVsbCBkYXRhIHZhbHVlcyBzaG93IHVwIGFzIGdhcHMgaW4gdGhlIGNoYXJ0LlxuICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgdmFsdWUgZm9yIHRoZSBkYXRhc2V0IGlzIG51bGwgYW5kIHRoZSBwcmV2aW91c1xuICAgICAgICAgICAgLy8gdmFsdWUgb2YgdGhlIGRhdGEgc2V0IGlzIG5vdCBudWxsLCB0aGVuIGFkZCBhbiAnZW5kJyBwb2ludFxuICAgICAgICAgICAgLy8gdG8gdGhlIGNoYXJ0IGZvciB0aGUgcHJldmlvdXMgdmFsdWUuIE90aGVyd2lzZSB0aGUgZ2FwIHdpbGxcbiAgICAgICAgICAgIC8vIGJlIHRvbyBiaWcuIEl0IHdpbGwgZ28gZnJvbSB0aGUgc3RhcnQgb2YgdGhlIHByZXZpb3VzIGRhdGFcbiAgICAgICAgICAgIC8vIHZhbHVlIHVudGlsIHRoZSBzdGFydCBvZiB0aGUgbmV4dCBkYXRhIHZhbHVlLlxuICAgICAgICAgICAgZC5kYXRhLnB1c2goeyB4OiB0aW1lc3RhbXAuZ2V0VGltZSgpLCB5OiBwcmV2VmFsdWVzW2ldIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkLmRhdGEucHVzaCh7IHg6IHRpbWVzdGFtcC5nZXRUaW1lKCksIHk6IGRhdGF2YWx1ZXNbaV0gfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwcmV2VmFsdWVzID0gZGF0YXZhbHVlcztcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGFkZERhdGFTZXQgPSAobmFtZVk6IHN0cmluZywgZmlsbCA9IGZhbHNlLCBjb2xvcj86IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAoIWNvbG9yKSB7XG4gICAgICAgICAgY29sb3IgPSBnZXRHcmFwaENvbG9yQnlJbmRleChjb2xvckluZGV4LCBjb21wdXRlZFN0eWxlcyk7XG4gICAgICAgICAgY29sb3JJbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEucHVzaCh7XG4gICAgICAgICAgbGFiZWw6IG5hbWVZLFxuICAgICAgICAgIGZpbGw6IGZpbGwgPyBcIm9yaWdpblwiIDogZmFsc2UsXG4gICAgICAgICAgYm9yZGVyQ29sb3I6IGNvbG9yLFxuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY29sb3IgKyBcIjdGXCIsXG4gICAgICAgICAgc3RlcHBlZDogXCJiZWZvcmVcIixcbiAgICAgICAgICBwb2ludFJhZGl1czogMCxcbiAgICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgfSk7XG4gICAgICAgIGVudGl0eUlkcy5wdXNoKHN0YXRlcy5lbnRpdHlfaWQpO1xuICAgICAgICBkYXRhc2V0VG9EYXRhSW5kZXgucHVzaChkYXRhSWR4KTtcbiAgICAgIH07XG5cbiAgICAgIGlmIChcbiAgICAgICAgZG9tYWluID09PSBcInRoZXJtb3N0YXRcIiB8fFxuICAgICAgICBkb21haW4gPT09IFwiY2xpbWF0ZVwiIHx8XG4gICAgICAgIGRvbWFpbiA9PT0gXCJ3YXRlcl9oZWF0ZXJcIlxuICAgICAgKSB7XG4gICAgICAgIGNvbnN0IGhhc0h2YWNBY3Rpb24gPSBzdGF0ZXMuc3RhdGVzLnNvbWUoXG4gICAgICAgICAgKGVudGl0eVN0YXRlKSA9PiBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5odmFjX2FjdGlvblxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGlzSGVhdGluZyA9XG4gICAgICAgICAgZG9tYWluID09PSBcImNsaW1hdGVcIiAmJiBoYXNIdmFjQWN0aW9uXG4gICAgICAgICAgICA/IChlbnRpdHlTdGF0ZTogTGluZUNoYXJ0U3RhdGUpID0+XG4gICAgICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcz8uaHZhY19hY3Rpb24gPT09IFwiaGVhdGluZ1wiXG4gICAgICAgICAgICA6IChlbnRpdHlTdGF0ZTogTGluZUNoYXJ0U3RhdGUpID0+IGVudGl0eVN0YXRlLnN0YXRlID09PSBcImhlYXRcIjtcbiAgICAgICAgY29uc3QgaXNDb29saW5nID1cbiAgICAgICAgICBkb21haW4gPT09IFwiY2xpbWF0ZVwiICYmIGhhc0h2YWNBY3Rpb25cbiAgICAgICAgICAgID8gKGVudGl0eVN0YXRlOiBMaW5lQ2hhcnRTdGF0ZSkgPT5cbiAgICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5odmFjX2FjdGlvbiA9PT0gXCJjb29saW5nXCJcbiAgICAgICAgICAgIDogKGVudGl0eVN0YXRlOiBMaW5lQ2hhcnRTdGF0ZSkgPT4gZW50aXR5U3RhdGUuc3RhdGUgPT09IFwiY29vbFwiO1xuXG4gICAgICAgIGNvbnN0IGhhc0hlYXQgPSBzdGF0ZXMuc3RhdGVzLnNvbWUoaXNIZWF0aW5nKTtcbiAgICAgICAgY29uc3QgaGFzQ29vbCA9IHN0YXRlcy5zdGF0ZXMuc29tZShpc0Nvb2xpbmcpO1xuICAgICAgICAvLyBXZSBkaWZmZXJlbnRpYXRlIGJldHdlZW4gdGhlcm1vc3RhdHMgdGhhdCBoYXZlIGEgdGFyZ2V0IHRlbXBlcmF0dXJlXG4gICAgICAgIC8vIHJhbmdlIHZlcnN1cyBvbmVzIHRoYXQgaGF2ZSBqdXN0IGEgdGFyZ2V0IHRlbXBlcmF0dXJlXG5cbiAgICAgICAgLy8gVXNpbmcgc3RlcCBjaGFydCBieSBzdGVwLWJlZm9yZSBzbyBtYW51YWxseSBpbnRlcnBvbGF0aW9uIG5vdCBuZWVkZWQuXG4gICAgICAgIGNvbnN0IGhhc1RhcmdldFJhbmdlID0gc3RhdGVzLnN0YXRlcy5zb21lKFxuICAgICAgICAgIChlbnRpdHlTdGF0ZSkgPT5cbiAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXMgJiZcbiAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXMudGFyZ2V0X3RlbXBfaGlnaCAhPT1cbiAgICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcy50YXJnZXRfdGVtcF9sb3dcbiAgICAgICAgKTtcbiAgICAgICAgYWRkRGF0YVNldChcbiAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUuY3VycmVudF90ZW1wZXJhdHVyZVwiLCB7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgIH0pfWBcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGhhc0hlYXQpIHtcbiAgICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5jbGltYXRlLmhlYXRpbmdcIiwgeyBuYW1lOiBuYW1lIH0pfWAsXG4gICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZXMuZ2V0UHJvcGVydHlWYWx1ZShcIi0tc3RhdGUtY2xpbWF0ZS1oZWF0LWNvbG9yXCIpXG4gICAgICAgICAgKTtcbiAgICAgICAgICAvLyBUaGUgXCJoZWF0aW5nXCIgc2VyaWVzIHVzZXMgc3RlcHBlZEFyZWEgdG8gc2hhZGUgdGhlIGFyZWEgYmVsb3cgdGhlIGN1cnJlbnRcbiAgICAgICAgICAvLyB0ZW1wZXJhdHVyZSB3aGVuIHRoZSB0aGVybW9zdGF0IGlzIGNhbGxpbmcgZm9yIGhlYXQuXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhc0Nvb2wpIHtcbiAgICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5jbGltYXRlLmNvb2xpbmdcIiwgeyBuYW1lOiBuYW1lIH0pfWAsXG4gICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZXMuZ2V0UHJvcGVydHlWYWx1ZShcIi0tc3RhdGUtY2xpbWF0ZS1jb29sLWNvbG9yXCIpXG4gICAgICAgICAgKTtcbiAgICAgICAgICAvLyBUaGUgXCJjb29saW5nXCIgc2VyaWVzIHVzZXMgc3RlcHBlZEFyZWEgdG8gc2hhZGUgdGhlIGFyZWEgYmVsb3cgdGhlIGN1cnJlbnRcbiAgICAgICAgICAvLyB0ZW1wZXJhdHVyZSB3aGVuIHRoZSB0aGVybW9zdGF0IGlzIGNhbGxpbmcgZm9yIGhlYXQuXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGFzVGFyZ2V0UmFuZ2UpIHtcbiAgICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5jbGltYXRlLnRhcmdldF90ZW1wZXJhdHVyZV9tb2RlXCIsIHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgbW9kZTogdGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5jbGltYXRlLmhpZ2hcIiksXG4gICAgICAgICAgICB9KX1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5jbGltYXRlLnRhcmdldF90ZW1wZXJhdHVyZV9tb2RlXCIsIHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgbW9kZTogdGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5jbGltYXRlLmxvd1wiKSxcbiAgICAgICAgICAgIH0pfWBcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUudGFyZ2V0X3RlbXBlcmF0dXJlX2VudGl0eVwiLCB7XG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICB9KX1gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlcy5zdGF0ZXMuZm9yRWFjaCgoZW50aXR5U3RhdGUpID0+IHtcbiAgICAgICAgICBpZiAoIWVudGl0eVN0YXRlLmF0dHJpYnV0ZXMpIHJldHVybjtcbiAgICAgICAgICBjb25zdCBjdXJUZW1wID0gc2FmZVBhcnNlRmxvYXQoXG4gICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzLmN1cnJlbnRfdGVtcGVyYXR1cmVcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHNlcmllcyA9IFtjdXJUZW1wXTtcbiAgICAgICAgICBpZiAoaGFzSGVhdCkge1xuICAgICAgICAgICAgc2VyaWVzLnB1c2goaXNIZWF0aW5nKGVudGl0eVN0YXRlKSA/IGN1clRlbXAgOiBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGhhc0Nvb2wpIHtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKGlzQ29vbGluZyhlbnRpdHlTdGF0ZSkgPyBjdXJUZW1wIDogbnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYXNUYXJnZXRSYW5nZSkge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0SGlnaCA9IHNhZmVQYXJzZUZsb2F0KFxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzLnRhcmdldF90ZW1wX2hpZ2hcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRMb3cgPSBzYWZlUGFyc2VGbG9hdChcbiAgICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcy50YXJnZXRfdGVtcF9sb3dcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBzZXJpZXMucHVzaCh0YXJnZXRIaWdoLCB0YXJnZXRMb3cpO1xuICAgICAgICAgICAgcHVzaERhdGEobmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKSwgc2VyaWVzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gc2FmZVBhcnNlRmxvYXQoZW50aXR5U3RhdGUuYXR0cmlidXRlcy50ZW1wZXJhdHVyZSk7XG4gICAgICAgICAgICBzZXJpZXMucHVzaCh0YXJnZXQpO1xuICAgICAgICAgICAgcHVzaERhdGEobmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKSwgc2VyaWVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChkb21haW4gPT09IFwiaHVtaWRpZmllclwiKSB7XG4gICAgICAgIGNvbnN0IGhhc0FjdGlvbiA9IHN0YXRlcy5zdGF0ZXMuc29tZShcbiAgICAgICAgICAoZW50aXR5U3RhdGUpID0+IGVudGl0eVN0YXRlLmF0dHJpYnV0ZXM/LmFjdGlvblxuICAgICAgICApO1xuICAgICAgICBjb25zdCBoYXNDdXJyZW50ID0gc3RhdGVzLnN0YXRlcy5zb21lKFxuICAgICAgICAgIChlbnRpdHlTdGF0ZSkgPT4gZW50aXR5U3RhdGUuYXR0cmlidXRlcz8uY3VycmVudF9odW1pZGl0eVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGhhc0h1bWlkaWZ5aW5nID1cbiAgICAgICAgICBoYXNBY3Rpb24gJiZcbiAgICAgICAgICBzdGF0ZXMuc3RhdGVzLnNvbWUoXG4gICAgICAgICAgICAoZW50aXR5U3RhdGU6IExpbmVDaGFydFN0YXRlKSA9PlxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5hY3Rpb24gPT09IFwiaHVtaWRpZnlpbmdcIlxuICAgICAgICAgICk7XG4gICAgICAgIGNvbnN0IGhhc0RyeWluZyA9XG4gICAgICAgICAgaGFzQWN0aW9uICYmXG4gICAgICAgICAgc3RhdGVzLnN0YXRlcy5zb21lKFxuICAgICAgICAgICAgKGVudGl0eVN0YXRlOiBMaW5lQ2hhcnRTdGF0ZSkgPT5cbiAgICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcz8uYWN0aW9uID09PSBcImRyeWluZ1wiXG4gICAgICAgICAgKTtcblxuICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgIGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNhcmQuaHVtaWRpZmllci50YXJnZXRfaHVtaWRpdHlfZW50aXR5XCIsIHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgfSl9YFxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChoYXNDdXJyZW50KSB7XG4gICAgICAgICAgYWRkRGF0YVNldChcbiAgICAgICAgICAgIGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcbiAgICAgICAgICAgICAgXCJ1aS5jYXJkLmh1bWlkaWZpZXIuY3VycmVudF9odW1pZGl0eV9lbnRpdHlcIixcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICl9YFxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBhY3Rpb24gYXR0cmlidXRlIGlzIGF2YWlsYWJsZSwgd2UgdXNlZCBpdCB0byBzaGFkZSB0aGUgYXJlYSBiZWxvdyB0aGUgaHVtaWRpdHkuXG4gICAgICAgIC8vIElmIGFjdGlvbiBhdHRyaWJ1dGUgaXMgbm90IGF2YWlsYWJsZSwgd2Ugc2hhZGUgdGhlIGFyZWEgd2hlbiB0aGUgZGV2aWNlIGlzIG9uXG4gICAgICAgIGlmIChoYXNIdW1pZGlmeWluZykge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmh1bWlkaWZpZXIuaHVtaWRpZnlpbmdcIiwge1xuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgfSl9YCxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICBjb21wdXRlZFN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1zdGF0ZS1odW1pZGlmaWVyLW9uLWNvbG9yXCIpXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChoYXNEcnlpbmcpIHtcbiAgICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5odW1pZGlmaWVyLmRyeWluZ1wiLCB7XG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICB9KX1gLFxuICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzLmdldFByb3BlcnR5VmFsdWUoXCItLXN0YXRlLWh1bWlkaWZpZXItb24tY29sb3JcIilcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmh1bWlkaWZpZXIub25fZW50aXR5XCIsIHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIH0pfWAsXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlcy5zdGF0ZXMuZm9yRWFjaCgoZW50aXR5U3RhdGUpID0+IHtcbiAgICAgICAgICBpZiAoIWVudGl0eVN0YXRlLmF0dHJpYnV0ZXMpIHJldHVybjtcbiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBzYWZlUGFyc2VGbG9hdChlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzLmh1bWlkaXR5KTtcbiAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBodW1pZGl0eSBpcyBub3QgYXZhaWxhYmxlLCB0aGVuIHdlIGZpbGwgdXAgdG8gdGhlIHRhcmdldCBodW1pZGl0eVxuICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBoYXNDdXJyZW50XG4gICAgICAgICAgICA/IHNhZmVQYXJzZUZsb2F0KGVudGl0eVN0YXRlLmF0dHJpYnV0ZXM/LmN1cnJlbnRfaHVtaWRpdHkpXG4gICAgICAgICAgICA6IHRhcmdldDtcbiAgICAgICAgICBjb25zdCBzZXJpZXMgPSBbdGFyZ2V0XTtcblxuICAgICAgICAgIGlmIChoYXNDdXJyZW50KSB7XG4gICAgICAgICAgICBzZXJpZXMucHVzaChjdXJyZW50KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaGFzSHVtaWRpZnlpbmcpIHtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKFxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5hY3Rpb24gPT09IFwiaHVtaWRpZnlpbmdcIiA/IGN1cnJlbnQgOiBudWxsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRHJ5aW5nKSB7XG4gICAgICAgICAgICBzZXJpZXMucHVzaChcbiAgICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcz8uYWN0aW9uID09PSBcImRyeWluZ1wiID8gY3VycmVudCA6IG51bGxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKGVudGl0eVN0YXRlLnN0YXRlID09PSBcIm9uXCIgPyBjdXJyZW50IDogbnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHB1c2hEYXRhKG5ldyBEYXRlKGVudGl0eVN0YXRlLmxhc3RfY2hhbmdlZCksIHNlcmllcyk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkRGF0YVNldChuYW1lKTtcblxuICAgICAgICBsZXQgbGFzdFZhbHVlOiBudW1iZXI7XG4gICAgICAgIGxldCBsYXN0RGF0ZTogRGF0ZTtcbiAgICAgICAgbGV0IGxhc3ROdWxsRGF0ZTogRGF0ZSB8IG51bGwgPSBudWxsO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgY2hhcnQgZGF0YS5cbiAgICAgICAgLy8gV2hlbiBzdGF0ZSBpcyBgdW5rbm93bmAsIGNhbGN1bGF0ZSB0aGUgdmFsdWUgYW5kIGJyZWFrIHRoZSBsaW5lLlxuICAgICAgICBjb25zdCBwcm9jZXNzRGF0YSA9IChlbnRpdHlTdGF0ZTogTGluZUNoYXJ0U3RhdGUpID0+IHtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHNhZmVQYXJzZUZsb2F0KGVudGl0eVN0YXRlLnN0YXRlKTtcbiAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKTtcbiAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgbGFzdE51bGxEYXRlKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRlVGltZSA9IGRhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgY29uc3QgbGFzdE51bGxEYXRlVGltZSA9IGxhc3ROdWxsRGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICBjb25zdCBsYXN0RGF0ZVRpbWUgPSBsYXN0RGF0ZT8uZ2V0VGltZSgpO1xuICAgICAgICAgICAgY29uc3QgdG1wVmFsdWUgPVxuICAgICAgICAgICAgICAodmFsdWUgLSBsYXN0VmFsdWUpICpcbiAgICAgICAgICAgICAgICAoKGxhc3ROdWxsRGF0ZVRpbWUgLSBsYXN0RGF0ZVRpbWUpIC9cbiAgICAgICAgICAgICAgICAgIChkYXRlVGltZSAtIGxhc3REYXRlVGltZSkpICtcbiAgICAgICAgICAgICAgbGFzdFZhbHVlO1xuICAgICAgICAgICAgcHVzaERhdGEobGFzdE51bGxEYXRlLCBbdG1wVmFsdWVdKTtcbiAgICAgICAgICAgIHB1c2hEYXRhKG5ldyBEYXRlKGxhc3ROdWxsRGF0ZVRpbWUgKyAxKSwgW251bGxdKTtcbiAgICAgICAgICAgIHB1c2hEYXRhKGRhdGUsIFt2YWx1ZV0pO1xuICAgICAgICAgICAgbGFzdERhdGUgPSBkYXRlO1xuICAgICAgICAgICAgbGFzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICBsYXN0TnVsbERhdGUgPSBudWxsO1xuICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IG51bGwgJiYgbGFzdE51bGxEYXRlID09PSBudWxsKSB7XG4gICAgICAgICAgICBwdXNoRGF0YShkYXRlLCBbdmFsdWVdKTtcbiAgICAgICAgICAgIGxhc3REYXRlID0gZGF0ZTtcbiAgICAgICAgICAgIGxhc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICB2YWx1ZSA9PT0gbnVsbCAmJlxuICAgICAgICAgICAgbGFzdE51bGxEYXRlID09PSBudWxsICYmXG4gICAgICAgICAgICBsYXN0VmFsdWUgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICkge1xuICAgICAgICAgICAgbGFzdE51bGxEYXRlID0gZGF0ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHN0YXRlcy5zdGF0aXN0aWNzKSB7XG4gICAgICAgICAgY29uc3Qgc3RvcFRpbWUgPVxuICAgICAgICAgICAgIXN0YXRlcy5zdGF0ZXMgfHwgc3RhdGVzLnN0YXRlcy5sZW5ndGggPT09IDBcbiAgICAgICAgICAgICAgPyAwXG4gICAgICAgICAgICAgIDogc3RhdGVzLnN0YXRlc1swXS5sYXN0X2NoYW5nZWQ7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZXMuc3RhdGlzdGljcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHN0b3BUaW1lICYmIHN0YXRlcy5zdGF0aXN0aWNzW2ldLmxhc3RfY2hhbmdlZCA+PSBzdG9wVGltZSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByb2Nlc3NEYXRhKHN0YXRlcy5zdGF0aXN0aWNzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3RhdGVzLnN0YXRlcy5mb3JFYWNoKChlbnRpdHlTdGF0ZSkgPT4ge1xuICAgICAgICAgIHByb2Nlc3NEYXRhKGVudGl0eVN0YXRlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChsYXN0TnVsbERhdGUgIT09IG51bGwpIHtcbiAgICAgICAgICBwdXNoRGF0YShsYXN0TnVsbERhdGUsIFtudWxsXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGFuIGVudHJ5IGZvciBmaW5hbCB2YWx1ZXNcbiAgICAgIHB1c2hEYXRhKGVuZFRpbWUsIHByZXZWYWx1ZXMpO1xuXG4gICAgICAvLyBDb25jYXQgdHdvIGFycmF5c1xuICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZGF0YXNldHMsIGRhdGEpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2hhcnREYXRhID0ge1xuICAgICAgZGF0YXNldHMsXG4gICAgfTtcbiAgICB0aGlzLl9lbnRpdHlJZHMgPSBlbnRpdHlJZHM7XG4gICAgdGhpcy5fZGF0YXNldFRvRGF0YUluZGV4ID0gZGF0YXNldFRvRGF0YUluZGV4O1xuICB9XG59XG5jdXN0b21FbGVtZW50cy5kZWZpbmUoXCJzdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmVcIiwgU3RhdGVIaXN0b3J5Q2hhcnRMaW5lKTtcblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgSFRNTEVsZW1lbnRUYWdOYW1lTWFwIHtcbiAgICBcInN0YXRlLWhpc3RvcnktY2hhcnQtbGluZVwiOiBTdGF0ZUhpc3RvcnlDaGFydExpbmU7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/components/chart/state-history-chart-line.ts\n");

/***/ }),

/***/ "./src/components/chart/state-history-chart-timeline.ts":
/*!**************************************************************!*\
  !*** ./src/components/chart/state-history-chart-timeline.ts ***!
  \**************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateHistoryChartTimeline: () => (/* binding */ StateHistoryChartTimeline)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var chart_js_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! chart.js/helpers */ \"./node_modules/chart.js/helpers/helpers.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var _common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/datetime/format_date_time */ \"./src/common/datetime/format_date_time.ts\");\n/* harmony import */ var _common_datetime_milliseconds_to_duration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/datetime/milliseconds_to_duration */ \"./src/common/datetime/milliseconds_to_duration.ts\");\n/* harmony import */ var _common_dom_fire_event__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/dom/fire_event */ \"./src/common/dom/fire_event.ts\");\n/* harmony import */ var _common_number_format_number__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/number/format_number */ \"./src/common/number/format_number.ts\");\n/* harmony import */ var _common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/util/compute_rtl */ \"./src/common/util/compute_rtl.ts\");\n/* harmony import */ var _ha_chart_base__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ha-chart-base */ \"./src/components/chart/ha-chart-base.ts\");\n/* harmony import */ var _timeline_chart_timeline_color__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./timeline-chart/timeline-color */ \"./src/components/chart/timeline-chart/timeline-color.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__]);\n_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\nlet StateHistoryChartTimeline = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])([(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.customElement)(\"state-history-chart-timeline\")], function (_initialize, _LitElement) {\n  class StateHistoryChartTimeline extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: StateHistoryChartTimeline,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"data\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)()],\n      key: \"narrow\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)()],\n      key: \"names\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)()],\n      key: \"unit\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)()],\n      key: \"identifier\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"showNames\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"clickForMoreInfo\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"chunked\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"startTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"endTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Number\n      })],\n      key: \"paddingYAxis\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Number\n      })],\n      key: \"chartIndex\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.state)()],\n      key: \"_chartData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.state)()],\n      key: \"_chartOptions\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.state)()],\n      key: \"_yWidth\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_chartTime\",\n      value() {\n        return new Date();\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.query)(\"ha-chart-base\")],\n      key: \"_chart\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value() {\n        return options => {\n          var _this$_chart;\n          (_this$_chart = this._chart) === null || _this$_chart === void 0 || _this$_chart.resize(options);\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_2__.html)`\n      <ha-chart-base\n        .hass=${this.hass}\n        .data=${this._chartData}\n        .options=${this._chartOptions}\n        .height=${this.data.length * 30 + 30}\n        .paddingYAxis=${this.paddingYAxis - this._yWidth}\n        chart-type=\"timeline\"\n      ></ha-chart-base>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (!this.hasUpdated) {\n          this._createOptions();\n        }\n        if (changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || changedProps.has(\"data\") || this._chartTime < new Date(this.endTime.getTime() - _ha_chart_base__WEBPACK_IMPORTED_MODULE_9__.MIN_TIME_BETWEEN_UPDATES)) {\n          // If the line is more than 5 minutes old, re-gen it\n          // so the X axis grows even if there is no new data\n          this._generateData();\n        }\n        if (changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || changedProps.has(\"showNames\")) {\n          this._createOptions();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_createOptions\",\n      value: function _createOptions() {\n        const narrow = this.narrow;\n        this._chartOptions = {\n          maintainAspectRatio: false,\n          parsing: false,\n          animation: false,\n          scales: {\n            x: {\n              type: \"timeline\",\n              position: \"bottom\",\n              adapters: {\n                date: {\n                  locale: this.hass.locale,\n                  config: this.hass.config\n                }\n              },\n              suggestedMin: this.startTime,\n              suggestedMax: this.endTime,\n              ticks: {\n                autoSkip: true,\n                maxRotation: 0,\n                sampleSize: 5,\n                autoSkipPadding: 20,\n                major: {\n                  enabled: true\n                },\n                font: context => context.tick && context.tick.major ? {\n                  weight: \"bold\"\n                } : {}\n              },\n              grid: {\n                offset: false\n              },\n              time: {\n                tooltipFormat: \"datetimeseconds\"\n              }\n            },\n            y: {\n              type: \"category\",\n              barThickness: 20,\n              offset: true,\n              grid: {\n                display: false,\n                drawBorder: false,\n                drawTicks: false\n              },\n              ticks: {\n                display: this.chunked || this.showNames\n              },\n              afterSetDimensions: y => {\n                y.maxWidth = y.chart.width * 0.18;\n              },\n              afterFit: scaleInstance => {\n                if (this.chunked) {\n                  // ensure all the chart labels are the same width\n                  scaleInstance.width = narrow ? 105 : 185;\n                }\n              },\n              afterUpdate: y => {\n                var _y$width, _y$left;\n                const yWidth = this.showNames ? (_y$width = y.width) !== null && _y$width !== void 0 ? _y$width : 0 : (0,_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_8__.computeRTL)(this.hass) ? 0 : (_y$left = y.left) !== null && _y$left !== void 0 ? _y$left : 0;\n                if (this._yWidth !== Math.floor(yWidth) && y.ticks.length === this.data.length) {\n                  this._yWidth = Math.floor(yWidth);\n                  (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_6__.fireEvent)(this, \"y-width-changed\", {\n                    value: this._yWidth,\n                    chartIndex: this.chartIndex\n                  });\n                }\n              },\n              position: (0,_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_8__.computeRTL)(this.hass) ? \"right\" : \"left\"\n            }\n          },\n          plugins: {\n            tooltip: {\n              mode: \"nearest\",\n              callbacks: {\n                title: context => context[0].chart.data.labels[context[0].datasetIndex],\n                beforeBody: context => context[0].dataset.label || \"\",\n                label: item => {\n                  const d = item.dataset.data[item.dataIndex];\n                  const durationInMs = d.end.getTime() - d.start.getTime();\n                  const formattedDuration = `${this.hass.localize(\"ui.components.history_charts.duration\")}: ${(0,_common_datetime_milliseconds_to_duration__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(durationInMs)}`;\n                  return [d.label || \"\", (0,_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__.formatDateTimeWithSeconds)(d.start, this.hass.locale, this.hass.config), (0,_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__.formatDateTimeWithSeconds)(d.end, this.hass.locale, this.hass.config), formattedDuration];\n                },\n                labelColor: item => ({\n                  borderColor: item.dataset.data[item.dataIndex].color,\n                  backgroundColor: item.dataset.data[item.dataIndex].color\n                })\n              }\n            },\n            filler: {\n              propagate: true\n            }\n          },\n          // @ts-expect-error\n          locale: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_7__.numberFormatToLocale)(this.hass.locale),\n          onClick: e => {\n            var _this$_chartData;\n            if (!this.clickForMoreInfo) {\n              return;\n            }\n            const chart = e.chart;\n            const canvasPosition = (0,chart_js_helpers__WEBPACK_IMPORTED_MODULE_1__.getRelativePosition)(e, chart);\n            const index = Math.abs(chart.scales.y.getValueForPixel(canvasPosition.y));\n            (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_6__.fireEvent)(this, \"hass-more-info\", {\n              // @ts-ignore\n              entityId: (_this$_chartData = this._chartData) === null || _this$_chartData === void 0 || (_this$_chartData = _this$_chartData.datasets[index]) === null || _this$_chartData === void 0 ? void 0 : _this$_chartData.label\n            });\n            chart.canvas.dispatchEvent(new Event(\"mouseout\")); // to hide tooltip\n          }\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"_generateData\",\n      value: function _generateData() {\n        const computedStyles = getComputedStyle(this);\n        let stateHistory = this.data;\n        if (!stateHistory) {\n          stateHistory = [];\n        }\n        this._chartTime = new Date();\n        const startTime = this.startTime;\n        const endTime = this.endTime;\n        const labels = [];\n        const datasets = [];\n        const names = this.names || {};\n        // stateHistory is a list of lists of sorted state objects\n        stateHistory.forEach(stateInfo => {\n          let newLastChanged;\n          let prevState = null;\n          let locState = null;\n          let prevLastChanged = startTime;\n          const entityDisplay = names[stateInfo.entity_id] || stateInfo.name;\n          const dataRow = [];\n          stateInfo.data.forEach(entityState => {\n            let newState = entityState.state;\n            const timeStamp = new Date(entityState.last_changed);\n            if (!newState) {\n              newState = null;\n            }\n            if (timeStamp > endTime) {\n              // Drop datapoints that are after the requested endTime. This could happen if\n              // endTime is 'now' and client time is not in sync with server time.\n              return;\n            }\n            if (prevState === null) {\n              prevState = newState;\n              locState = entityState.state_localize;\n              prevLastChanged = new Date(entityState.last_changed);\n            } else if (newState !== prevState) {\n              newLastChanged = new Date(entityState.last_changed);\n              dataRow.push({\n                start: prevLastChanged,\n                end: newLastChanged,\n                label: locState,\n                color: (0,_timeline_chart_timeline_color__WEBPACK_IMPORTED_MODULE_10__.computeTimelineColor)(prevState, computedStyles, this.hass.states[stateInfo.entity_id])\n              });\n              prevState = newState;\n              locState = entityState.state_localize;\n              prevLastChanged = newLastChanged;\n            }\n          });\n          if (prevState !== null) {\n            dataRow.push({\n              start: prevLastChanged,\n              end: endTime,\n              label: locState,\n              color: (0,_timeline_chart_timeline_color__WEBPACK_IMPORTED_MODULE_10__.computeTimelineColor)(prevState, computedStyles, this.hass.states[stateInfo.entity_id])\n            });\n          }\n          datasets.push({\n            data: dataRow,\n            label: stateInfo.entity_id\n          });\n          labels.push(entityDisplay);\n        });\n        this._chartData = {\n          labels: labels,\n          datasets: datasets\n        };\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_2__.css)`\n      ha-chart-base {\n        --chart-max-height: none;\n      }\n    `;\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_2__.LitElement);\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFNQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQTRUQTtBQUFBO0FBQUE7QUE1VEE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBS0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFjQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lLnRzP2MwNTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDaGFydERhdGEsIENoYXJ0RGF0YXNldCwgQ2hhcnRPcHRpb25zIH0gZnJvbSBcImNoYXJ0LmpzXCI7XG5pbXBvcnQgeyBnZXRSZWxhdGl2ZVBvc2l0aW9uIH0gZnJvbSBcImNoYXJ0LmpzL2hlbHBlcnNcIjtcbmltcG9ydCB7IGNzcywgQ1NTUmVzdWx0R3JvdXAsIGh0bWwsIExpdEVsZW1lbnQsIFByb3BlcnR5VmFsdWVzIH0gZnJvbSBcImxpdFwiO1xuaW1wb3J0IHsgY3VzdG9tRWxlbWVudCwgcHJvcGVydHksIHF1ZXJ5LCBzdGF0ZSB9IGZyb20gXCJsaXQvZGVjb3JhdG9yc1wiO1xuaW1wb3J0IHsgZm9ybWF0RGF0ZVRpbWVXaXRoU2Vjb25kcyB9IGZyb20gXCIuLi8uLi9jb21tb24vZGF0ZXRpbWUvZm9ybWF0X2RhdGVfdGltZVwiO1xuaW1wb3J0IG1pbGxpc2Vjb25kc1RvRHVyYXRpb24gZnJvbSBcIi4uLy4uL2NvbW1vbi9kYXRldGltZS9taWxsaXNlY29uZHNfdG9fZHVyYXRpb25cIjtcbmltcG9ydCB7IGZpcmVFdmVudCB9IGZyb20gXCIuLi8uLi9jb21tb24vZG9tL2ZpcmVfZXZlbnRcIjtcbmltcG9ydCB7IG51bWJlckZvcm1hdFRvTG9jYWxlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9udW1iZXIvZm9ybWF0X251bWJlclwiO1xuaW1wb3J0IHsgY29tcHV0ZVJUTCB9IGZyb20gXCIuLi8uLi9jb21tb24vdXRpbC9jb21wdXRlX3J0bFwiO1xuaW1wb3J0IHsgVGltZWxpbmVFbnRpdHkgfSBmcm9tIFwiLi4vLi4vZGF0YS9oaXN0b3J5XCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uLy4uL3R5cGVzXCI7XG5pbXBvcnQge1xuICBDaGFydFJlc2l6ZU9wdGlvbnMsXG4gIEhhQ2hhcnRCYXNlLFxuICBNSU5fVElNRV9CRVRXRUVOX1VQREFURVMsXG59IGZyb20gXCIuL2hhLWNoYXJ0LWJhc2VcIjtcbmltcG9ydCB0eXBlIHsgVGltZUxpbmVEYXRhIH0gZnJvbSBcIi4vdGltZWxpbmUtY2hhcnQvY29uc3RcIjtcbmltcG9ydCB7IGNvbXB1dGVUaW1lbGluZUNvbG9yIH0gZnJvbSBcIi4vdGltZWxpbmUtY2hhcnQvdGltZWxpbmUtY29sb3JcIjtcblxuQGN1c3RvbUVsZW1lbnQoXCJzdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lXCIpXG5leHBvcnQgY2xhc3MgU3RhdGVIaXN0b3J5Q2hhcnRUaW1lbGluZSBleHRlbmRzIExpdEVsZW1lbnQge1xuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBoYXNzITogSG9tZUFzc2lzdGFudDtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBkYXRhOiBUaW1lbGluZUVudGl0eVtdID0gW107XG5cbiAgQHByb3BlcnR5KCkgcHVibGljIG5hcnJvdyE6IGJvb2xlYW47XG5cbiAgQHByb3BlcnR5KCkgcHVibGljIG5hbWVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblxuICBAcHJvcGVydHkoKSBwdWJsaWMgdW5pdD86IHN0cmluZztcblxuICBAcHJvcGVydHkoKSBwdWJsaWMgaWRlbnRpZmllcj86IHN0cmluZztcblxuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuIH0pIHB1YmxpYyBzaG93TmFtZXMgPSB0cnVlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGNsaWNrRm9yTW9yZUluZm8gPSB0cnVlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGNodW5rZWQgPSBmYWxzZTtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBzdGFydFRpbWUhOiBEYXRlO1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGVuZFRpbWUhOiBEYXRlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IE51bWJlciB9KSBwdWJsaWMgcGFkZGluZ1lBeGlzID0gMDtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBOdW1iZXIgfSkgcHVibGljIGNoYXJ0SW5kZXg/O1xuXG4gIEBzdGF0ZSgpIHByaXZhdGUgX2NoYXJ0RGF0YT86IENoYXJ0RGF0YTxcInRpbWVsaW5lXCI+O1xuXG4gIEBzdGF0ZSgpIHByaXZhdGUgX2NoYXJ0T3B0aW9ucz86IENoYXJ0T3B0aW9uczxcInRpbWVsaW5lXCI+O1xuXG4gIEBzdGF0ZSgpIHByaXZhdGUgX3lXaWR0aCA9IDA7XG5cbiAgcHJpdmF0ZSBfY2hhcnRUaW1lOiBEYXRlID0gbmV3IERhdGUoKTtcblxuICBAcXVlcnkoXCJoYS1jaGFydC1iYXNlXCIpIHByaXZhdGUgX2NoYXJ0PzogSGFDaGFydEJhc2U7XG5cbiAgcHVibGljIHJlc2l6ZSA9IChvcHRpb25zPzogQ2hhcnRSZXNpemVPcHRpb25zKTogdm9pZCA9PiB7XG4gICAgdGhpcy5fY2hhcnQ/LnJlc2l6ZShvcHRpb25zKTtcbiAgfTtcblxuICBwcm90ZWN0ZWQgcmVuZGVyKCkge1xuICAgIHJldHVybiBodG1sYFxuICAgICAgPGhhLWNoYXJ0LWJhc2VcbiAgICAgICAgLmhhc3M9JHt0aGlzLmhhc3N9XG4gICAgICAgIC5kYXRhPSR7dGhpcy5fY2hhcnREYXRhfVxuICAgICAgICAub3B0aW9ucz0ke3RoaXMuX2NoYXJ0T3B0aW9uc31cbiAgICAgICAgLmhlaWdodD0ke3RoaXMuZGF0YS5sZW5ndGggKiAzMCArIDMwfVxuICAgICAgICAucGFkZGluZ1lBeGlzPSR7dGhpcy5wYWRkaW5nWUF4aXMgLSB0aGlzLl95V2lkdGh9XG4gICAgICAgIGNoYXJ0LXR5cGU9XCJ0aW1lbGluZVwiXG4gICAgICA+PC9oYS1jaGFydC1iYXNlPlxuICAgIGA7XG4gIH1cblxuICBwdWJsaWMgd2lsbFVwZGF0ZShjaGFuZ2VkUHJvcHM6IFByb3BlcnR5VmFsdWVzKSB7XG4gICAgaWYgKCF0aGlzLmhhc1VwZGF0ZWQpIHtcbiAgICAgIHRoaXMuX2NyZWF0ZU9wdGlvbnMoKTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwic3RhcnRUaW1lXCIpIHx8XG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwiZW5kVGltZVwiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImRhdGFcIikgfHxcbiAgICAgIHRoaXMuX2NoYXJ0VGltZSA8XG4gICAgICAgIG5ldyBEYXRlKHRoaXMuZW5kVGltZS5nZXRUaW1lKCkgLSBNSU5fVElNRV9CRVRXRUVOX1VQREFURVMpXG4gICAgKSB7XG4gICAgICAvLyBJZiB0aGUgbGluZSBpcyBtb3JlIHRoYW4gNSBtaW51dGVzIG9sZCwgcmUtZ2VuIGl0XG4gICAgICAvLyBzbyB0aGUgWCBheGlzIGdyb3dzIGV2ZW4gaWYgdGhlcmUgaXMgbm8gbmV3IGRhdGFcbiAgICAgIHRoaXMuX2dlbmVyYXRlRGF0YSgpO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzdGFydFRpbWVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJlbmRUaW1lXCIpIHx8XG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwic2hvd05hbWVzXCIpXG4gICAgKSB7XG4gICAgICB0aGlzLl9jcmVhdGVPcHRpb25zKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfY3JlYXRlT3B0aW9ucygpIHtcbiAgICBjb25zdCBuYXJyb3cgPSB0aGlzLm5hcnJvdztcbiAgICB0aGlzLl9jaGFydE9wdGlvbnMgPSB7XG4gICAgICBtYWludGFpbkFzcGVjdFJhdGlvOiBmYWxzZSxcbiAgICAgIHBhcnNpbmc6IGZhbHNlLFxuICAgICAgYW5pbWF0aW9uOiBmYWxzZSxcbiAgICAgIHNjYWxlczoge1xuICAgICAgICB4OiB7XG4gICAgICAgICAgdHlwZTogXCJ0aW1lbGluZVwiLFxuICAgICAgICAgIHBvc2l0aW9uOiBcImJvdHRvbVwiLFxuICAgICAgICAgIGFkYXB0ZXJzOiB7XG4gICAgICAgICAgICBkYXRlOiB7XG4gICAgICAgICAgICAgIGxvY2FsZTogdGhpcy5oYXNzLmxvY2FsZSxcbiAgICAgICAgICAgICAgY29uZmlnOiB0aGlzLmhhc3MuY29uZmlnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN1Z2dlc3RlZE1pbjogdGhpcy5zdGFydFRpbWUsXG4gICAgICAgICAgc3VnZ2VzdGVkTWF4OiB0aGlzLmVuZFRpbWUsXG4gICAgICAgICAgdGlja3M6IHtcbiAgICAgICAgICAgIGF1dG9Ta2lwOiB0cnVlLFxuICAgICAgICAgICAgbWF4Um90YXRpb246IDAsXG4gICAgICAgICAgICBzYW1wbGVTaXplOiA1LFxuICAgICAgICAgICAgYXV0b1NraXBQYWRkaW5nOiAyMCxcbiAgICAgICAgICAgIG1ham9yOiB7XG4gICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZm9udDogKGNvbnRleHQpID0+XG4gICAgICAgICAgICAgIGNvbnRleHQudGljayAmJiBjb250ZXh0LnRpY2subWFqb3JcbiAgICAgICAgICAgICAgICA/ICh7IHdlaWdodDogXCJib2xkXCIgfSBhcyBhbnkpXG4gICAgICAgICAgICAgICAgOiB7fSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGdyaWQ6IHtcbiAgICAgICAgICAgIG9mZnNldDogZmFsc2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0aW1lOiB7XG4gICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBcImRhdGV0aW1lc2Vjb25kc1wiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHk6IHtcbiAgICAgICAgICB0eXBlOiBcImNhdGVnb3J5XCIsXG4gICAgICAgICAgYmFyVGhpY2tuZXNzOiAyMCxcbiAgICAgICAgICBvZmZzZXQ6IHRydWUsXG4gICAgICAgICAgZ3JpZDoge1xuICAgICAgICAgICAgZGlzcGxheTogZmFsc2UsXG4gICAgICAgICAgICBkcmF3Qm9yZGVyOiBmYWxzZSxcbiAgICAgICAgICAgIGRyYXdUaWNrczogZmFsc2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0aWNrczoge1xuICAgICAgICAgICAgZGlzcGxheTogdGhpcy5jaHVua2VkIHx8IHRoaXMuc2hvd05hbWVzLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYWZ0ZXJTZXREaW1lbnNpb25zOiAoeSkgPT4ge1xuICAgICAgICAgICAgeS5tYXhXaWR0aCA9IHkuY2hhcnQud2lkdGggKiAwLjE4O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYWZ0ZXJGaXQ6IChzY2FsZUluc3RhbmNlKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5jaHVua2VkKSB7XG4gICAgICAgICAgICAgIC8vIGVuc3VyZSBhbGwgdGhlIGNoYXJ0IGxhYmVscyBhcmUgdGhlIHNhbWUgd2lkdGhcbiAgICAgICAgICAgICAgc2NhbGVJbnN0YW5jZS53aWR0aCA9IG5hcnJvdyA/IDEwNSA6IDE4NTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGFmdGVyVXBkYXRlOiAoeSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeVdpZHRoID0gdGhpcy5zaG93TmFtZXNcbiAgICAgICAgICAgICAgPyB5LndpZHRoID8/IDBcbiAgICAgICAgICAgICAgOiBjb21wdXRlUlRMKHRoaXMuaGFzcylcbiAgICAgICAgICAgICAgICA/IDBcbiAgICAgICAgICAgICAgICA6IHkubGVmdCA/PyAwO1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICB0aGlzLl95V2lkdGggIT09IE1hdGguZmxvb3IoeVdpZHRoKSAmJlxuICAgICAgICAgICAgICB5LnRpY2tzLmxlbmd0aCA9PT0gdGhpcy5kYXRhLmxlbmd0aFxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIHRoaXMuX3lXaWR0aCA9IE1hdGguZmxvb3IoeVdpZHRoKTtcbiAgICAgICAgICAgICAgZmlyZUV2ZW50KHRoaXMsIFwieS13aWR0aC1jaGFuZ2VkXCIsIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5feVdpZHRoLFxuICAgICAgICAgICAgICAgIGNoYXJ0SW5kZXg6IHRoaXMuY2hhcnRJbmRleCxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBwb3NpdGlvbjogY29tcHV0ZVJUTCh0aGlzLmhhc3MpID8gXCJyaWdodFwiIDogXCJsZWZ0XCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgcGx1Z2luczoge1xuICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgbW9kZTogXCJuZWFyZXN0XCIsXG4gICAgICAgICAgY2FsbGJhY2tzOiB7XG4gICAgICAgICAgICB0aXRsZTogKGNvbnRleHQpID0+XG4gICAgICAgICAgICAgIGNvbnRleHQhWzBdLmNoYXJ0IS5kYXRhIS5sYWJlbHMhW1xuICAgICAgICAgICAgICAgIGNvbnRleHRbMF0uZGF0YXNldEluZGV4XG4gICAgICAgICAgICAgIF0gYXMgc3RyaW5nLFxuICAgICAgICAgICAgYmVmb3JlQm9keTogKGNvbnRleHQpID0+IGNvbnRleHRbMF0uZGF0YXNldC5sYWJlbCB8fCBcIlwiLFxuICAgICAgICAgICAgbGFiZWw6IChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGQgPSBpdGVtLmRhdGFzZXQuZGF0YVtpdGVtLmRhdGFJbmRleF0gYXMgVGltZUxpbmVEYXRhO1xuICAgICAgICAgICAgICBjb25zdCBkdXJhdGlvbkluTXMgPSBkLmVuZC5nZXRUaW1lKCkgLSBkLnN0YXJ0LmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkRHVyYXRpb24gPSBgJHt0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgXCJ1aS5jb21wb25lbnRzLmhpc3RvcnlfY2hhcnRzLmR1cmF0aW9uXCJcbiAgICAgICAgICAgICAgKX06ICR7bWlsbGlzZWNvbmRzVG9EdXJhdGlvbihkdXJhdGlvbkluTXMpfWA7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBkLmxhYmVsIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgZm9ybWF0RGF0ZVRpbWVXaXRoU2Vjb25kcyhcbiAgICAgICAgICAgICAgICAgIGQuc3RhcnQsXG4gICAgICAgICAgICAgICAgICB0aGlzLmhhc3MubG9jYWxlLFxuICAgICAgICAgICAgICAgICAgdGhpcy5oYXNzLmNvbmZpZ1xuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgZm9ybWF0RGF0ZVRpbWVXaXRoU2Vjb25kcyhcbiAgICAgICAgICAgICAgICAgIGQuZW5kLFxuICAgICAgICAgICAgICAgICAgdGhpcy5oYXNzLmxvY2FsZSxcbiAgICAgICAgICAgICAgICAgIHRoaXMuaGFzcy5jb25maWdcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZER1cmF0aW9uLFxuICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxhYmVsQ29sb3I6IChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICBib3JkZXJDb2xvcjogKGl0ZW0uZGF0YXNldC5kYXRhW2l0ZW0uZGF0YUluZGV4XSBhcyBUaW1lTGluZURhdGEpXG4gICAgICAgICAgICAgICAgLmNvbG9yISxcbiAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAoXG4gICAgICAgICAgICAgICAgaXRlbS5kYXRhc2V0LmRhdGFbaXRlbS5kYXRhSW5kZXhdIGFzIFRpbWVMaW5lRGF0YVxuICAgICAgICAgICAgICApLmNvbG9yISxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGZpbGxlcjoge1xuICAgICAgICAgIHByb3BhZ2F0ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICBsb2NhbGU6IG51bWJlckZvcm1hdFRvTG9jYWxlKHRoaXMuaGFzcy5sb2NhbGUpLFxuICAgICAgb25DbGljazogKGU6IGFueSkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuY2xpY2tGb3JNb3JlSW5mbykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoYXJ0ID0gZS5jaGFydDtcbiAgICAgICAgY29uc3QgY2FudmFzUG9zaXRpb24gPSBnZXRSZWxhdGl2ZVBvc2l0aW9uKGUsIGNoYXJ0KTtcblxuICAgICAgICBjb25zdCBpbmRleCA9IE1hdGguYWJzKFxuICAgICAgICAgIGNoYXJ0LnNjYWxlcy55LmdldFZhbHVlRm9yUGl4ZWwoY2FudmFzUG9zaXRpb24ueSlcbiAgICAgICAgKTtcbiAgICAgICAgZmlyZUV2ZW50KHRoaXMsIFwiaGFzcy1tb3JlLWluZm9cIiwge1xuICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICBlbnRpdHlJZDogdGhpcy5fY2hhcnREYXRhPy5kYXRhc2V0c1tpbmRleF0/LmxhYmVsLFxuICAgICAgICB9KTtcbiAgICAgICAgY2hhcnQuY2FudmFzLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwibW91c2VvdXRcIikpOyAvLyB0byBoaWRlIHRvb2x0aXBcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgX2dlbmVyYXRlRGF0YSgpIHtcbiAgICBjb25zdCBjb21wdXRlZFN0eWxlcyA9IGdldENvbXB1dGVkU3R5bGUodGhpcyk7XG4gICAgbGV0IHN0YXRlSGlzdG9yeSA9IHRoaXMuZGF0YTtcblxuICAgIGlmICghc3RhdGVIaXN0b3J5KSB7XG4gICAgICBzdGF0ZUhpc3RvcnkgPSBbXTtcbiAgICB9XG5cbiAgICB0aGlzLl9jaGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHRoaXMuc3RhcnRUaW1lO1xuICAgIGNvbnN0IGVuZFRpbWUgPSB0aGlzLmVuZFRpbWU7XG4gICAgY29uc3QgbGFiZWxzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGRhdGFzZXRzOiBDaGFydERhdGFzZXQ8XCJ0aW1lbGluZVwiPltdID0gW107XG4gICAgY29uc3QgbmFtZXMgPSB0aGlzLm5hbWVzIHx8IHt9O1xuICAgIC8vIHN0YXRlSGlzdG9yeSBpcyBhIGxpc3Qgb2YgbGlzdHMgb2Ygc29ydGVkIHN0YXRlIG9iamVjdHNcbiAgICBzdGF0ZUhpc3RvcnkuZm9yRWFjaCgoc3RhdGVJbmZvKSA9PiB7XG4gICAgICBsZXQgbmV3TGFzdENoYW5nZWQ6IERhdGU7XG4gICAgICBsZXQgcHJldlN0YXRlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICAgIGxldCBsb2NTdGF0ZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgICBsZXQgcHJldkxhc3RDaGFuZ2VkID0gc3RhcnRUaW1lO1xuICAgICAgY29uc3QgZW50aXR5RGlzcGxheTogc3RyaW5nID1cbiAgICAgICAgbmFtZXNbc3RhdGVJbmZvLmVudGl0eV9pZF0gfHwgc3RhdGVJbmZvLm5hbWU7XG5cbiAgICAgIGNvbnN0IGRhdGFSb3c6IFRpbWVMaW5lRGF0YVtdID0gW107XG4gICAgICBzdGF0ZUluZm8uZGF0YS5mb3JFYWNoKChlbnRpdHlTdGF0ZSkgPT4ge1xuICAgICAgICBsZXQgbmV3U3RhdGU6IHN0cmluZyB8IG51bGwgPSBlbnRpdHlTdGF0ZS5zdGF0ZTtcbiAgICAgICAgY29uc3QgdGltZVN0YW1wID0gbmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKTtcbiAgICAgICAgaWYgKCFuZXdTdGF0ZSkge1xuICAgICAgICAgIG5ld1N0YXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZVN0YW1wID4gZW5kVGltZSkge1xuICAgICAgICAgIC8vIERyb3AgZGF0YXBvaW50cyB0aGF0IGFyZSBhZnRlciB0aGUgcmVxdWVzdGVkIGVuZFRpbWUuIFRoaXMgY291bGQgaGFwcGVuIGlmXG4gICAgICAgICAgLy8gZW5kVGltZSBpcyAnbm93JyBhbmQgY2xpZW50IHRpbWUgaXMgbm90IGluIHN5bmMgd2l0aCBzZXJ2ZXIgdGltZS5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZXZTdGF0ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHByZXZTdGF0ZSA9IG5ld1N0YXRlO1xuICAgICAgICAgIGxvY1N0YXRlID0gZW50aXR5U3RhdGUuc3RhdGVfbG9jYWxpemU7XG4gICAgICAgICAgcHJldkxhc3RDaGFuZ2VkID0gbmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuZXdTdGF0ZSAhPT0gcHJldlN0YXRlKSB7XG4gICAgICAgICAgbmV3TGFzdENoYW5nZWQgPSBuZXcgRGF0ZShlbnRpdHlTdGF0ZS5sYXN0X2NoYW5nZWQpO1xuXG4gICAgICAgICAgZGF0YVJvdy5wdXNoKHtcbiAgICAgICAgICAgIHN0YXJ0OiBwcmV2TGFzdENoYW5nZWQsXG4gICAgICAgICAgICBlbmQ6IG5ld0xhc3RDaGFuZ2VkLFxuICAgICAgICAgICAgbGFiZWw6IGxvY1N0YXRlLFxuICAgICAgICAgICAgY29sb3I6IGNvbXB1dGVUaW1lbGluZUNvbG9yKFxuICAgICAgICAgICAgICBwcmV2U3RhdGUsXG4gICAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzLFxuICAgICAgICAgICAgICB0aGlzLmhhc3Muc3RhdGVzW3N0YXRlSW5mby5lbnRpdHlfaWRdXG4gICAgICAgICAgICApLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcHJldlN0YXRlID0gbmV3U3RhdGU7XG4gICAgICAgICAgbG9jU3RhdGUgPSBlbnRpdHlTdGF0ZS5zdGF0ZV9sb2NhbGl6ZTtcbiAgICAgICAgICBwcmV2TGFzdENoYW5nZWQgPSBuZXdMYXN0Q2hhbmdlZDtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChwcmV2U3RhdGUgIT09IG51bGwpIHtcbiAgICAgICAgZGF0YVJvdy5wdXNoKHtcbiAgICAgICAgICBzdGFydDogcHJldkxhc3RDaGFuZ2VkLFxuICAgICAgICAgIGVuZDogZW5kVGltZSxcbiAgICAgICAgICBsYWJlbDogbG9jU3RhdGUsXG4gICAgICAgICAgY29sb3I6IGNvbXB1dGVUaW1lbGluZUNvbG9yKFxuICAgICAgICAgICAgcHJldlN0YXRlLFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZXMsXG4gICAgICAgICAgICB0aGlzLmhhc3Muc3RhdGVzW3N0YXRlSW5mby5lbnRpdHlfaWRdXG4gICAgICAgICAgKSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBkYXRhc2V0cy5wdXNoKHtcbiAgICAgICAgZGF0YTogZGF0YVJvdyxcbiAgICAgICAgbGFiZWw6IHN0YXRlSW5mby5lbnRpdHlfaWQsXG4gICAgICB9KTtcbiAgICAgIGxhYmVscy5wdXNoKGVudGl0eURpc3BsYXkpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2hhcnREYXRhID0ge1xuICAgICAgbGFiZWxzOiBsYWJlbHMsXG4gICAgICBkYXRhc2V0czogZGF0YXNldHMsXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBnZXQgc3R5bGVzKCk6IENTU1Jlc3VsdEdyb3VwIHtcbiAgICByZXR1cm4gY3NzYFxuICAgICAgaGEtY2hhcnQtYmFzZSB7XG4gICAgICAgIC0tY2hhcnQtbWF4LWhlaWdodDogbm9uZTtcbiAgICAgIH1cbiAgICBgO1xuICB9XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEhUTUxFbGVtZW50VGFnTmFtZU1hcCB7XG4gICAgXCJzdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lXCI6IFN0YXRlSGlzdG9yeUNoYXJ0VGltZWxpbmU7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/components/chart/state-history-chart-timeline.ts\n");

/***/ }),

/***/ "./src/components/chart/state-history-charts.ts":
/*!******************************************************!*\
  !*** ./src/components/chart/state-history-charts.ts ***!
  \******************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateHistoryCharts: () => (/* binding */ StateHistoryCharts)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var _common_config_is_component_loaded__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/config/is_component_loaded */ \"./src/common/config/is_component_loaded.ts\");\n/* harmony import */ var _common_decorators_restore_scroll__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/decorators/restore-scroll */ \"./src/common/decorators/restore-scroll.ts\");\n/* harmony import */ var _resources_virtualizer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../resources/virtualizer */ \"./src/resources/virtualizer.ts\");\n/* harmony import */ var _state_history_chart_line__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./state-history-chart-line */ \"./src/components/chart/state-history-chart-line.ts\");\n/* harmony import */ var _state_history_chart_timeline__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./state-history-chart-timeline */ \"./src/components/chart/state-history-chart-timeline.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_state_history_chart_timeline__WEBPACK_IMPORTED_MODULE_7__]);\n_state_history_chart_timeline__WEBPACK_IMPORTED_MODULE_7__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\nconst CANVAS_TIMELINE_ROWS_CHUNK = 10; // Split up the canvases to avoid hitting the render limit\n\nconst chunkData = (inputArray, chunks) => inputArray.reduce((results, item, idx) => {\n  const chunkIdx = Math.floor(idx / chunks);\n  if (!results[chunkIdx]) {\n    results[chunkIdx] = [];\n  }\n  results[chunkIdx].push(item);\n  return results;\n}, []);\nlet StateHistoryCharts = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])([(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.customElement)(\"state-history-charts\")], function (_initialize, _LitElement) {\n  class StateHistoryCharts extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: StateHistoryCharts,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"historyData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"narrow\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"names\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"virtualize\",\n        reflect: true\n      })],\n      key: \"virtualize\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"endTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"startTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"up-to-now\"\n      })],\n      key: \"upToNow\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"hoursToShow\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"showNames\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"clickForMoreInfo\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"isLoadingData\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"logarithmicScale\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_computedStartTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_computedEndTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_maxYWidth\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_childYWidths\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_chartCount\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,_common_decorators_restore_scroll__WEBPACK_IMPORTED_MODULE_4__.restoreScroll)(\".container\")],\n      key: \"_savedScrollPos\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.queryAll)(\"state-history-chart-line\")],\n      key: \"_charts\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value() {\n        return options => {\n          var _this$_charts;\n          (_this$_charts = this._charts) === null || _this$_charts === void 0 || _this$_charts.forEach(chart => chart.resize(options));\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value:\n      // @ts-ignore\n\n      function render() {\n        if (!(0,_common_config_is_component_loaded__WEBPACK_IMPORTED_MODULE_3__.isComponentLoaded)(this.hass, \"history\")) {\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"info\">\n        ${this.hass.localize(\"ui.components.history_charts.history_disabled\")}\n      </div>`;\n        }\n        if (this.isLoadingData && !this.historyData) {\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"info\">\n        ${this.hass.localize(\"ui.components.history_charts.loading_history\")}\n      </div>`;\n        }\n        if (this._isHistoryEmpty()) {\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"info\">\n        ${this.hass.localize(\"ui.components.history_charts.no_history_found\")}\n      </div>`;\n        }\n        const combinedItems = this.historyData.timeline.length ? (this.virtualize ? chunkData(this.historyData.timeline, CANVAS_TIMELINE_ROWS_CHUNK) : [this.historyData.timeline]).concat(this.historyData.line) : this.historyData.line;\n        this._chartCount = combinedItems.length;\n        return this.virtualize ? (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"container ha-scrollbar\" @scroll=${this._saveScrollPos}>\n          <lit-virtualizer\n            scroller\n            class=\"ha-scrollbar\"\n            .items=${combinedItems}\n            .renderItem=${this._renderHistoryItem}\n          >\n          </lit-virtualizer>\n        </div>` : (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`${combinedItems.map((item, index) => this._renderHistoryItem(item, index))}`;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_renderHistoryItem\",\n      value() {\n        return (item, index) => {\n          if (!item || index === undefined) {\n            return lit__WEBPACK_IMPORTED_MODULE_1__.nothing;\n          }\n          if (!Array.isArray(item)) {\n            return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"entry-container\">\n        <state-history-chart-line\n          .hass=${this.hass}\n          .unit=${item.unit}\n          .data=${item.data}\n          .identifier=${item.identifier}\n          .showNames=${this.showNames}\n          .startTime=${this._computedStartTime}\n          .endTime=${this._computedEndTime}\n          .paddingYAxis=${this._maxYWidth}\n          .names=${this.names}\n          .chartIndex=${index}\n          .clickForMoreInfo=${this.clickForMoreInfo}\n          .logarithmicScale=${this.logarithmicScale}\n          @y-width-changed=${this._yWidthChanged}\n        ></state-history-chart-line>\n      </div> `;\n          }\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"entry-container\">\n      <state-history-chart-timeline\n        .hass=${this.hass}\n        .data=${item}\n        .startTime=${this._computedStartTime}\n        .endTime=${this._computedEndTime}\n        .showNames=${this.showNames}\n        .names=${this.names}\n        .narrow=${this.narrow}\n        .chunked=${this.virtualize}\n        .paddingYAxis=${this._maxYWidth}\n        .chartIndex=${index}\n        .clickForMoreInfo=${this.clickForMoreInfo}\n        @y-width-changed=${this._yWidthChanged}\n      ></state-history-chart-timeline>\n    </div> `;\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value: function shouldUpdate(changedProps) {\n        if (changedProps.size === 1 && changedProps.has(\"hass\")) {\n          return false;\n        }\n        if (changedProps.size === 1 && changedProps.has(\"_maxYWidth\") && changedProps.get(\"_maxYWidth\") === this._maxYWidth) {\n          return false;\n        }\n        return true;\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (!this.hasUpdated) {\n          (0,_resources_virtualizer__WEBPACK_IMPORTED_MODULE_5__.loadVirtualizer)();\n        }\n        if ([...changedProps.keys()].some(prop => ![\"_maxYWidth\", \"_childYWidths\", \"_chartCount\"].includes(prop))) {\n          // Don't recompute times when we just want to update layout\n          const now = new Date();\n          this._computedEndTime = this.upToNow || !this.endTime || this.endTime > now ? now : this.endTime;\n          if (this.startTime) {\n            this._computedStartTime = this.startTime;\n          } else if (this.hoursToShow) {\n            this._computedStartTime = new Date(new Date().getTime() - 60 * 60 * this.hoursToShow * 1000);\n          } else {\n            var _this$historyData$tim, _this$historyData;\n            this._computedStartTime = new Date(((_this$historyData$tim = (_this$historyData = this.historyData) === null || _this$historyData === void 0 ? void 0 : _this$historyData.timeline) !== null && _this$historyData$tim !== void 0 ? _this$historyData$tim : []).reduce((minTime, stateInfo) => Math.min(minTime, new Date(stateInfo.data[0].last_changed).getTime()), new Date().getTime()));\n          }\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        if (changedProps.has(\"_chartCount\")) {\n          if (this._chartCount < this._childYWidths.length) {\n            this._childYWidths.length = this._chartCount;\n            this._maxYWidth = Math.max(...Object.values(this._childYWidths), 0);\n          }\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_yWidthChanged\",\n      value: function _yWidthChanged(e) {\n        this._childYWidths[e.detail.chartIndex] = e.detail.value;\n        this._maxYWidth = Math.max(...Object.values(this._childYWidths), 0);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_isHistoryEmpty\",\n      value: function _isHistoryEmpty() {\n        const historyDataEmpty = !this.historyData || !this.historyData.timeline || !this.historyData.line || this.historyData.timeline.length === 0 && this.historyData.line.length === 0;\n        return !this.isLoadingData && historyDataEmpty;\n      }\n    }, {\n      kind: \"method\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.eventOptions)({\n        passive: true\n      })],\n      key: \"_saveScrollPos\",\n      value: function _saveScrollPos(e) {\n        this._savedScrollPos = e.target.scrollTop;\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_1__.css)`\n      :host {\n        display: block;\n        /* height of single timeline chart = 60px */\n        min-height: 60px;\n      }\n\n      :host([virtualize]) {\n        height: 100%;\n      }\n\n      .info {\n        text-align: center;\n        line-height: 60px;\n        color: var(--secondary-text-color);\n      }\n\n      .container {\n        max-height: var(--history-max-height);\n      }\n\n      .entry-container {\n        width: 100%;\n      }\n\n      .entry-container:hover {\n        z-index: 1;\n      }\n\n      :host([virtualize]) .entry-container {\n        padding-left: 1px;\n        padding-right: 1px;\n      }\n\n      .entry-container:not(:first-child) {\n        border-top: 2px solid var(--divider-color);\n        margin-top: 16px;\n      }\n\n      .container,\n      lit-virtualizer {\n        height: 100%;\n        width: 100%;\n      }\n\n      lit-virtualizer {\n        contain: size layout !important;\n      }\n\n      state-history-chart-timeline,\n      state-history-chart-line {\n        width: 100%;\n      }\n    `;\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_1__.LitElement);\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFRQTtBQU9BO0FBQ0E7QUFNQTtBQUVBO0FBQ0E7QUFLQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBcVJBO0FBQUE7QUFBQTtBQXJSQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBWEE7O0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUFBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2NvbXBvbmVudHMvY2hhcnQvc3RhdGUtaGlzdG9yeS1jaGFydHMudHM/YTBmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBjc3MsXG4gIENTU1Jlc3VsdEdyb3VwLFxuICBodG1sLFxuICBMaXRFbGVtZW50LFxuICBub3RoaW5nLFxuICBQcm9wZXJ0eVZhbHVlcyxcbn0gZnJvbSBcImxpdFwiO1xuaW1wb3J0IHtcbiAgY3VzdG9tRWxlbWVudCxcbiAgZXZlbnRPcHRpb25zLFxuICBwcm9wZXJ0eSxcbiAgcXVlcnlBbGwsXG4gIHN0YXRlLFxufSBmcm9tIFwibGl0L2RlY29yYXRvcnNcIjtcbmltcG9ydCB7IGlzQ29tcG9uZW50TG9hZGVkIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9jb25maWcvaXNfY29tcG9uZW50X2xvYWRlZFwiO1xuaW1wb3J0IHsgcmVzdG9yZVNjcm9sbCB9IGZyb20gXCIuLi8uLi9jb21tb24vZGVjb3JhdG9ycy9yZXN0b3JlLXNjcm9sbFwiO1xuaW1wb3J0IHtcbiAgSGlzdG9yeVJlc3VsdCxcbiAgTGluZUNoYXJ0VW5pdCxcbiAgVGltZWxpbmVFbnRpdHksXG59IGZyb20gXCIuLi8uLi9kYXRhL2hpc3RvcnlcIjtcbmltcG9ydCB7IGxvYWRWaXJ0dWFsaXplciB9IGZyb20gXCIuLi8uLi9yZXNvdXJjZXMvdmlydHVhbGl6ZXJcIjtcbmltcG9ydCB0eXBlIHsgSG9tZUFzc2lzdGFudCB9IGZyb20gXCIuLi8uLi90eXBlc1wiO1xuaW1wb3J0IFwiLi9zdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmVcIjtcbmltcG9ydCBcIi4vc3RhdGUtaGlzdG9yeS1jaGFydC10aW1lbGluZVwiO1xuaW1wb3J0IHR5cGUgeyBTdGF0ZUhpc3RvcnlDaGFydExpbmUgfSBmcm9tIFwiLi9zdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmVcIjtcbmltcG9ydCB0eXBlIHsgU3RhdGVIaXN0b3J5Q2hhcnRUaW1lbGluZSB9IGZyb20gXCIuL3N0YXRlLWhpc3RvcnktY2hhcnQtdGltZWxpbmVcIjtcbmltcG9ydCB7IENoYXJ0UmVzaXplT3B0aW9ucyB9IGZyb20gXCIuL2hhLWNoYXJ0LWJhc2VcIjtcblxuY29uc3QgQ0FOVkFTX1RJTUVMSU5FX1JPV1NfQ0hVTksgPSAxMDsgLy8gU3BsaXQgdXAgdGhlIGNhbnZhc2VzIHRvIGF2b2lkIGhpdHRpbmcgdGhlIHJlbmRlciBsaW1pdFxuXG5jb25zdCBjaHVua0RhdGEgPSAoaW5wdXRBcnJheTogYW55W10sIGNodW5rczogbnVtYmVyKSA9PlxuICBpbnB1dEFycmF5LnJlZHVjZSgocmVzdWx0cywgaXRlbSwgaWR4KSA9PiB7XG4gICAgY29uc3QgY2h1bmtJZHggPSBNYXRoLmZsb29yKGlkeCAvIGNodW5rcyk7XG4gICAgaWYgKCFyZXN1bHRzW2NodW5rSWR4XSkge1xuICAgICAgcmVzdWx0c1tjaHVua0lkeF0gPSBbXTtcbiAgICB9XG4gICAgcmVzdWx0c1tjaHVua0lkeF0ucHVzaChpdGVtKTtcbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfSwgW10pO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBIQVNTRG9tRXZlbnRzIHtcbiAgICBcInktd2lkdGgtY2hhbmdlZFwiOiB7IHZhbHVlOiBudW1iZXI7IGNoYXJ0SW5kZXg6IG51bWJlciB9O1xuICB9XG59XG5cbkBjdXN0b21FbGVtZW50KFwic3RhdGUtaGlzdG9yeS1jaGFydHNcIilcbmV4cG9ydCBjbGFzcyBTdGF0ZUhpc3RvcnlDaGFydHMgZXh0ZW5kcyBMaXRFbGVtZW50IHtcbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgaGFzcyE6IEhvbWVBc3Npc3RhbnQ7XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgaGlzdG9yeURhdGEhOiBIaXN0b3J5UmVzdWx0O1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyBuYXJyb3chOiBib29sZWFuO1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyBuYW1lcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiwgYXR0cmlidXRlOiBcInZpcnR1YWxpemVcIiwgcmVmbGVjdDogdHJ1ZSB9KVxuICBwdWJsaWMgdmlydHVhbGl6ZSA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGVuZFRpbWU/OiBEYXRlO1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIHN0YXJ0VGltZT86IERhdGU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiwgYXR0cmlidXRlOiBcInVwLXRvLW5vd1wiIH0pIHB1YmxpYyB1cFRvTm93ID0gZmFsc2U7XG5cbiAgQHByb3BlcnR5KCkgcHVibGljIGhvdXJzVG9TaG93PzogbnVtYmVyO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIHNob3dOYW1lcyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgY2xpY2tGb3JNb3JlSW5mbyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgaXNMb2FkaW5nRGF0YSA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGxvZ2FyaXRobWljU2NhbGUgPSBmYWxzZTtcblxuICBwcml2YXRlIF9jb21wdXRlZFN0YXJ0VGltZSE6IERhdGU7XG5cbiAgcHJpdmF0ZSBfY29tcHV0ZWRFbmRUaW1lITogRGF0ZTtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9tYXhZV2lkdGggPSAwO1xuXG4gIEBzdGF0ZSgpIHByaXZhdGUgX2NoaWxkWVdpZHRoczogbnVtYmVyW10gPSBbXTtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9jaGFydENvdW50ID0gMDtcblxuICAvLyBAdHMtaWdub3JlXG4gIEByZXN0b3JlU2Nyb2xsKFwiLmNvbnRhaW5lclwiKSBwcml2YXRlIF9zYXZlZFNjcm9sbFBvcz86IG51bWJlcjtcblxuICBAcXVlcnlBbGwoXCJzdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmVcIilcbiAgcHJpdmF0ZSBfY2hhcnRzPzogU3RhdGVIaXN0b3J5Q2hhcnRMaW5lW107XG5cbiAgcHVibGljIHJlc2l6ZSA9IChvcHRpb25zPzogQ2hhcnRSZXNpemVPcHRpb25zKTogdm9pZCA9PiB7XG4gICAgdGhpcy5fY2hhcnRzPy5mb3JFYWNoKFxuICAgICAgKGNoYXJ0OiBTdGF0ZUhpc3RvcnlDaGFydExpbmUgfCBTdGF0ZUhpc3RvcnlDaGFydFRpbWVsaW5lKSA9PlxuICAgICAgICBjaGFydC5yZXNpemUob3B0aW9ucylcbiAgICApO1xuICB9O1xuXG4gIHByb3RlY3RlZCByZW5kZXIoKSB7XG4gICAgaWYgKCFpc0NvbXBvbmVudExvYWRlZCh0aGlzLmhhc3MsIFwiaGlzdG9yeVwiKSkge1xuICAgICAgcmV0dXJuIGh0bWxgPGRpdiBjbGFzcz1cImluZm9cIj5cbiAgICAgICAgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jb21wb25lbnRzLmhpc3RvcnlfY2hhcnRzLmhpc3RvcnlfZGlzYWJsZWRcIil9XG4gICAgICA8L2Rpdj5gO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzTG9hZGluZ0RhdGEgJiYgIXRoaXMuaGlzdG9yeURhdGEpIHtcbiAgICAgIHJldHVybiBodG1sYDxkaXYgY2xhc3M9XCJpbmZvXCI+XG4gICAgICAgICR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY29tcG9uZW50cy5oaXN0b3J5X2NoYXJ0cy5sb2FkaW5nX2hpc3RvcnlcIil9XG4gICAgICA8L2Rpdj5gO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9pc0hpc3RvcnlFbXB0eSgpKSB7XG4gICAgICByZXR1cm4gaHRtbGA8ZGl2IGNsYXNzPVwiaW5mb1wiPlxuICAgICAgICAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNvbXBvbmVudHMuaGlzdG9yeV9jaGFydHMubm9faGlzdG9yeV9mb3VuZFwiKX1cbiAgICAgIDwvZGl2PmA7XG4gICAgfVxuICAgIGNvbnN0IGNvbWJpbmVkSXRlbXMgPSB0aGlzLmhpc3RvcnlEYXRhLnRpbWVsaW5lLmxlbmd0aFxuICAgICAgPyAodGhpcy52aXJ0dWFsaXplXG4gICAgICAgICAgPyBjaHVua0RhdGEodGhpcy5oaXN0b3J5RGF0YS50aW1lbGluZSwgQ0FOVkFTX1RJTUVMSU5FX1JPV1NfQ0hVTkspXG4gICAgICAgICAgOiBbdGhpcy5oaXN0b3J5RGF0YS50aW1lbGluZV1cbiAgICAgICAgKS5jb25jYXQodGhpcy5oaXN0b3J5RGF0YS5saW5lKVxuICAgICAgOiB0aGlzLmhpc3RvcnlEYXRhLmxpbmU7XG5cbiAgICB0aGlzLl9jaGFydENvdW50ID0gY29tYmluZWRJdGVtcy5sZW5ndGg7XG5cbiAgICByZXR1cm4gdGhpcy52aXJ0dWFsaXplXG4gICAgICA/IGh0bWxgPGRpdiBjbGFzcz1cImNvbnRhaW5lciBoYS1zY3JvbGxiYXJcIiBAc2Nyb2xsPSR7dGhpcy5fc2F2ZVNjcm9sbFBvc30+XG4gICAgICAgICAgPGxpdC12aXJ0dWFsaXplclxuICAgICAgICAgICAgc2Nyb2xsZXJcbiAgICAgICAgICAgIGNsYXNzPVwiaGEtc2Nyb2xsYmFyXCJcbiAgICAgICAgICAgIC5pdGVtcz0ke2NvbWJpbmVkSXRlbXN9XG4gICAgICAgICAgICAucmVuZGVySXRlbT0ke3RoaXMuX3JlbmRlckhpc3RvcnlJdGVtfVxuICAgICAgICAgID5cbiAgICAgICAgICA8L2xpdC12aXJ0dWFsaXplcj5cbiAgICAgICAgPC9kaXY+YFxuICAgICAgOiBodG1sYCR7Y29tYmluZWRJdGVtcy5tYXAoKGl0ZW0sIGluZGV4KSA9PlxuICAgICAgICAgIHRoaXMuX3JlbmRlckhpc3RvcnlJdGVtKGl0ZW0sIGluZGV4KVxuICAgICAgICApfWA7XG4gIH1cblxuICBwcml2YXRlIF9yZW5kZXJIaXN0b3J5SXRlbSA9IChcbiAgICBpdGVtOiBUaW1lbGluZUVudGl0eVtdIHwgTGluZUNoYXJ0VW5pdCxcbiAgICBpbmRleDogbnVtYmVyXG4gICkgPT4ge1xuICAgIGlmICghaXRlbSB8fCBpbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gbm90aGluZztcbiAgICB9XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW0pKSB7XG4gICAgICByZXR1cm4gaHRtbGA8ZGl2IGNsYXNzPVwiZW50cnktY29udGFpbmVyXCI+XG4gICAgICAgIDxzdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmVcbiAgICAgICAgICAuaGFzcz0ke3RoaXMuaGFzc31cbiAgICAgICAgICAudW5pdD0ke2l0ZW0udW5pdH1cbiAgICAgICAgICAuZGF0YT0ke2l0ZW0uZGF0YX1cbiAgICAgICAgICAuaWRlbnRpZmllcj0ke2l0ZW0uaWRlbnRpZmllcn1cbiAgICAgICAgICAuc2hvd05hbWVzPSR7dGhpcy5zaG93TmFtZXN9XG4gICAgICAgICAgLnN0YXJ0VGltZT0ke3RoaXMuX2NvbXB1dGVkU3RhcnRUaW1lfVxuICAgICAgICAgIC5lbmRUaW1lPSR7dGhpcy5fY29tcHV0ZWRFbmRUaW1lfVxuICAgICAgICAgIC5wYWRkaW5nWUF4aXM9JHt0aGlzLl9tYXhZV2lkdGh9XG4gICAgICAgICAgLm5hbWVzPSR7dGhpcy5uYW1lc31cbiAgICAgICAgICAuY2hhcnRJbmRleD0ke2luZGV4fVxuICAgICAgICAgIC5jbGlja0Zvck1vcmVJbmZvPSR7dGhpcy5jbGlja0Zvck1vcmVJbmZvfVxuICAgICAgICAgIC5sb2dhcml0aG1pY1NjYWxlPSR7dGhpcy5sb2dhcml0aG1pY1NjYWxlfVxuICAgICAgICAgIEB5LXdpZHRoLWNoYW5nZWQ9JHt0aGlzLl95V2lkdGhDaGFuZ2VkfVxuICAgICAgICA+PC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmU+XG4gICAgICA8L2Rpdj4gYDtcbiAgICB9XG4gICAgcmV0dXJuIGh0bWxgPGRpdiBjbGFzcz1cImVudHJ5LWNvbnRhaW5lclwiPlxuICAgICAgPHN0YXRlLWhpc3RvcnktY2hhcnQtdGltZWxpbmVcbiAgICAgICAgLmhhc3M9JHt0aGlzLmhhc3N9XG4gICAgICAgIC5kYXRhPSR7aXRlbX1cbiAgICAgICAgLnN0YXJ0VGltZT0ke3RoaXMuX2NvbXB1dGVkU3RhcnRUaW1lfVxuICAgICAgICAuZW5kVGltZT0ke3RoaXMuX2NvbXB1dGVkRW5kVGltZX1cbiAgICAgICAgLnNob3dOYW1lcz0ke3RoaXMuc2hvd05hbWVzfVxuICAgICAgICAubmFtZXM9JHt0aGlzLm5hbWVzfVxuICAgICAgICAubmFycm93PSR7dGhpcy5uYXJyb3d9XG4gICAgICAgIC5jaHVua2VkPSR7dGhpcy52aXJ0dWFsaXplfVxuICAgICAgICAucGFkZGluZ1lBeGlzPSR7dGhpcy5fbWF4WVdpZHRofVxuICAgICAgICAuY2hhcnRJbmRleD0ke2luZGV4fVxuICAgICAgICAuY2xpY2tGb3JNb3JlSW5mbz0ke3RoaXMuY2xpY2tGb3JNb3JlSW5mb31cbiAgICAgICAgQHktd2lkdGgtY2hhbmdlZD0ke3RoaXMuX3lXaWR0aENoYW5nZWR9XG4gICAgICA+PC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lPlxuICAgIDwvZGl2PiBgO1xuICB9O1xuXG4gIHByb3RlY3RlZCBzaG91bGRVcGRhdGUoY2hhbmdlZFByb3BzOiBQcm9wZXJ0eVZhbHVlcyk6IGJvb2xlYW4ge1xuICAgIGlmIChjaGFuZ2VkUHJvcHMuc2l6ZSA9PT0gMSAmJiBjaGFuZ2VkUHJvcHMuaGFzKFwiaGFzc1wiKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICBjaGFuZ2VkUHJvcHMuc2l6ZSA9PT0gMSAmJlxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcIl9tYXhZV2lkdGhcIikgJiZcbiAgICAgIGNoYW5nZWRQcm9wcy5nZXQoXCJfbWF4WVdpZHRoXCIpID09PSB0aGlzLl9tYXhZV2lkdGhcbiAgICApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBwcm90ZWN0ZWQgd2lsbFVwZGF0ZShjaGFuZ2VkUHJvcHM6IFByb3BlcnR5VmFsdWVzKSB7XG4gICAgaWYgKCF0aGlzLmhhc1VwZGF0ZWQpIHtcbiAgICAgIGxvYWRWaXJ0dWFsaXplcigpO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICBbLi4uY2hhbmdlZFByb3BzLmtleXMoKV0uc29tZShcbiAgICAgICAgKHByb3ApID0+XG4gICAgICAgICAgIShcbiAgICAgICAgICAgIFtcIl9tYXhZV2lkdGhcIiwgXCJfY2hpbGRZV2lkdGhzXCIsIFwiX2NoYXJ0Q291bnRcIl0gYXMgUHJvcGVydHlLZXlbXVxuICAgICAgICAgICkuaW5jbHVkZXMocHJvcClcbiAgICAgIClcbiAgICApIHtcbiAgICAgIC8vIERvbid0IHJlY29tcHV0ZSB0aW1lcyB3aGVuIHdlIGp1c3Qgd2FudCB0byB1cGRhdGUgbGF5b3V0XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICB0aGlzLl9jb21wdXRlZEVuZFRpbWUgPVxuICAgICAgICB0aGlzLnVwVG9Ob3cgfHwgIXRoaXMuZW5kVGltZSB8fCB0aGlzLmVuZFRpbWUgPiBub3dcbiAgICAgICAgICA/IG5vd1xuICAgICAgICAgIDogdGhpcy5lbmRUaW1lO1xuXG4gICAgICBpZiAodGhpcy5zdGFydFRpbWUpIHtcbiAgICAgICAgdGhpcy5fY29tcHV0ZWRTdGFydFRpbWUgPSB0aGlzLnN0YXJ0VGltZTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ob3Vyc1RvU2hvdykge1xuICAgICAgICB0aGlzLl9jb21wdXRlZFN0YXJ0VGltZSA9IG5ldyBEYXRlKFxuICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gNjAgKiA2MCAqIHRoaXMuaG91cnNUb1Nob3cgKiAxMDAwXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9jb21wdXRlZFN0YXJ0VGltZSA9IG5ldyBEYXRlKFxuICAgICAgICAgICh0aGlzLmhpc3RvcnlEYXRhPy50aW1lbGluZSA/PyBbXSkucmVkdWNlKFxuICAgICAgICAgICAgKG1pblRpbWUsIHN0YXRlSW5mbykgPT5cbiAgICAgICAgICAgICAgTWF0aC5taW4oXG4gICAgICAgICAgICAgICAgbWluVGltZSxcbiAgICAgICAgICAgICAgICBuZXcgRGF0ZShzdGF0ZUluZm8uZGF0YVswXS5sYXN0X2NoYW5nZWQpLmdldFRpbWUoKVxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIHVwZGF0ZWQoY2hhbmdlZFByb3BzOiBQcm9wZXJ0eVZhbHVlcykge1xuICAgIGlmIChjaGFuZ2VkUHJvcHMuaGFzKFwiX2NoYXJ0Q291bnRcIikpIHtcbiAgICAgIGlmICh0aGlzLl9jaGFydENvdW50IDwgdGhpcy5fY2hpbGRZV2lkdGhzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLl9jaGlsZFlXaWR0aHMubGVuZ3RoID0gdGhpcy5fY2hhcnRDb3VudDtcbiAgICAgICAgdGhpcy5fbWF4WVdpZHRoID0gTWF0aC5tYXgoLi4uT2JqZWN0LnZhbHVlcyh0aGlzLl9jaGlsZFlXaWR0aHMpLCAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF95V2lkdGhDaGFuZ2VkKGU6IEN1c3RvbUV2ZW50PEhBU1NEb21FdmVudHNbXCJ5LXdpZHRoLWNoYW5nZWRcIl0+KSB7XG4gICAgdGhpcy5fY2hpbGRZV2lkdGhzW2UuZGV0YWlsLmNoYXJ0SW5kZXhdID0gZS5kZXRhaWwudmFsdWU7XG4gICAgdGhpcy5fbWF4WVdpZHRoID0gTWF0aC5tYXgoLi4uT2JqZWN0LnZhbHVlcyh0aGlzLl9jaGlsZFlXaWR0aHMpLCAwKTtcbiAgfVxuXG4gIHByaXZhdGUgX2lzSGlzdG9yeUVtcHR5KCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGhpc3RvcnlEYXRhRW1wdHkgPVxuICAgICAgIXRoaXMuaGlzdG9yeURhdGEgfHxcbiAgICAgICF0aGlzLmhpc3RvcnlEYXRhLnRpbWVsaW5lIHx8XG4gICAgICAhdGhpcy5oaXN0b3J5RGF0YS5saW5lIHx8XG4gICAgICAodGhpcy5oaXN0b3J5RGF0YS50aW1lbGluZS5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgdGhpcy5oaXN0b3J5RGF0YS5saW5lLmxlbmd0aCA9PT0gMCk7XG4gICAgcmV0dXJuICF0aGlzLmlzTG9hZGluZ0RhdGEgJiYgaGlzdG9yeURhdGFFbXB0eTtcbiAgfVxuXG4gIEBldmVudE9wdGlvbnMoeyBwYXNzaXZlOiB0cnVlIH0pXG4gIHByaXZhdGUgX3NhdmVTY3JvbGxQb3MoZTogRXZlbnQpIHtcbiAgICB0aGlzLl9zYXZlZFNjcm9sbFBvcyA9IChlLnRhcmdldCBhcyBIVE1MRGl2RWxlbWVudCkuc2Nyb2xsVG9wO1xuICB9XG5cbiAgc3RhdGljIGdldCBzdHlsZXMoKTogQ1NTUmVzdWx0R3JvdXAge1xuICAgIHJldHVybiBjc3NgXG4gICAgICA6aG9zdCB7XG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAvKiBoZWlnaHQgb2Ygc2luZ2xlIHRpbWVsaW5lIGNoYXJ0ID0gNjBweCAqL1xuICAgICAgICBtaW4taGVpZ2h0OiA2MHB4O1xuICAgICAgfVxuXG4gICAgICA6aG9zdChbdmlydHVhbGl6ZV0pIHtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgfVxuXG4gICAgICAuaW5mbyB7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDYwcHg7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1zZWNvbmRhcnktdGV4dC1jb2xvcik7XG4gICAgICB9XG5cbiAgICAgIC5jb250YWluZXIge1xuICAgICAgICBtYXgtaGVpZ2h0OiB2YXIoLS1oaXN0b3J5LW1heC1oZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICAuZW50cnktY29udGFpbmVyIHtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICB9XG5cbiAgICAgIC5lbnRyeS1jb250YWluZXI6aG92ZXIge1xuICAgICAgICB6LWluZGV4OiAxO1xuICAgICAgfVxuXG4gICAgICA6aG9zdChbdmlydHVhbGl6ZV0pIC5lbnRyeS1jb250YWluZXIge1xuICAgICAgICBwYWRkaW5nLWxlZnQ6IDFweDtcbiAgICAgICAgcGFkZGluZy1yaWdodDogMXB4O1xuICAgICAgfVxuXG4gICAgICAuZW50cnktY29udGFpbmVyOm5vdCg6Zmlyc3QtY2hpbGQpIHtcbiAgICAgICAgYm9yZGVyLXRvcDogMnB4IHNvbGlkIHZhcigtLWRpdmlkZXItY29sb3IpO1xuICAgICAgICBtYXJnaW4tdG9wOiAxNnB4O1xuICAgICAgfVxuXG4gICAgICAuY29udGFpbmVyLFxuICAgICAgbGl0LXZpcnR1YWxpemVyIHtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgIH1cblxuICAgICAgbGl0LXZpcnR1YWxpemVyIHtcbiAgICAgICAgY29udGFpbjogc2l6ZSBsYXlvdXQgIWltcG9ydGFudDtcbiAgICAgIH1cblxuICAgICAgc3RhdGUtaGlzdG9yeS1jaGFydC10aW1lbGluZSxcbiAgICAgIHN0YXRlLWhpc3RvcnktY2hhcnQtbGluZSB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgfVxuICAgIGA7XG4gIH1cbn1cblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgSFRNTEVsZW1lbnRUYWdOYW1lTWFwIHtcbiAgICBcInN0YXRlLWhpc3RvcnktY2hhcnRzXCI6IFN0YXRlSGlzdG9yeUNoYXJ0cztcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/components/chart/state-history-charts.ts\n");

/***/ }),

/***/ "./src/resources/virtualizer.ts":
/*!**************************************!*\
  !*** ./src/resources/virtualizer.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadVirtualizer: () => (/* binding */ loadVirtualizer)\n/* harmony export */ });\n/* harmony import */ var _resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resize-observer.polyfill */ \"./src/resources/resize-observer.polyfill.ts\");\n\nconst loadVirtualizer = async () => {\n  await (0,_resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_0__.loadPolyfillIfNeeded)();\n  await Promise.all(/*! import() */[__webpack_require__.e(\"vendors-node_modules_lit_directives_repeat_js\"), __webpack_require__.e(\"vendors-node_modules_lit-labs_virtualizer_lit-virtualizer_js\")]).then(__webpack_require__.bind(__webpack_require__, /*! @lit-labs/virtualizer */ \"./node_modules/@lit-labs/virtualizer/lit-virtualizer.js\"));\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVzb3VyY2VzL3ZpcnR1YWxpemVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL3Jlc291cmNlcy92aXJ0dWFsaXplci50cz80YjA0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvYWRQb2x5ZmlsbElmTmVlZGVkIH0gZnJvbSBcIi4vcmVzaXplLW9ic2VydmVyLnBvbHlmaWxsXCI7XG5cbmV4cG9ydCBjb25zdCBsb2FkVmlydHVhbGl6ZXIgPSBhc3luYyAoKSA9PiB7XG4gIGF3YWl0IGxvYWRQb2x5ZmlsbElmTmVlZGVkKCk7XG4gIGF3YWl0IGltcG9ydChcIkBsaXQtbGFicy92aXJ0dWFsaXplclwiKTtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/resources/virtualizer.ts\n");

/***/ })

};
